"use strict";(self.webpackChunkreact_frontend_init=self.webpackChunkreact_frontend_init||[]).push([[2204],{78259:function(dn,Ht,l){l.r(Ht),l.d(Ht,{default:function(){return rn}});var hr=l(84136),b=l.n(hr),pr=l(64581),Oe=l.n(pr),gr=l(57566),ne=l.n(gr),vr=l(52487),Ne=l.n(vr),xr=l(90785),v=l.n(xr),n=l(67294),Rt=l(26058),tt=l(71471),Wt=l(17788),mr=l(9361),C=l(68872),Ie=l(78957),ve=l(83062),yr=l(40411),N=l(83622),Sr=l(4393),Cr=l(72269),vt=l(96074),br=l(66309),Ke=l(32983),Tt=l(58455),rt=l(90389),Ut=l(97245),Kt=l(10524),Jt=l(14079),Er=l(57184),Vt=l(43215),jr=l(43425),Yt=l(51042),Gt=l(14361),$t=l(82061),wr=l(82257),it=l(34041),Le=l(47019),Et=l(86125),xt=l(55102),kr=l(10149),ot=l(63783),e=l(85893),mt=it.Z.Option,Xt=function(P){return typeof P=="string"?P:P.toHexString()},Zr=[{label:"Arial",value:"Arial, sans-serif"},{label:"\u9ED1\u4F53",value:"SimHei, sans-serif"},{label:"\u5B8B\u4F53",value:"SimSun, serif"},{label:"\u5FAE\u8F6F\u96C5\u9ED1",value:'"Microsoft YaHei", sans-serif'},{label:"\u6977\u4F53",value:"KaiTi, serif"},{label:"\u4EFF\u5B8B",value:"FangSong, serif"},{label:"Times New Roman",value:'"Times New Roman", serif'},{label:"Georgia",value:"Georgia, serif"},{label:"Verdana",value:"Verdana, sans-serif"}],At=[{label:"\u5DE6\u65B9\u5411\u952E",value:"ArrowLeft"},{label:"\u53F3\u65B9\u5411\u952E",value:"ArrowRight"},{label:"\u4E0A\u65B9\u5411\u952E",value:"ArrowUp"},{label:"\u4E0B\u65B9\u5411\u952E",value:"ArrowDown"},{label:"Page Up",value:"PageUp"},{label:"Page Down",value:"PageDown"},{label:"A",value:"KeyA"},{label:"D",value:"KeyD"},{label:"W",value:"KeyW"},{label:"S",value:"KeyS"},{label:"J",value:"KeyJ"},{label:"K",value:"KeyK"},{label:"Esc",value:"Escape"},{label:"\u7A7A\u683C",value:"Space"}],Br=[{label:"\u9F20\u6807\u79FB\u51FA",value:"mouseOut"},{label:"\u6309\u952E",value:"key"},{label:"\u65E0",value:"none"}],Fr=function(P){var t=P.settings,f=P.onSave,W=Le.Z.useForm(),le=v()(W,1),ae=le[0],ce=(0,n.useState)(t),_=v()(ce,2),w=_[0],xe=_[1];(0,n.useEffect)(function(){var E=localStorage.getItem("fish-reader-settings");if(E)try{var D=JSON.parse(E);ae.setFieldsValue(D),xe(D)}catch(de){console.error("\u89E3\u6790\u5DF2\u4FDD\u5B58\u7684\u9605\u8BFB\u5668\u8BBE\u7F6E\u5931\u8D25:",de)}else ae.setFieldsValue(t)},[ae,t]);var ee=function(){ae.validateFields().then(function(D){var de=b()(b()({},w),D);f(de)})},M=function(){ae.resetFields(),xe(t)};n.useEffect(function(){ae.getFieldValue("quickHide")||ae.setFieldsValue({quickHide:"none"})},[ae]);var se=function(D,de){var fe=b()(b()({},w),de);D.fontColor&&(fe.fontColor=Xt(D.fontColor)),D.backgroundColor&&(fe.backgroundColor=Xt(D.backgroundColor)),xe(fe)},me=function(){var D=localStorage.getItem("fish-reader-settings");if(D)try{return JSON.parse(D)}catch(de){console.error("\u89E3\u6790\u5DF2\u4FDD\u5B58\u7684\u9605\u8BFB\u5668\u8BBE\u7F6E\u5931\u8D25:",de)}return t};return(0,e.jsxs)(Le.Z,{form:ae,layout:"vertical",initialValues:me(),onValuesChange:se,children:[(0,e.jsxs)("div",{style:{marginBottom:24,textAlign:"right"},children:[(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(kr.Z,{}),onClick:M,style:{marginRight:8},children:"\u6062\u590D\u9ED8\u8BA4\u8BBE\u7F6E"}),(0,e.jsx)(N.ZP,{type:"primary",onClick:ee,children:"\u4FDD\u5B58\u8BBE\u7F6E"})]}),(0,e.jsx)(vt.Z,{orientation:"center",children:"\u5916\u89C2\u8BBE\u7F6E"}),(0,e.jsx)(Le.Z.Item,{label:"\u9605\u8BFB\u7A97\u53E3\u900F\u660E\u5EA6",name:"opacity",tooltip:"\u503C\u8D8A\u5C0F\u8D8A\u900F\u660E",children:(0,e.jsx)(Et.Z,{min:0,max:1,step:.01,marks:{0:"0",.5:"0.5",1:"1"}})}),(0,e.jsx)(Le.Z.Item,{label:"\u5B57\u4F53\u5927\u5C0F",name:"fontSize",children:(0,e.jsx)(Et.Z,{min:12,max:30,marks:{12:"12",16:"16",20:"20",24:"24",30:"30"}})}),(0,e.jsx)(Le.Z.Item,{label:"\u5B57\u4F53",name:"fontFamily",children:(0,e.jsx)(it.Z,{children:Zr.map(function(E){return(0,e.jsx)(mt,{value:E.value,children:E.label},E.value)})})}),(0,e.jsx)(vt.Z,{orientation:"center",children:"\u6309\u952E\u8BBE\u7F6E"}),(0,e.jsx)(Le.Z.Item,{label:(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)("span",{children:"\u4E0A\u4E00\u9875\u6309\u952E"}),(0,e.jsx)(ve.Z,{title:"\u6309\u4E0B\u8BE5\u952E\u53EF\u5FEB\u901F\u7FFB\u5230\u4E0A\u4E00\u9875",children:(0,e.jsx)(ot.Z,{})})]}),name:"prevPageKey",children:(0,e.jsx)(it.Z,{children:At.map(function(E){return(0,e.jsx)(mt,{value:E.value,children:E.label},E.value)})})}),(0,e.jsx)(Le.Z.Item,{label:(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)("span",{children:"\u4E0B\u4E00\u9875\u6309\u952E"}),(0,e.jsx)(ve.Z,{title:"\u6309\u4E0B\u8BE5\u952E\u53EF\u5FEB\u901F\u7FFB\u5230\u4E0B\u4E00\u9875",children:(0,e.jsx)(ot.Z,{})})]}),name:"nextPageKey",children:(0,e.jsx)(it.Z,{children:At.map(function(E){return(0,e.jsx)(mt,{value:E.value,children:E.label},E.value)})})}),(0,e.jsx)(vt.Z,{orientation:"center",children:"\u5176\u4ED6\u8BBE\u7F6E"}),(0,e.jsx)(Le.Z.Item,{label:(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)("span",{children:"\u7D27\u6025\u5207\u6362\u952E"}),(0,e.jsx)(ve.Z,{title:"\u6309\u4E0B\u8BE5\u952E\u53EF\u5FEB\u901F\u5173\u95ED\u9605\u8BFB\u5668\u5E76\u5207\u6362\u5230\u5DE5\u4F5C\u6A21\u5F0F\uFF0C\u7528\u4E8E\u7D27\u6025\u60C5\u51B5",children:(0,e.jsx)(ot.Z,{})})]}),name:"panicKey",children:(0,e.jsx)(it.Z,{children:At.map(function(E){return(0,e.jsx)(mt,{value:E.value,children:E.label},E.value)})})}),(0,e.jsx)(Le.Z.Item,{label:(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)("span",{children:"\u5FEB\u901F\u9690\u85CF\u9605\u8BFB\u7A97\u53E3"}),(0,e.jsx)(ve.Z,{title:"\u8BBE\u7F6E\u89E6\u53D1\u6761\u4EF6\uFF0C\u8BA9\u9605\u8BFB\u7A97\u53E3\u5FEB\u901F\u9690\u85CF\uFF0C\u65B9\u4FBF\u6478\u9C7C\u65F6\u5FEB\u901F\u9690\u85CF\u5185\u5BB9",children:(0,e.jsx)(ot.Z,{})})]}),name:"quickHide",children:(0,e.jsx)(it.Z,{children:Br.map(function(E){return(0,e.jsx)(mt,{value:E.value,children:E.label},E.value)})})}),(0,e.jsx)(Le.Z.Item,{label:(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)("span",{children:"\u6478\u9C7C\u9605\u8BFBToken"}),(0,e.jsx)(ve.Z,{title:"\u7528\u4E8E\u8BBF\u95EE\u6478\u9C7C\u9605\u8BFBAPI\u7684Token\uFF0C\u9ED8\u8BA4\u4E3A\u6E38\u5BA2\u6A21\u5F0F",children:(0,e.jsx)(ot.Z,{})})]}),name:"accessToken",children:(0,e.jsx)(xt.Z,{placeholder:"congg:7e0efee65786976202e4fc20c6a98d89"})}),(0,e.jsx)(Le.Z.Item,{label:(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)("span",{children:"API\u670D\u52A1\u5730\u5740"}),(0,e.jsx)(ve.Z,{title:"\u6478\u9C7C\u9605\u8BFBAPI\u670D\u52A1\u5668\u5730\u5740\uFF0C\u9ED8\u8BA4\u4E3A\u5B98\u65B9\u670D\u52A1\u5668",children:(0,e.jsx)(ot.Z,{})})]}),name:"apiBaseUrl",children:(0,e.jsx)(xt.Z,{placeholder:"https://reader.yucoder.cn/reader3"})})]})},Rr=Fr,Tr=l(9669),jt=l.n(Tr),wt=l(55241),ut=l(74330),Ar=l(53682),Qt=l(43471),qt=l(53073),_t=l(37653),er=l(43929),Ir=l(96897),Pr=l(55287),Mr=l(62992),yt=tt.Z.Text,tr={CHAPTER_LIST:"/getChapterList",BOOK_CONTENT:"/getBookContent"},Dr=function(P){var t=P.book,f=P.settings,W=P.onProgressUpdate,le=P.onOpenChapterList,ae=(0,n.useState)(""),ce=v()(ae,2),_=ce[0],w=ce[1],xe=(0,n.useState)(!0),ee=v()(xe,2),M=ee[0],se=ee[1],me=(0,n.useState)(0),E=v()(me,1),D=E[0],de=(0,n.useState)(!0),fe=v()(de,2),F=fe[0],Fe=fe[1],G=(0,n.useState)(!0),je=v()(G,2),Se=je[0],we=je[1],Pe=(0,n.useState)(!0),ye=v()(Pe,2),Q=ye[0],Ce=ye[1],he=(0,n.useState)(t.lastReadChapter||0),Z=v()(he,2),y=Z[0],Te=Z[1],Ge=(0,n.useState)(null),ke=v()(Ge,2),Ze=ke[0],be=ke[1],$e=(0,n.useState)(f.fontSize),De=v()($e,2),S=De[0],Be=De[1],X=(0,n.useState)(!1),o=v()(X,2),h=o[0],A=o[1],U=(0,n.useState)(0),u=v()(U,2),L=u[0],m=u[1],te=(0,n.useState)(!1),V=v()(te,2),He=V[0],Ve=V[1],K=(0,n.useState)(f.opacity),Ee=v()(K,2),q=Ee[0],Ae=Ee[1],Xe=(0,n.useState)(800),lt=v()(Xe,2),pe=lt[0],at=lt[1],I=(0,n.useState)(600),ie=v()(I,2),Re=ie[0],ct=ie[1],St=(0,n.useState)({x:window.innerWidth/2-400,y:window.innerHeight/2-300}),Zt=v()(St,2),ge=Zt[0],We=Zt[1],Pt=(0,n.useState)(!1),Bt=v()(Pt,2),or=Bt[0],Ct=Bt[1],Mt=(0,n.useRef)(null),Ft=(0,n.useState)("none"),p=v()(Ft,2),d=p[0],x=p[1],B=(0,n.useRef)(null),z=(0,n.useRef)({time:0,chapterIndex:0}),$=(0,n.useRef)(null),k=(0,n.useRef)(null),oe=(0,n.useRef)(null),Ue=(0,n.useRef)(null),ur=(0,n.useRef)(null),fn=(0,n.useRef)(0),Dt=(0,n.useRef)(null),st=(0,n.useCallback)(function(){var a={width:pe,height:Re,position:ge};localStorage.setItem("fish-reader-window-settings",JSON.stringify(a))},[pe,Re,ge]);(0,n.useEffect)(function(){if(B.current=null,z.current={time:0,chapterIndex:0},Te(t.lastReadChapter||0),t.chapters&&t.chapters.length>0){var a=y||t.lastReadChapter||0,r=t.chapters.find(function(re){return re.index===a});be(r||t.chapters[0])}else be(null);var s=localStorage.getItem("fish-reader-window-settings");if(s)try{var c=JSON.parse(s),i=c.width,g=c.height,O=c.position;if(i&&g&&O){var J=Math.min(Math.max(0,O.x),window.innerWidth-i),Y=Math.min(Math.max(0,O.y),window.innerHeight-g);at(i),ct(g),We({x:J,y:Y}),k.current&&(k.current.style.width="".concat(i,"px"),k.current.style.height="".concat(g,"px"),k.current.style.transform="translate(".concat(J,"px, ").concat(Y,"px)"));return}}catch(re){console.error("\u89E3\u6790\u4FDD\u5B58\u7684\u9605\u8BFB\u5668\u8BBE\u7F6E\u5931\u8D25:",re)}var T=Math.max(0,(window.innerWidth-pe)/2),ue=Math.max(0,(window.innerHeight-Re)/2);return We({x:T,y:ue}),k.current&&(k.current.style.transform="translate(".concat(T,"px, ").concat(ue,"px)")),function(){B.current=null,$.current&&clearTimeout($.current),ur.current&&clearInterval(ur.current)}},[t.id,t.lastReadChapter]),(0,n.useEffect)(function(){if(t.lastReadChapter!==void 0&&t.lastReadChapter!==y&&(Te(t.lastReadChapter),t.chapters&&t.chapters.length>0)){var a=t.chapters.find(function(r){return r.index===t.lastReadChapter});a&&(be(a),a.content?(se(!1),w(a.content)):oe.current&&(oe.current.scrollTop=0))}},[t.lastReadChapter,y,t.chapters]),(0,n.useEffect)(function(){var a=function(){var r=Ne()(ne()().mark(function s(){var c,i,g,O,J,Y,T,ue,re,R,H,ze,ht,Ye,qe,bt,_e,et,pt,gt;return ne()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(B.current!==y){j.next=2;break}return j.abrupt("return");case 2:return c=Date.now(),i=y,z.current={time:c,chapterIndex:i},B.current=y,se(!0),j.prev=7,j.next=10,new Promise(function(Me){return setTimeout(Me,50)});case 10:if(!(z.current.time!==c||z.current.chapterIndex!==i)){j.next=12;break}return j.abrupt("return");case 12:if(!(t.chapters&&t.chapters.length>0)){j.next=41;break}if(g=t.chapters.find(function(Me){return Me.index===y}),!g){j.next=37;break}if(be(g),!g.content){j.next=21;break}w(g.content),W(0,y),j.next=35;break;case 21:if(!(t.source==="online"&&t.url)){j.next=35;break}if(O=localStorage.getItem("fish-reader-books"),J="",O&&(Y=JSON.parse(O),T=Y.find(function(Me){return Me.id===t.id}),T&&T.chapters&&(ue=T.chapters.find(function(Me){return Me.index===y}),ue&&ue.content&&(J=ue.content))),!J){j.next=31;break}w(J),g.content=J,W(0,y),j.next=35;break;case 31:return j.next=33,dt(t,g);case 33:re=j.sent,re?(w(re),ft(y,re),W(0,y)):(w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0\u6216\u8005\u91CD\u65B0\u8FDB\u5165\u9605\u8BFB</p>'),C.ZP.error("\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25"));case 35:j.next=39;break;case 37:w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u672A\u627E\u5230\u7AE0\u8282\u4FE1\u606F\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0\u7AE0\u8282\u5217\u8868</p>'),C.ZP.error("\u672A\u627E\u5230\u7AE0\u8282\u4FE1\u606F");case 39:j.next=79;break;case 41:if(!(t.source==="online"&&t.url)){j.next=77;break}return j.next=44,nn(t);case 44:if(R=j.sent,!(R&&R.length>0)){j.next=73;break}if(H=b()(b()({},t),{},{chapters:R}),Lt(H),ze=R[0],be(ze),!(y>0&&y<=R.length)){j.next=67;break}if(ht=R.find(function(Me){return Me.index===y}),!ht){j.next=67;break}if(be(ht),Ye=localStorage.getItem("fish-reader-books"),qe="",Ye&&(bt=JSON.parse(Ye),_e=bt.find(function(Me){return Me.id===t.id}),_e&&_e.chapters&&(et=_e.chapters.find(function(Me){return Me.index===y}),et&&et.content&&(qe=et.content))),!qe){j.next=62;break}w(qe),W(0,y),j.next=66;break;case 62:return j.next=64,dt(t,ht);case 64:pt=j.sent,pt?(w(pt),ft(y,pt),W(0,y)):(w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0\u6216\u8005\u91CD\u65B0\u8FDB\u5165\u9605\u8BFB</p>'),C.ZP.error("\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25"));case 66:return j.abrupt("return");case 67:return j.next=69,dt(t,ze);case 69:gt=j.sent,gt?(w(gt),ft(ze.index,gt),Te(ze.index),W(0,ze.index)):(w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0\u6216\u8005\u91CD\u65B0\u8FDB\u5165\u9605\u8BFB</p>'),C.ZP.error("\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25")),j.next=75;break;case 73:w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u7AE0\u8282\u5217\u8868\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0\u6216\u91CD\u65B0\u8FDB\u5165</p>'),C.ZP.error("\u7AE0\u8282\u5217\u8868\u52A0\u8F7D\u5931\u8D25");case 75:j.next=79;break;case 77:w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u4E66\u7C4D\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u4E66\u7C4D\u4FE1\u606F\u662F\u5426\u5B8C\u6574</p>'),C.ZP.error("\u4E66\u7C4D\u5185\u5BB9\u52A0\u8F7D\u5931\u8D25");case 79:j.next=86;break;case 81:j.prev=81,j.t0=j.catch(7),console.error("\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9\u5931\u8D25:",j.t0),w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5</p>'),C.ZP.error("\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 86:return j.prev=86,se(!1),j.finish(86);case 89:case"end":return j.stop()}},s,null,[[7,81,86,89]])}));return function(){return r.apply(this,arguments)}}();setTimeout(function(){a()},150)},[t.id,y]);var nn=function(){var a=Ne()(ne()().mark(function r(s){var c,i,g,O,J,Y,T,ue,re=arguments;return ne()().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(c=re.length>1&&re[1]!==void 0?re[1]:!1,!(!s||!s.source||!s.sourceInfo||!s.sourceInfo.url)){H.next=5;break}return console.error("\u4E66\u7C4D\u4FE1\u606F\u4E0D\u5B8C\u6574\uFF0C\u65E0\u6CD5\u52A0\u8F7D\u7AE0\u8282\u5217\u8868"),C.ZP.error("\u4E66\u7C4D\u4FE1\u606F\u4E0D\u5B8C\u6574\uFF0C\u65E0\u6CD5\u52A0\u8F7D\u7AE0\u8282\u5217\u8868"),H.abrupt("return",[]);case 5:return H.prev=5,i=new Date().getTime(),g=f.accessToken||"congg:7e0efee65786976202e4fc20c6a98d89",O=f.apiBaseUrl||"https://reader.yucoder.cn/reader3",J="".concat(O).concat(tr.CHAPTER_LIST,"?accessToken=").concat(g,"&v=").concat(i),H.next=12,jt().post(J,{url:s.url||s.sourceInfo.url,refresh:c?1:0,bookSourceUrl:s.sourceInfo.url});case 12:if(Y=H.sent,!(Y.data&&Y.data.data&&Array.isArray(Y.data.data))){H.next=27;break}if(T=Y.data.data,!(T.length>0)){H.next=22;break}return s.chapters=T,ue=b()(b()({},s),{},{chapters:T}),Lt(ue),H.abrupt("return",T);case 22:return console.warn("\u83B7\u53D6\u5230\u7A7A\u7AE0\u8282\u5217\u8868"),C.ZP.warning("\u83B7\u53D6\u5230\u7A7A\u7AE0\u8282\u5217\u8868\uFF0C\u8BF7\u68C0\u67E5\u4E66\u7C4D\u4FE1\u606F\u6216\u7A0D\u540E\u91CD\u8BD5"),H.abrupt("return",[]);case 25:H.next=30;break;case 27:return console.error("\u7AE0\u8282\u5217\u8868\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E",Y.data),C.ZP.error("\u7AE0\u8282\u5217\u8868\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),H.abrupt("return",[]);case 30:H.next=37;break;case 32:return H.prev=32,H.t0=H.catch(5),console.error("\u52A0\u8F7D\u7AE0\u8282\u5217\u8868\u5931\u8D25:",H.t0),C.ZP.error("\u52A0\u8F7D\u7AE0\u8282\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u6216\u7A0D\u540E\u91CD\u8BD5"),H.abrupt("return",[]);case 37:case"end":return H.stop()}},r,null,[[5,32]])}));return function(s){return a.apply(this,arguments)}}(),dt=function(){var a=Ne()(ne()().mark(function r(s,c){var i,g,O,J,Y,T,ue;return ne()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!(!s||!s.source||!c||!c.url)){R.next=4;break}return console.error("\u4E66\u7C4D\u6216\u7AE0\u8282\u4FE1\u606F\u4E0D\u5B8C\u6574\uFF0C\u65E0\u6CD5\u52A0\u8F7D\u5185\u5BB9"),C.ZP.error("\u4E66\u7C4D\u6216\u7AE0\u8282\u4FE1\u606F\u4E0D\u5B8C\u6574\uFF0C\u65E0\u6CD5\u52A0\u8F7D\u5185\u5BB9"),R.abrupt("return","");case 4:return R.prev=4,i=new Date().getTime(),g=f.accessToken||"congg:7e0efee65786976202e4fc20c6a98d89",O=f.apiBaseUrl||"https://reader.yucoder.cn/reader3",J="".concat(O).concat(tr.BOOK_CONTENT,"?accessToken=").concat(g,"&v=").concat(i),R.next=11,jt().post(J,{url:s.url,index:c.index});case 11:if(Y=R.sent,!(Y.data&&Y.data.data)){R.next=20;break}return T=Y.data.data||"",s.chapters||(s.chapters=[]),ft(c.index,T),s.chapters&&(ue=s.chapters.find(function(H){return H.index===c.index}),ue&&(ue.content=T)),R.abrupt("return",T);case 20:return console.error("\u7AE0\u8282\u5185\u5BB9\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E",Y.data),C.ZP.error("\u7AE0\u8282\u5185\u5BB9\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),R.abrupt("return","");case 23:R.next=30;break;case 25:return R.prev=25,R.t0=R.catch(4),console.error("\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9\u5931\u8D25",R.t0),C.ZP.error("\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5\u6216\u7A0D\u540E\u91CD\u8BD5"),R.abrupt("return","");case 30:case"end":return R.stop()}},r,null,[[4,25]])}));return function(s,c){return a.apply(this,arguments)}}(),Lt=function(r){try{var s=localStorage.getItem("fish-reader-books"),c=[];if(s){c=JSON.parse(s);var i=c.findIndex(function(T){return T.id===r.id});i>=0?c[i]=r:c.push(r)}else c=[r];localStorage.setItem("fish-reader-books",JSON.stringify(c));var g=localStorage.getItem("fish-reader-books");if(g){var O=JSON.parse(g),J=O.find(function(T){return T.id===r.id});if(J&&J.chapters&&J.chapters.length>0)var Y=J.chapters.find(function(T){return T.index===(r.lastReadChapter||0)})}}catch(T){console.error("\u66F4\u65B0\u672C\u5730\u5B58\u50A8\u5931\u8D25:",T)}},ft=function(r,s){try{if(t.chapters||(t.chapters=[]),t.chapters.length===0){console.error("\u7AE0\u8282\u5217\u8868\u4E3A\u7A7A\uFF0C\u65E0\u6CD5\u66F4\u65B0\u7AE0\u8282\u5185\u5BB9");return}var c=t.chapters.map(function(O){return O.index===r?b()(b()({},O),{},{content:s}):O});t.chapters=c,t.lastReadChapter=r;var i=b()(b()({},t),{},{chapters:c,lastReadChapter:r});Ze&&Ze.index===r&&be(b()(b()({},Ze),{},{content:s}));var g=i.chapters.find(function(O){return O.index===r});Lt(i),W(0,r)}catch(O){console.error("\u66F4\u65B0\u7AE0\u8282\u5185\u5BB9\u5931\u8D25:",O)}},zt=function(){if(k.current){var r=Math.max(0,(window.innerWidth-pe)/2),s=Math.max(0,(window.innerHeight-Re)/2);We({x:r,y:s}),k.current.style.transform="translate(".concat(r,"px, ").concat(s,"px)")}},an=[{name:"\u5C0F",width:600,height:500},{name:"\u4E2D",width:800,height:600},{name:"\u5927",width:1e3,height:700},{name:"\u5168\u5C4F",width:window.innerWidth-40,height:window.innerHeight-40}],sn=function(r,s){if(at(r),ct(s),k.current){var c=Math.max(0,(window.innerWidth-r)/2),i=Math.max(0,(window.innerHeight-s)/2);We({x:c,y:i}),k.current.style.transform="translate(".concat(c,"px, ").concat(i,"px)"),setTimeout(function(){return st()},100)}};(0,n.useEffect)(function(){var a=function(){if(pe>window.innerWidth-100&&at(window.innerWidth-40),Re>window.innerHeight-100&&ct(window.innerHeight-40),k.current){var s=k.current.getBoundingClientRect();if(s.right>window.innerWidth||s.bottom>window.innerHeight){var c=Math.min(ge.x,window.innerWidth-pe),i=Math.min(ge.y,window.innerHeight-Re);We({x:c,y:i}),k.current.style.transform="translate(".concat(c,"px, ").concat(i,"px)")}}};return window.addEventListener("resize",a),function(){return window.removeEventListener("resize",a)}},[pe,Re,ge]);var lr=(0,n.useCallback)(function(a){if(Q){var r=a.clientX,s=a.clientY,c=ge.x,i=ge.y,g=c,O=i,J=null,Y=function(){k.current&&(k.current.style.transform="translate(".concat(g,"px, ").concat(O,"px)"))},T=function(R){var H=R.clientX-r,ze=R.clientY-s;g=c+H,O=i+ze,J&&cancelAnimationFrame(J),J=requestAnimationFrame(Y)},ue=function re(){document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",re),document.body.style.cursor="",J&&cancelAnimationFrame(J),We({x:g,y:O}),st()};document.body.style.cursor="grabbing",document.addEventListener("mousemove",T),document.addEventListener("mouseup",ue),a.preventDefault(),a.stopPropagation()}},[Q,ge,st]),Qe=(0,n.useCallback)(function(a,r){if(Q){var s=a.clientX,c=a.clientY,i=pe,g=Re,O=ge.x,J=ge.y,Y=i,T=g,ue=O,re=J,R=null,H=function(){k.current&&(k.current.style.width="".concat(Y,"px"),k.current.style.height="".concat(T,"px"),k.current.style.transform="translate(".concat(ue,"px, ").concat(re,"px)"))},ze=function(bt){var _e=bt.clientX-s,et=bt.clientY-c;if(r.includes("e")&&(Y=Math.max(200,i+_e)),r.includes("w")){var pt=i-Math.max(200,i-_e);Y=Math.max(200,i-_e),ue=O+pt}if(r.includes("s")&&(T=Math.max(150,g+et)),r.includes("n")){var gt=g-Math.max(150,g-et);T=Math.max(150,g-et),re=J+gt}R&&cancelAnimationFrame(R),R=requestAnimationFrame(H)},ht=function qe(){document.removeEventListener("mousemove",ze),document.removeEventListener("mouseup",qe),document.body.style.cursor="",R&&cancelAnimationFrame(R),at(Y),ct(T),We({x:ue,y:re}),st()},Ye="default";r==="e"||r==="w"?Ye="ew-resize":r==="n"||r==="s"?Ye="ns-resize":r==="ne"||r==="sw"?Ye="nesw-resize":(r==="nw"||r==="se")&&(Ye="nwse-resize"),document.body.style.cursor=Ye,document.addEventListener("mousemove",ze),document.addEventListener("mouseup",ht),a.preventDefault(),a.stopPropagation()}},[Q,pe,Re,ge,st]),on=(0,n.useCallback)(function(){},[y,W]),cr=function(){Ot()},dr=function(){Nt()},Ot=function(){if(!(!t.chapters||t.chapters.length===0||M)){var r=Date.now(),s=r-L;s<800||($.current&&clearTimeout($.current),$.current=setTimeout(function(){var c=y-1;if(c>=0){if(m(r),Te(c),t.chapters){var i=t.chapters.find(function(g){return g.index===c});i?(be(i),i.content?(w(i.content),W(0,c)):dt(t,i).then(function(g){g?(w(g),ft(c,g),W(0,c)):(console.error("\u83B7\u53D6\u4E0A\u4E00\u7AE0\u5185\u5BB9\u5931\u8D25"),w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0</p>'))}).catch(function(g){console.error("\u52A0\u8F7D\u4E0A\u4E00\u7AE0\u5185\u5BB9\u51FA\u9519:",g),w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9\u51FA\u9519\uFF0C\u8BF7\u91CD\u8BD5</p>')})):console.error("\u672A\u627E\u5230\u4E0A\u4E00\u7AE0\u8282\uFF0C\u7D22\u5F15: ".concat(c))}oe.current&&(oe.current.scrollTop=0)}else C.ZP.info("\u5DF2\u7ECF\u662F\u7B2C\u4E00\u7AE0\u4E86");$.current=null},50))}},Nt=function(){if(!(!t.chapters||t.chapters.length===0||M)){var r=Date.now(),s=r-L;s<800||($.current&&clearTimeout($.current),$.current=setTimeout(function(){var c=y+1;if(t.chapters&&c<t.chapters.length){m(r),Te(c);var i=t.chapters.find(function(g){return g.index===c});i?(be(i),i.content?(w(i.content),W(0,c)):dt(t,i).then(function(g){g?(w(g),ft(c,g),W(0,c)):(console.error("\u83B7\u53D6\u4E0B\u4E00\u7AE0\u5185\u5BB9\u5931\u8D25"),w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u7AE0\u8282\u5185\u5BB9\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0</p>'))}).catch(function(g){console.error("\u52A0\u8F7D\u4E0B\u4E00\u7AE0\u5185\u5BB9\u51FA\u9519:",g),w('<p style="color: #ff4d4f; text-align: center; padding: 20px;">\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9\u51FA\u9519\uFF0C\u8BF7\u91CD\u8BD5</p>')})):console.error("\u672A\u627E\u5230\u4E0B\u4E00\u7AE0\u8282\uFF0C\u7D22\u5F15: ".concat(c)),oe.current&&(oe.current.scrollTop=0)}else C.ZP.info("\u5DF2\u7ECF\u662F\u6700\u540E\u4E00\u7AE0\u4E86");$.current=null},50))}},un=function(){var a=Ne()(ne()().mark(function r(){var s;return ne()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(Ze){i.next=4;break}return console.error("\u6CA1\u6709\u5F53\u524D\u7AE0\u8282\uFF0C\u65E0\u6CD5\u5237\u65B0"),C.ZP.error("\u6CA1\u6709\u5F53\u524D\u7AE0\u8282\uFF0C\u65E0\u6CD5\u5237\u65B0"),i.abrupt("return");case 4:return Ve(!0),se(!0),i.prev=6,i.next=9,dt(t,Ze);case 9:s=i.sent,s?(C.ZP.success("\u7AE0\u8282\u5185\u5BB9\u5DF2\u5237\u65B0"),w(s)):C.ZP.error("\u5237\u65B0\u7AE0\u8282\u5185\u5BB9\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),i.next=17;break;case 13:i.prev=13,i.t0=i.catch(6),console.error("\u5237\u65B0\u7AE0\u8282\u5185\u5BB9\u65F6\u51FA\u9519:",i.t0),C.ZP.error("\u5237\u65B0\u7AE0\u8282\u5185\u5BB9\u65F6\u51FA\u9519\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");case 17:return i.prev=17,Ve(!1),se(!1),i.finish(17);case 21:case"end":return i.stop()}},r,null,[[6,13,17,21]])}));return function(){return a.apply(this,arguments)}}(),ln=function(r){document.body.style.cursor!=="grabbing"&&r.button===0&&(or?(Ct(!1),Fe(!0),Dt.current&&clearTimeout(Dt.current),Dt.current=setTimeout(function(){Fe(!1),Ct(!0)},3e3)):(Fe(!F),F&&Ct(!0)))};(0,n.useEffect)(function(){var a=function(s){s.code===f.prevPageKey?cr():s.code===f.nextPageKey&&dr(),f.quickHide==="key"&&s.code==="Escape"&&we(!1)};return window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a)}},[f,cr,dr]),(0,n.useEffect)(function(){var a=function(){if(k.current){var s=k.current.getBoundingClientRect(),c=!1,i=ge.x,g=ge.y;if(s.right>window.innerWidth&&(i=Math.max(0,window.innerWidth-pe),c=!0),s.bottom>window.innerHeight&&(g=Math.max(0,window.innerHeight-Re),c=!0),s.left>window.innerWidth||s.top>window.innerHeight){zt();return}c&&(We({x:i,y:g}),k.current.style.transform="translate(".concat(i,"px, ").concat(g,"px)"))}};return window.addEventListener("resize",a),function(){return window.removeEventListener("resize",a)}},[pe,Re,ge,zt]),(0,n.useEffect)(function(){var a=setTimeout(function(){st()},500);return function(){return clearTimeout(a)}},[pe,Re,ge,st]),(0,n.useEffect)(function(){oe.current&&(oe.current.style.color=f.fontColor,oe.current.style.backgroundColor=f.backgroundColor,oe.current.style.fontSize="".concat(S,"px"),oe.current.style.fontFamily=f.fontFamily),Ae(f.opacity),Ce(f.allowWindowMove)},[f,S]),(0,n.useEffect)(function(){if(S!==f.fontSize||q!==f.opacity){var a=b()(b()({},f),{},{fontSize:S,opacity:q});localStorage.setItem("fish-reader-settings",JSON.stringify(a))}},[S,q,f]),(0,n.useEffect)(function(){Be(f.fontSize),Ae(f.opacity),Ce(f.allowWindowMove)},[f.fontSize,f.opacity,f.allowWindowMove]);var fr=[{label:"Arial",value:"Arial, sans-serif"},{label:"\u9ED1\u4F53",value:"SimHei, sans-serif"},{label:"\u5B8B\u4F53",value:"SimSun, serif"},{label:"\u5FAE\u8F6F\u96C5\u9ED1",value:'"Microsoft YaHei", sans-serif'},{label:"\u6977\u4F53",value:"KaiTi, serif"},{label:"\u4EFF\u5B8B",value:"FangSong, serif"},{label:"Times New Roman",value:'"Times New Roman", serif'}],cn=function(r){var s=fr.find(function(c){return c.value===r});return s?s.label:"\u9ED1\u4F53"};return(0,e.jsxs)("div",{ref:k,style:{display:Se?"block":"none",position:"fixed",width:"".concat(pe,"px"),height:"".concat(Re,"px"),maxWidth:"100%",margin:"0",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",borderRadius:"8px",overflow:"hidden",transition:"opacity 0.3s",opacity:q,backgroundColor:f.backgroundColor,color:f.fontColor,cursor:Q?"grab":"default",transform:"translate(".concat(ge.x,"px, ").concat(ge.y,"px)"),zIndex:1e3},onMouseDown:lr,children:[(0,e.jsxs)("div",{ref:Mt,style:{position:"absolute",top:0,left:0,right:0,padding:"12px",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"".concat(f.backgroundColor,"dd"),backdropFilter:"blur(4px)",zIndex:10,transition:"opacity 0.3s",opacity:F?1:0,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",pointerEvents:F?"auto":"none"},children:[(0,e.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,height:"4px",cursor:Q?"grab":"default",backgroundColor:"transparent"},onMouseDown:lr}),(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(Ar.Z,{}),onClick:le,type:"text"}),(0,e.jsx)(ve.Z,{title:"\u5237\u65B0\u7AE0\u8282",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(Qt.Z,{}),onClick:un,type:"text",disabled:He,loading:M&&He})}),(0,e.jsx)(ve.Z,{title:"\u91CD\u7F6E\u4F4D\u7F6E",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(qt.Z,{}),onClick:zt,type:"text",disabled:!Q})})]}),(0,e.jsx)(yt,{strong:!0,style:{fontSize:"16px",userSelect:"none"},children:(Ze==null?void 0:Ze.title)||t.title}),(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)(ve.Z,{title:"\u4E0A\u4E00\u7AE0",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(_t.Z,{}),onClick:function(){return Ot()},type:"text",disabled:!t.chapters||t.chapters.length===0||y<=0||M})}),(0,e.jsx)(ve.Z,{title:"\u4E0B\u4E00\u7AE0",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(er.Z,{}),onClick:function(){return Nt()},type:"text",disabled:!t.chapters||t.chapters.length===0||y>=t.chapters.length-1||M})}),(0,e.jsx)(wt.Z,{content:(0,e.jsxs)("div",{style:{width:"200px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px"},children:(0,e.jsx)(yt,{children:"\u5B57\u53F7\u8C03\u6574"})}),(0,e.jsx)(Et.Z,{min:12,max:36,value:S,onChange:function(r){Be(r),oe.current&&(oe.current.style.fontSize="".concat(r,"px"))}})]}),trigger:"click",placement:"bottom",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(Ir.Z,{}),type:"text"})}),(0,e.jsx)(wt.Z,{content:(0,e.jsxs)("div",{style:{width:"200px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px"},children:(0,e.jsx)(yt,{children:"\u9009\u62E9\u5B57\u4F53"})}),(0,e.jsx)(Ie.Z,{direction:"vertical",style:{width:"100%"},children:fr.map(function(a){return(0,e.jsx)(N.ZP,{type:f.fontFamily===a.value?"primary":"default",size:"small",style:{width:"100%",textAlign:"left"},onClick:function(){var s=b()(b()({},f),{},{fontFamily:a.value});localStorage.setItem("fish-reader-settings",JSON.stringify(s)),oe.current&&(oe.current.style.fontFamily=a.value)},children:a.label},a.value)})})]}),trigger:"click",placement:"bottom",children:(0,e.jsx)(N.ZP,{type:"text",children:cn(f.fontFamily)})}),(0,e.jsx)(wt.Z,{content:(0,e.jsxs)("div",{style:{width:"200px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px"},children:(0,e.jsx)(yt,{children:"\u900F\u660E\u5EA6\u8C03\u6574"})}),(0,e.jsx)(Et.Z,{min:0,max:1,step:.01,value:q,onChange:Ae})]}),trigger:"click",placement:"bottom",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(Pr.Z,{}),type:"text"})}),(0,e.jsx)(wt.Z,{content:(0,e.jsxs)("div",{style:{width:"200px"},children:[(0,e.jsx)("div",{style:{marginBottom:"8px"},children:(0,e.jsx)(yt,{children:"\u7A97\u53E3\u5927\u5C0F\u9884\u8BBE"})}),(0,e.jsx)(Ie.Z,{style:{marginTop:"8px"},children:an.map(function(a,r){return(0,e.jsx)(N.ZP,{onClick:function(){return sn(a.width,a.height)},size:"small",children:a.name},r)})})]}),trigger:"click",placement:"bottom",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(Mr.Z,{}),type:"text"})}),(0,e.jsx)(ve.Z,{title:"\u7A97\u53E3\u53EF\u79FB\u52A8",children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(qt.Z,{}),type:Q?"primary":"text",onClick:function(){var r=!Q;Ce(r);var s=b()(b()({},f),{},{allowWindowMove:r});localStorage.setItem("fish-reader-settings",JSON.stringify(s))}})})]})]}),M?(0,e.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",padding:"24px",backgroundColor:f.backgroundColor,opacity:.5,transition:"opacity 0.2s ease-in-out"},children:(0,e.jsx)(ut.Z,{tip:"\u6B63\u5728\u52A0\u8F7D\u7AE0\u8282\u5185\u5BB9...",size:"large"})}):(0,e.jsx)("div",{ref:oe,style:{height:"100%",overflow:"auto",padding:"24px",paddingTop:"64px",paddingBottom:"24px",fontSize:"".concat(S,"px"),lineHeight:"1.5",letterSpacing:"0px",fontFamily:f.fontFamily,color:f.fontColor,backgroundColor:f.backgroundColor,wordWrap:"break-word",textAlign:"justify",whiteSpace:"pre-wrap",userSelect:"none",scrollBehavior:"smooth",opacity:M?.5:1,transition:"opacity 0.2s ease-in-out"},onClick:ln,onScroll:on,dangerouslySetInnerHTML:{__html:_}}),(0,e.jsx)("div",{style:{position:"absolute",left:"16px",top:"50%",transform:"translateY(-50%)",opacity:F?.7:0,transition:"opacity 0.3s",zIndex:5},children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(_t.Z,{}),onClick:function(){return Ot()},shape:"circle",size:"large",disabled:!t.chapters||t.chapters.length===0||y<=0||M})}),(0,e.jsx)("div",{style:{position:"absolute",right:"16px",top:"50%",transform:"translateY(-50%)",opacity:F?.7:0,transition:"opacity 0.3s",zIndex:5},children:(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(er.Z,{}),onClick:function(){return Nt()},shape:"circle",size:"large",disabled:!t.chapters||t.chapters.length===0||y>=t.chapters.length-1||M})}),(0,e.jsx)("div",{style:{position:"absolute",right:0,top:"50%",width:"16px",height:"100px",marginTop:"-50px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"ew-resize",zIndex:10,borderRadius:"3px 0 0 3px",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"e")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",left:0,top:"50%",width:"16px",height:"100px",marginTop:"-50px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"ew-resize",zIndex:10,borderRadius:"0 3px 3px 0",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"w")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",bottom:0,left:"50%",width:"100px",height:"16px",marginLeft:"-50px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"ns-resize",zIndex:10,borderRadius:"3px 3px 0 0",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"s")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",top:0,left:"50%",width:"100px",height:"16px",marginLeft:"-50px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"ns-resize",zIndex:10,borderRadius:"0 0 3px 3px",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"n")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",right:0,bottom:0,width:"24px",height:"24px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"nwse-resize",zIndex:10,borderRadius:"0 0 8px 0",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"se")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",left:0,bottom:0,width:"24px",height:"24px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"nesw-resize",zIndex:10,borderRadius:"0 0 0 8px",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"sw")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",right:0,top:0,width:"24px",height:"24px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"nesw-resize",zIndex:10,borderRadius:"0 8px 0 0",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"ne")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}}),(0,e.jsx)("div",{style:{position:"absolute",left:0,top:0,width:"24px",height:"24px",background:F?"rgba(0,0,0,0.05)":"transparent",cursor:"nwse-resize",zIndex:10,borderRadius:"8px 0 0 0",transition:"background 0.3s"},onMouseDown:function(r){return Qe(r,"nw")},onMouseEnter:function(r){return r.currentTarget.style.background="rgba(0,0,0,0.2)"},onMouseLeave:function(r){return r.currentTarget.style.background=F?"rgba(0,0,0,0.05)":"transparent"}})]})},Lr=Dr,nt=l(2487),zr=l(79090),Or=l(34804),Nr=l(40110),Hr=xt.Z.Search,rr="https://reader.yucoder.cn/reader3/searchBookMultiSSE",nr="congg:7e0efee65786976202e4fc20c6a98d89",Wr=function(P){var t=P.onAddOnlineBook,f=(0,n.useState)(""),W=v()(f,2),le=W[0],ae=W[1],ce=(0,n.useState)(!1),_=v()(ce,2),w=_[0],xe=_[1],ee=(0,n.useState)([]),M=v()(ee,2),se=M[0],me=M[1],E=(0,n.useState)(-1),D=v()(E,2),de=D[0],fe=D[1],F=(0,n.useState)(1),Fe=v()(F,2),G=Fe[0],je=Fe[1],Se=(0,n.useState)(!1),we=v()(Se,2),Pe=we[0],ye=we[1],Q=(0,n.useState)(!1),Ce=v()(Q,2),he=Ce[0],Z=Ce[1],y=(0,n.useRef)(null),Te=(0,n.useRef)(-1);(0,n.useEffect)(function(){Te.current=de},[de]);var Ge=function(S){ae(S.target.value)},ke=function(){y.current&&(y.current.close(),y.current=null)};(0,n.useEffect)(function(){return function(){ke()}},[]);var Ze=function(){var De=Ne()(ne()().mark(function S(){var Be,X,o,h;return ne()().wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(le){U.next=3;break}return C.ZP.error("\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD"),U.abrupt("return");case 3:me([]),xe(!0),fe(-1),Te.current=-1,je(1),ye(!1),ke(),Be=new URLSearchParams({key:le,bookSourceUrl:"",bookSourceGroup:"",concurrentCount:"8",lastIndex:"-1",page:"1",accessToken:nr}),X="".concat(rr,"?").concat(Be.toString());try{o=new EventSource(X),y.current=o,h=[],o.onmessage=function(u){try{var L=u.data.trim();if(!L)return;var m=JSON.parse(L);fe(m.lastIndex);var te=m.data&&Array.isArray(m.data)?m.data.filter(function(V){return V.coverUrl}):[];te.length>0&&(h=[].concat(Oe()(h),Oe()(te)),me(function(V){return[].concat(Oe()(V),Oe()(te))}))}catch(V){console.error("\u89E3\u6790SSE\u6D88\u606F\u5931\u8D25:",V)}},o.addEventListener("end",function(u){try{var L=u.data.trim();if(!L)return;var m=JSON.parse(L);m.lastIndex!==void 0&&fe(m.lastIndex),ye(m.isEnd===!1),o.close(),y.current=null,xe(!1)}catch(te){console.error("\u89E3\u6790end\u4E8B\u4EF6\u5931\u8D25:",te)}}),o.onerror=function(u){console.error("SSE\u8FDE\u63A5\u9519\u8BEF:",u),C.ZP.error("\u641C\u7D22\u8BF7\u6C42\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),o.close(),y.current=null,xe(!1)},o.addEventListener("complete",function(){o.close(),y.current=null,xe(!1),h.length>0&&ye(!0)})}catch(u){console.error("\u521B\u5EFASSE\u8FDE\u63A5\u5931\u8D25:",u),C.ZP.error("\u641C\u7D22\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5"),xe(!1)}case 13:case"end":return U.stop()}},S)}));return function(){return De.apply(this,arguments)}}(),be=function(){if(!(he||!Pe)){Z(!0);var S=G+1,Be=new URLSearchParams({key:le,bookSourceUrl:"",bookSourceGroup:"",concurrentCount:"8",lastIndex:Te.current.toString(),page:S.toString(),accessToken:nr}),X="".concat(rr,"?").concat(Be.toString());try{var o=new EventSource(X);y.current=o;var h=[];o.onmessage=function(A){try{var U=A.data.trim();if(!U)return;var u=JSON.parse(U);fe(u.lastIndex);var L=u.data&&Array.isArray(u.data)?u.data.filter(function(m){return m.coverUrl}):[];L&&Array.isArray(L)&&L.length>0&&(h=[].concat(Oe()(h),Oe()(L)),me(function(m){return[].concat(Oe()(m),Oe()(L))}))}catch(m){console.error("\u89E3\u6790SSE\u6D88\u606F\u5931\u8D25:",m)}},o.addEventListener("end",function(A){try{var U=A.data.trim();if(!U)return;var u=JSON.parse(U);u.lastIndex!==void 0&&fe(u.lastIndex),ye(u.isEnd===!1),o.close(),y.current=null,Z(!1),je(S)}catch(L){console.error("\u89E3\u6790end\u4E8B\u4EF6\u5931\u8D25:",L)}}),o.onerror=function(A){console.error("SSE\u8FDE\u63A5\u9519\u8BEF:",A),o.close(),y.current=null,Z(!1)},o.addEventListener("complete",function(){o.close(),y.current=null,Z(!1),je(S),h.length>0&&ye(!0)})}catch(A){console.error("\u521B\u5EFASSE\u8FDE\u63A5\u5931\u8D25:",A),C.ZP.error("\u52A0\u8F7D\u66F4\u591A\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5"),Z(!1)}}},$e=function(S){var Be={id:Date.now(),title:S.name,author:S.author||"\u672A\u77E5\u4F5C\u8005",cover:S.coverUrl,format:"online",source:"online",url:S.bookUrl,sourceInfo:{name:S.originName||"\u672A\u77E5\u6765\u6E90",url:S.origin},chapters:[],lastReadPosition:0,lastReadChapter:0,lastReadTime:null};t(Be),C.ZP.success("\u5DF2\u6DFB\u52A0\u300A".concat(S.name,"\u300B\u5230\u4E66\u67B6"))};return(0,e.jsxs)("div",{style:{position:"relative",height:"70vh",display:"flex",flexDirection:"column"},children:[(0,e.jsx)("div",{style:{position:"sticky",top:0,zIndex:10,background:"#fff",padding:"12px 0",borderBottom:"1px solid #f0f0f0"},children:(0,e.jsx)(Hr,{placeholder:"\u8F93\u5165\u4E66\u540D\u6216\u4F5C\u8005\u641C\u7D22",enterButton:"\u641C\u7D22",size:"large",loading:w&&se.length===0,value:le,onChange:Ge,onSearch:Ze})}),(0,e.jsx)("div",{style:{flex:1,overflow:"auto",padding:"8px 0"},children:w&&se.length===0?(0,e.jsx)("div",{style:{textAlign:"center",padding:"30px 0"},children:(0,e.jsx)(ut.Z,{indicator:(0,e.jsx)(zr.Z,{style:{fontSize:24},spin:!0}),tip:"\u6B63\u5728\u641C\u7D22..."})}):se.length>0?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(nt.Z,{itemLayout:"vertical",dataSource:se,renderItem:function(S){return(0,e.jsxs)(nt.Z.Item,{actions:[(0,e.jsx)(N.ZP,{type:"primary",size:"small",onClick:function(){return $e(S)},children:"\u6DFB\u52A0\u5230\u4E66\u67B6"},"add")],extra:S.coverUrl?(0,e.jsx)("img",{width:70,alt:S.name,src:S.coverUrl,style:{maxHeight:100,objectFit:"cover"},onError:function(X){X.target.style.display="none",X.target.parentElement.appendChild(function(){var o=document.createElement("div");o.style.width="70px",o.style.height="100px",o.style.backgroundColor="#eee",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center";var h=document.createElement("span");return h.className="anticon anticon-book",h.style.fontSize="24px",h.style.color="#999",o.appendChild(h),o}())}}):(0,e.jsx)("div",{style:{width:70,height:100,background:"#eee",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,e.jsx)(rt.Z,{style:{fontSize:24,color:"#999"}})}),style:{padding:"8px 0"},children:[(0,e.jsx)(nt.Z.Item.Meta,{title:(0,e.jsx)("div",{style:{fontSize:"16px",marginBottom:"4px"},children:S.name}),description:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{style:{fontSize:"13px"},children:["\u4F5C\u8005: ",S.author||"\u672A\u77E5"]}),(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#666",display:"flex",flexWrap:"wrap",gap:"8px"},children:[S.kind&&(0,e.jsxs)("span",{children:["\u5206\u7C7B/\u65F6\u95F4: ",S.kind.split(",")[0]]}),S.wordCount&&(0,e.jsxs)("span",{children:["\u5B57\u6570: ",S.wordCount]})]}),(0,e.jsxs)("div",{style:{fontSize:12,color:"#1890ff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[(0,e.jsx)(Kt.Z,{style:{marginRight:4}}),S.originName||S.origin]})]})}),S.intro&&(0,e.jsx)(ve.Z,{title:(0,e.jsx)("div",{style:{width:"100%",padding:"10px",whiteSpace:"normal",wordBreak:"break-word",wordWrap:"break-word",fontSize:"14px",lineHeight:"1.8"},children:S.intro}),placement:"bottomLeft",color:"#fff",overlayInnerStyle:{color:"#333",minWidth:"400px",maxWidth:"600px",maxHeight:"400px",overflow:"auto"},children:(0,e.jsx)("div",{style:{fontSize:13,color:"#666",margin:"4px 0 0",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer"},children:S.intro})})]},"".concat(S.bookUrl,"-").concat(S.origin))},footer:Pe?(0,e.jsx)("div",{style:{textAlign:"center",padding:"12px 0",cursor:"pointer",color:"#1890ff"},onClick:be,children:he?(0,e.jsx)(ut.Z,{size:"small"}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Or.Z,{style:{marginRight:8}}),"\u52A0\u8F7D\u66F4\u591A"]})}):null}),w&&(0,e.jsx)("div",{style:{textAlign:"center",padding:"12px 0"},children:(0,e.jsx)(ut.Z,{size:"small",tip:"\u641C\u7D22\u4E2D..."})})]}):le&&!w?(0,e.jsx)(Ke.Z,{description:"\u6CA1\u6709\u627E\u5230\u76F8\u5173\u4E66\u7C4D"}):(0,e.jsxs)("div",{style:{textAlign:"center",padding:"40px 0",color:"#999"},children:[(0,e.jsx)(Nr.Z,{style:{fontSize:40,color:"#ccc",display:"block",marginBottom:16}}),(0,e.jsx)("p",{children:"\u8F93\u5165\u5173\u952E\u8BCD\u641C\u7D22\u4E66\u7C4D"})]})})]})},Ur=Wr,ar=tt.Z.Text,Kr=xt.Z.Search,sr={CHAPTER_LIST:"/getChapterList",BOOK_CONTENT:"/getBookContent"},kt=new Set,Jr=function(P){var t=P.book,f=P.onChapterSelect,W=P.settings,le=(0,n.useState)([]),ae=v()(le,2),ce=ae[0],_=ae[1],w=(0,n.useState)([]),xe=v()(w,2),ee=xe[0],M=xe[1],se=(0,n.useState)(!0),me=v()(se,2),E=me[0],D=me[1],de=(0,n.useState)(""),fe=v()(de,2),F=fe[0],Fe=fe[1],G=(0,n.useState)(!1),je=v()(G,2),Se=je[0],we=je[1],Pe=(0,n.useState)(!1),ye=v()(Pe,2),Q=ye[0],Ce=ye[1],he=(0,n.useRef)(null),Z=(0,n.useRef)(null),y=(0,n.useState)(!1),Te=v()(y,2),Ge=Te[0],ke=Te[1],Ze=(0,n.useRef)(!1);(0,n.useEffect)(function(){if(Ze.current&&t.chapters&&t.chapters.length>0){_(t.chapters),M(t.chapters),D(!1);return}Ze.current=!0;var X=function(){var o=Ne()(ne()().mark(function h(){var A,U,u;return ne()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(D(!0),m.prev=1,A=localStorage.getItem("fish-reader-books"),!A){m.next=12;break}if(U=JSON.parse(A),u=U.find(function(te){return te.id===t.id}),!(u&&u.chapters&&u.chapters.length>0)){m.next=12;break}return _(u.chapters),M(u.chapters),kt.add(t.id),D(!1),m.abrupt("return");case 12:if(!(t.chapters&&t.chapters.length>0)){m.next=18;break}_(t.chapters),M(t.chapters),kt.add(t.id),m.next=25;break;case 18:if(!(t.source==="online"&&t.url&&!kt.has(t.id))){m.next=24;break}return m.next=21,Be();case 21:kt.add(t.id),m.next=25;break;case 24:(!t.chapters||t.chapters.length===0)&&C.ZP.info("\u65E0\u6CD5\u83B7\u53D6\u7AE0\u8282\u5217\u8868\uFF0C\u8BF7\u5C1D\u8BD5\u5237\u65B0");case 25:m.next=31;break;case 27:m.prev=27,m.t0=m.catch(1),console.error("\u52A0\u8F7D\u7AE0\u8282\u5931\u8D25:",m.t0),C.ZP.error("\u52A0\u8F7D\u7AE0\u8282\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5");case 31:return m.prev=31,D(!1),m.finish(31);case 34:case"end":return m.stop()}},h,null,[[1,27,31,34]])}));return function(){return o.apply(this,arguments)}}();X()},[t.id]);var be=function(o){try{var h=localStorage.getItem("fish-reader-books");if(h){var A=JSON.parse(h),U=A.map(function(u){return u.id===o.id?o:u});localStorage.setItem("fish-reader-books",JSON.stringify(U))}}catch(u){console.error("\u66F4\u65B0\u672C\u5730\u5B58\u50A8\u5931\u8D25:",u)}},$e=function(o){if(Fe(o),!o.trim()){M(ce);return}var h=ce.filter(function(A){return A.title.toLowerCase().includes(o.toLowerCase())});M(h)},De=function(){var X=Ne()(ne()().mark(function o(h){var A,U,u,L,m,te,V,He,Ve,K,Ee,q,Ae,Xe,lt,pe;return ne()().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!Ge){I.next=2;break}return I.abrupt("return");case 2:if(A=localStorage.getItem("fish-reader-books"),!A){I.next=11;break}if(U=JSON.parse(A),u=U.find(function(ie){return ie.id===t.id}),!(u&&u.chapters)){I.next=11;break}if(L=u.chapters.find(function(ie){return ie.index===h.index}),!(L&&L.content)){I.next=11;break}return h.content||(m=b()(b()({},h),{},{content:L.content}),te=ce.map(function(ie){return ie.index===h.index?m:ie}),_(te),M(F?ee.map(function(ie){return ie.index===h.index?m:ie}):te)),I.abrupt("return",b()(b()({},h),{},{content:L.content}));case 11:if(!h.content){I.next=13;break}return I.abrupt("return",h);case 13:return ke(!0),C.ZP.loading("\u83B7\u53D6\u7AE0\u8282\u5185\u5BB9...",0),I.prev=15,V=new Date().getTime(),He=W.accessToken||"congg:7e0efee65786976202e4fc20c6a98d89",Ve=W.apiBaseUrl||"https://reader.yucoder.cn/reader3",K="".concat(Ve).concat(sr.BOOK_CONTENT,"?accessToken=").concat(He,"&v=").concat(V),I.next=22,jt().post(K,{url:t.url,index:h.index});case 22:if(Ee=I.sent,!(Ee.data&&Ee.data.data)){I.next=40;break}if(q=Ee.data.data||"",!(q&&q.length>0)){I.next=36;break}return Ae=b()(b()({},h),{},{content:q}),Xe=ce.map(function(ie){return ie.index===h.index?Ae:ie}),_(Xe),F?(lt=ee.map(function(ie){return ie.index===h.index?Ae:ie}),M(lt)):M(Xe),pe=b()(b()({},t),{},{chapters:Xe,lastReadChapter:h.index}),be(pe),C.ZP.success('\u7AE0\u8282"'.concat(h.title,'"\u5185\u5BB9\u52A0\u8F7D\u5B8C\u6210')),I.abrupt("return",Ae);case 36:console.error("\u83B7\u53D6\u5230\u7684\u5185\u5BB9\u4E3A\u7A7A"),C.ZP.error("\u83B7\u53D6\u7AE0\u8282\u5185\u5BB9\u5931\u8D25: \u5185\u5BB9\u4E3A\u7A7A");case 38:I.next=42;break;case 40:console.error("\u7AE0\u8282\u5185\u5BB9\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E",Ee.data),C.ZP.error("\u83B7\u53D6\u7AE0\u8282\u5185\u5BB9\u5931\u8D25: \u54CD\u5E94\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");case 42:I.next=48;break;case 44:I.prev=44,I.t0=I.catch(15),console.error("\u83B7\u53D6\u7AE0\u8282\u5185\u5BB9\u5931\u8D25:",I.t0),C.ZP.error("\u83B7\u53D6\u7AE0\u8282\u5185\u5BB9\u5931\u8D25: "+(I.t0.message||"\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5"));case 48:return I.prev=48,ke(!1),C.ZP.destroy(),I.finish(48);case 52:return I.abrupt("return",h);case 53:case"end":return I.stop()}},o,null,[[15,44,48,52]])}));return function(h){return X.apply(this,arguments)}}(),S=function(){var X=Ne()(ne()().mark(function o(h){var A;return ne()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(!(!h.content&&t.source==="online")){u.next=10;break}return u.next=3,De(h);case 3:if(u.t0=u.sent,u.t0){u.next=6;break}u.t0=h;case 6:A=u.t0,f(h.index,A),u.next=11;break;case 10:f(h.index,h);case 11:case"end":return u.stop()}},o)}));return function(h){return X.apply(this,arguments)}}(),Be=(0,n.useCallback)(Ne()(ne()().mark(function X(){var o,h,A,U,u,L,m,te,V,He;return ne()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:if(!(t.source!=="online"||!t.url)){K.next=3;break}return C.ZP.info("\u4EC5\u5728\u7EBF\u4E66\u7C4D\u652F\u6301\u5237\u65B0\u7AE0\u8282\u5217\u8868"),K.abrupt("return");case 3:if(!Se){K.next=6;break}return C.ZP.info("\u8BF7\u7A0D\u540E\u518D\u8BD5\uFF0C\u64CD\u4F5C\u8FC7\u4E8E\u9891\u7E41"),K.abrupt("return");case 6:if(we(!0),Ce(!0),D(!0),K.prev=9,o=localStorage.getItem("fish-reader-books"),!(!Q&&o)){K.next=21;break}if(h=JSON.parse(o),A=h.find(function(Ee){return Ee.id===t.id}),!(A&&A.chapters&&A.chapters.length>0)){K.next=21;break}return _(A.chapters),M(A.chapters),D(!1),Ce(!1),setTimeout(function(){we(!1)},1e3),K.abrupt("return");case 21:return U=new Date().getTime(),u=W.accessToken||"congg:7e0efee65786976202e4fc20c6a98d89",L=W.apiBaseUrl||"https://reader.yucoder.cn/reader3",m="".concat(L).concat(sr.CHAPTER_LIST,"?accessToken=").concat(u,"&v=").concat(U),K.next=27,jt().post(m,{url:t.url||t.sourceInfo.url,refresh:0,bookSourceUrl:t.sourceInfo.url});case 27:te=K.sent,te.data&&te.data.data&&Array.isArray(te.data.data)?(V=te.data.data,V.length>0?(ce.length>0&&V.forEach(function(Ee){var q=ce.find(function(Ae){return Ae.index===Ee.index||Ae.url===Ee.url});q&&q.content&&(Ee.content=q.content)}),_(V),M(V),He=b()(b()({},t),{},{chapters:V}),be(He),C.ZP.success("\u6210\u529F\u83B7\u53D6 ".concat(V.length," \u4E2A\u7AE0\u8282"))):C.ZP.error("\u672A\u80FD\u4ECE\u9875\u9762\u89E3\u6790\u51FA\u7AE0\u8282\u4FE1\u606F")):C.ZP.error("\u7AE0\u8282\u5217\u8868\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),K.next=35;break;case 31:K.prev=31,K.t0=K.catch(9),console.error("\u5237\u65B0\u7AE0\u8282\u5217\u8868\u5931\u8D25:",K.t0),C.ZP.error("\u5237\u65B0\u7AE0\u8282\u5217\u8868\u5931\u8D25: "+(K.t0.message||"\u8BF7\u68C0\u67E5\u7F51\u7EDC\u8FDE\u63A5"));case 35:return K.prev=35,D(!1),Ce(!1),setTimeout(function(){we(!1)},5e3),K.finish(35);case 40:case"end":return K.stop()}},X,null,[[9,31,35,40]])})),[t,Se,Q]);return(0,n.useEffect)(function(){!E&&ee.length>0&&t.lastReadChapter!==void 0&&t.lastReadChapter>=0&&he.current&&Z.current&&setTimeout(function(){he.current&&he.current.scrollIntoView({behavior:"smooth",block:"center"})},300)},[E,ee,t.lastReadChapter]),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{style:{marginBottom:16},children:(0,e.jsx)(Kr,{placeholder:"\u641C\u7D22\u7AE0\u8282\u6807\u9898",value:F,onChange:function(o){return Fe(o.target.value)},onSearch:$e,enterButton:!0})}),(0,e.jsxs)(Ie.Z,{style:{marginBottom:16},children:[(0,e.jsx)(N.ZP,{icon:(0,e.jsx)(Qt.Z,{}),onClick:Be,loading:Q,disabled:Se,children:"\u5237\u65B0\u7AE0\u8282"}),t.lastReadChapter!==void 0&&t.lastReadChapter>=0&&(0,e.jsx)(N.ZP,{onClick:function(){var o=ee.find(function(h){return h.index===t.lastReadChapter});o&&he.current&&he.current.scrollIntoView({behavior:"smooth",block:"center"})},children:"\u5B9A\u4F4D\u5230\u5F53\u524D\u7AE0\u8282"})]}),E?(0,e.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:(0,e.jsx)(ut.Z,{tip:"\u52A0\u8F7D\u7AE0\u8282\u4E2D..."})}):ee.length>0?(0,e.jsx)(nt.Z,{dataSource:ee,renderItem:function(o){return(0,e.jsx)(nt.Z.Item,{onClick:function(){return S(o)},style:{cursor:"pointer",padding:"8px 12px",transition:"all 0.3s",backgroundColor:t.lastReadChapter===o.index?"#f0f5ff":"transparent",borderLeft:t.lastReadChapter===o.index?"3px solid #1890ff":"3px solid transparent"},className:"chapter-item",ref:t.lastReadChapter===o.index?he:null,children:(0,e.jsxs)("div",{style:{width:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[o.title,t.lastReadChapter===o.index&&(0,e.jsx)(ar,{type:"secondary",style:{marginLeft:8,fontSize:12},children:"(\u5F53\u524D)"}),o.content?(0,e.jsx)(ar,{type:"secondary",style:{marginLeft:8,fontSize:12},children:"(\u5DF2\u7F13\u5B58)"}):null]})},o.index)},style:{maxHeight:"60vh",overflowY:"auto",border:"1px solid #f0f0f0",borderRadius:"4px"},ref:Z}):(0,e.jsx)(Ke.Z,{description:"\u6CA1\u6709\u627E\u5230\u7AE0\u8282",image:Ke.Z.PRESENTED_IMAGE_SIMPLE}),(0,e.jsx)("style",{children:`
          .chapter-item:hover {
            background-color: #f5f5f5 !important;
          }
        `})]})},Vr=Jr,It=tt.Z.Text,Yr=tt.Z.Paragraph,Gr=xt.Z.Search,$r=function(P){var t=P.book,f=P.onSearch,W=P.onSearchResultSelect,le=P.results,ae=(0,n.useState)(""),ce=v()(ae,2),_=ce[0],w=ce[1],xe=(0,n.useState)(!1),ee=v()(xe,2),M=ee[0],se=ee[1],me=(0,n.useState)([]),E=v()(me,2),D=E[0],de=E[1],fe=function(G){G.trim()&&(w(G),se(!0),f(G),setTimeout(function(){var je=Array.from({length:Math.floor(Math.random()*10)+1},function(Se,we){var Pe=Math.floor(Math.random()*1e4),ye="...",Q=G,Ce="...",he="".concat(ye).concat(Q).concat(Ce);return we%3===0?he="".concat(ye,'\u8FD9\u662F\u4E00\u6BB5\u5305\u542B"').concat(Q,'"\u7684\u793A\u4F8B\u6587\u672C\uFF0C\u7528\u4E8E\u5C55\u793A\u641C\u7D22\u7ED3\u679C\u7684\u4E0A\u4E0B\u6587\u3002').concat(Ce):we%3===1?he="".concat(ye,"\u8FD9\u4E2A").concat(Q,"\u51FA\u73B0\u5728\u4E86\u4E00\u4E2A\u53E5\u5B50\u4E2D\u95F4\u7684\u4F4D\u7F6E\uFF0C\u5468\u56F4\u6709\u4E00\u4E9B\u4E0A\u4E0B\u6587\u3002").concat(Ce):he="".concat(ye,"\u641C\u7D22\u793A\u4F8B\uFF0C").concat(Q,"\u53EF\u80FD\u51FA\u73B0\u5728\u53E5\u5B50\u7684\u7ED3\u5C3E").concat(Ce),{position:Pe,text:he,chapterIndex:Math.floor(Pe/1e3),chapterTitle:"\u7B2C".concat(Math.floor(Pe/1e3)+1,"\u7AE0")}});de(je),se(!1)},1500))},F=function(G){if(!_||!G)return(0,e.jsx)("span",{children:G});var je=G.split(new RegExp("(".concat(_,")"),"gi"));return(0,e.jsx)("span",{children:je.map(function(Se,we){return Se.toLowerCase()===_.toLowerCase()?(0,e.jsx)(It,{mark:!0,children:Se},we):(0,e.jsx)("span",{children:Se},we)})})};return(0,e.jsxs)("div",{children:[(0,e.jsx)(Gr,{placeholder:"\u641C\u7D22\u4E66\u7C4D\u5185\u5BB9",value:_,onChange:function(G){return w(G.target.value)},onSearch:fe,enterButton:!0,loading:M}),(0,e.jsx)(vt.Z,{orientation:"left",plain:!0,children:"\u641C\u7D22\u7ED3\u679C"}),M?(0,e.jsx)("div",{style:{textAlign:"center",padding:"40px 0"},children:(0,e.jsx)(ut.Z,{tip:"\u6B63\u5728\u641C\u7D22..."})}):D.length>0?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Yr,{type:"secondary",style:{marginBottom:16},children:["\u627E\u5230 ",D.length," \u4E2A\u5339\u914D\u7ED3\u679C"]}),(0,e.jsx)(nt.Z,{dataSource:D,renderItem:function(G){return(0,e.jsx)(nt.Z.Item,{style:{cursor:"pointer",padding:"12px",borderRadius:"4px",transition:"all 0.3s",marginBottom:"8px",background:"#fafafa"},onClick:function(){return W(G.position)},className:"search-result-item",children:(0,e.jsxs)("div",{children:[G.chapterTitle&&(0,e.jsx)("div",{style:{marginBottom:4},children:(0,e.jsx)(It,{strong:!0,children:G.chapterTitle})}),(0,e.jsx)("div",{children:F(G.text)}),(0,e.jsx)("div",{children:(0,e.jsxs)(It,{type:"secondary",style:{fontSize:12},children:["\u4F4D\u7F6E: ",G.position]})})]})},G.position)},style:{maxHeight:"60vh",overflowY:"auto"}})]}):_?(0,e.jsx)(Ke.Z,{description:"\u6CA1\u6709\u627E\u5230\u5339\u914D\u7684\u5185\u5BB9",image:Ke.Z.PRESENTED_IMAGE_SIMPLE}):(0,e.jsx)(Ke.Z,{description:"\u8BF7\u8F93\u5165\u5173\u952E\u8BCD\u8FDB\u884C\u641C\u7D22",image:Ke.Z.PRESENTED_IMAGE_SIMPLE}),(0,e.jsx)("style",{children:`
          .search-result-item:hover {
            background-color: #f0f0f0 !important;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.09);
          }
        `})]})},Xr=$r,Qr=Rt.Z.Header,qr=Rt.Z.Content,ir=tt.Z.Title,_r=Wt.Z.confirm,en=function(){var P=(0,n.useState)(!1),t=v()(P,2),f=t[0],W=t[1];return(0,n.useEffect)(function(){var le=function(){W(window.innerWidth<=768)};return le(),window.addEventListener("resize",le),function(){return window.removeEventListener("resize",le)}},[]),f},tn=function(){var P=localStorage.getItem("fish-reader-settings");if(P)try{return JSON.parse(P)}catch(t){console.error("\u89E3\u6790\u5DF2\u4FDD\u5B58\u7684\u9605\u8BFB\u5668\u8BBE\u7F6E\u5931\u8D25:",t)}return{fontColor:"#333333",backgroundColor:"#f5f5f5",opacity:1,allowWindowMove:!0,fontSize:12,fontFamily:"Arial, sans-serif",prevPageKey:"ArrowLeft",nextPageKey:"ArrowRight",quickHide:"none",panicKey:"Escape",accessToken:"congg:7e0efee65786976202e4fc20c6a98d89",apiBaseUrl:"https://reader.yucoder.cn/reader3"}};function rn(){var Je=(0,n.useState)([]),P=v()(Je,2),t=P[0],f=P[1],W=(0,n.useState)(!0),le=v()(W,2),ae=le[0],ce=le[1],_=(0,n.useState)(!1),w=v()(_,2),xe=w[0],ee=w[1],M=(0,n.useState)(!1),se=v()(M,2),me=se[0],E=se[1],D=(0,n.useState)(!1),de=v()(D,2),fe=de[0],F=de[1],Fe=(0,n.useState)(!1),G=v()(Fe,2),je=G[0],Se=G[1],we=(0,n.useState)(!1),Pe=v()(we,2),ye=Pe[0],Q=Pe[1],Ce=(0,n.useState)(null),he=v()(Ce,2),Z=he[0],y=he[1],Te=(0,n.useState)(tn()),Ge=v()(Te,2),ke=Ge[0],Ze=Ge[1],be=(0,n.useState)(""),$e=v()(be,2),De=$e[0],S=$e[1],Be=(0,n.useState)([]),X=v()(Be,2),o=X[0],h=X[1],A=(0,n.useState)(!1),U=v()(A,2),u=U[0],L=U[1],m=en(),te=mr.Z.useToken(),V=te.token,He=(0,wr.useModel)("globalReader"),Ve=He.showReader,K=(0,n.useState)(localStorage.getItem("fish-reader-floating-mode")===null?!0:localStorage.getItem("fish-reader-floating-mode")==="true"),Ee=v()(K,2),q=Ee[0],Ae=Ee[1];(0,n.useEffect)(function(){localStorage.setItem("fish-reader-floating-mode",q.toString())},[q]);var Xe=function(){L(!u),localStorage.setItem("fish-reader-study-mode",JSON.stringify(!u))};(0,n.useEffect)(function(){var p=localStorage.getItem("fish-reader-study-mode");if(p)try{L(JSON.parse(p))}catch(d){console.error("\u89E3\u6790\u5DF2\u4FDD\u5B58\u7684\u5B66\u4E60\u6A21\u5F0F\u8BBE\u7F6E\u5931\u8D25:",d)}},[]),(0,n.useEffect)(function(){var p=function(){var d=Ne()(ne()().mark(function x(){var B,z;return ne()().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:try{ce(!0),B=localStorage.getItem("fish-reader-books"),B&&f(JSON.parse(B)),z=localStorage.getItem("fish-reader-settings"),z&&Ze(JSON.parse(z))}catch(oe){console.error("\u52A0\u8F7D\u4E66\u7C4D\u5217\u8868\u5931\u8D25:",oe)}finally{ce(!1)}case 1:case"end":return k.stop()}},x)}));return function(){return d.apply(this,arguments)}}();p()},[]),(0,n.useEffect)(function(){localStorage.setItem("fish-reader-settings",JSON.stringify(ke))},[ke]),(0,n.useEffect)(function(){return function(){var p=document.querySelectorAll(".custom-context-menu");p.forEach(function(d){document.body.contains(d)&&document.body.removeChild(d)})}},[]);var lt=function(){var d=document.querySelectorAll(".custom-context-menu");d.forEach(function(x){document.body.contains(x)&&document.body.removeChild(x)})},pe=function(){ee(!0)},at=function(d){var x=[].concat(Oe()(t),[d]);f(x),localStorage.setItem("fish-reader-books",JSON.stringify(x)),C.ZP.success("\u4E66\u7C4D\u5BFC\u5165\u6210\u529F")},I=function(d){var x=[].concat(Oe()(t),[d]);f(x),localStorage.setItem("fish-reader-books",JSON.stringify(x)),C.ZP.success("\u5728\u7EBF\u4E66\u7C4D\u6DFB\u52A0\u6210\u529F")},ie=function(d){var x=JSON.parse(localStorage.getItem("fish-reader-books")||"[]"),B=x.find(function(k){return k.id===d.id}),z=b()(b()({},d),{},{lastReadChapter:(B==null?void 0:B.lastReadChapter)||0});y(z),localStorage.setItem("fish-reader-last-book",z.id.toString());var $=t.map(function(k){return k.id===z.id?z:k});f($),localStorage.setItem("fish-reader-books",JSON.stringify($)),q?Ve(z.id):E(!0)},Re=function(){F(!0)},ct=function(d){localStorage.setItem("fish-reader-settings",JSON.stringify(d)),Ze(d),F(!1),C.ZP.success("\u8BBE\u7F6E\u5DF2\u4FDD\u5B58\u5E76\u5E94\u7528")},St=function(d,x){x&&x.stopPropagation(),y(d),Se(!0)},Zt=function(d,x){if(Z){var B;if(x&&Z.chapters){var z=Z.chapters.map(function(Ue){return Ue.index===d?b()(b()({},Ue),{},{content:x.content}):Ue});B=b()(b()({},Z),{},{lastReadChapter:d,chapters:z})}else B=b()(b()({},Z),{},{lastReadChapter:d});var $=localStorage.getItem("fish-reader-books");if($){var k=JSON.parse($),oe=k.map(function(Ue){return Ue.id===B.id?B:Ue});localStorage.setItem("fish-reader-books",JSON.stringify(oe))}E(!1),setTimeout(function(){y(B),f(t.map(function(Ue){return Ue.id===B.id?B:Ue})),Se(!1),q?Ve(B.id):E(!0)},100)}},ge=function(d){S(d),Z&&Z.source==="local"?h([]):C.ZP.info("\u5728\u7EBF\u4E66\u7C4D\u6682\u4E0D\u652F\u6301\u5185\u5BB9\u641C\u7D22")},We=function(d){if(Z){var x=b()(b()({},Z),{},{lastReadPosition:d});y(x),f(t.map(function(B){return B.id===x.id?x:B})),Q(!1),E(!0)}},Pt=function(d,x){x&&x.stopPropagation(),_r({title:"\u786E\u8BA4\u5220\u9664",content:"\u786E\u5B9A\u8981\u5220\u9664\u8FD9\u672C\u4E66\u5417\uFF1F\u6B64\u64CD\u4F5C\u4E0D\u53EF\u6062\u590D\u3002",okText:"\u786E\u8BA4",cancelText:"\u53D6\u6D88",onOk:function(){var z=t.filter(function($){return $.id!==d});f(z),localStorage.setItem("fish-reader-books",JSON.stringify(z)),C.ZP.success("\u4E66\u7C4D\u5DF2\u5220\u9664")}})},Bt=function(d,x,B){var z=Date.now(),$=t.map(function(k){return k.id===d?b()(b()({},k),{},{lastReadPosition:x,lastReadChapter:B!==void 0?B:k.lastReadChapter,lastReadTime:z}):k});f($),Z&&Z.id===d&&y(b()(b()({},Z),{},{lastReadPosition:x,lastReadChapter:B!==void 0?B:Z.lastReadChapter,lastReadTime:z}))},or=function(d){var x=(0,e.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#eaeaea",color:"#999",fontSize:"32px"},children:(0,e.jsx)(rt.Z,{})});return d.cover?(0,e.jsx)("img",{src:d.cover,alt:d.title,style:{width:"100%",height:"100%",objectFit:"cover"},onError:function(z){z.currentTarget.style.display="none",z.currentTarget.parentElement.appendChild(document.createTextNode("")),z.currentTarget.parentElement.style.backgroundColor="#eaeaea",z.currentTarget.parentElement.style.display="flex",z.currentTarget.parentElement.style.alignItems="center",z.currentTarget.parentElement.style.justifyContent="center";var $=document.createElement("span");$.className="anticon anticon-book",$.style.fontSize="32px",$.style.color="#999",z.currentTarget.parentElement.appendChild($)}}):x},Ct=function(d){switch(d){case"txt":return(0,e.jsx)(Ut.Z,{});case"epub":return(0,e.jsx)(rt.Z,{});case"mobi":return(0,e.jsx)(rt.Z,{});case"online":return(0,e.jsx)(Kt.Z,{});default:return(0,e.jsx)(Ut.Z,{})}},Mt=function(d){var x=new Date(d);return x.toLocaleString()},Ft=function(){me&&E(!1),F(!1),Se(!1),Q(!1),ee(!1),u||(L(!0),localStorage.setItem("fish-reader-study-mode","true")),C.ZP.success("\u5DF2\u5207\u6362\u5230\u5DE5\u4F5C\u6A21\u5F0F")};return(0,n.useEffect)(function(){var p=function(x){x.code===ke.panicKey&&Ft()};return window.addEventListener("keydown",p),function(){window.removeEventListener("keydown",p)}},[ke.panicKey,me,u]),(0,e.jsxs)(Rt.Z,{style:{minHeight:"100vh"},children:[(0,e.jsxs)(Qr,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0 16px",background:V.colorBgContainer,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",position:"sticky",top:0,zIndex:1},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[u?(0,e.jsx)(Jt.Z,{style:{fontSize:24,color:V.colorPrimary,marginRight:8}}):(0,e.jsx)(rt.Z,{style:{fontSize:24,color:V.colorPrimary,marginRight:8}}),(0,e.jsx)(ir,{style:{color:V.colorText,margin:0},level:4,children:u?"\u52AA\u529B\u5B66\u4E60":"\u6478\u9C7C\u9605\u8BFB"})]}),(0,e.jsxs)(Ie.Z,{children:[(0,e.jsx)(ve.Z,{title:q?"\u60AC\u6D6E\u7A97\u9605\u8BFB\u6A21\u5F0F\u5DF2\u5F00\u542F":"\u5F00\u542F\u60AC\u6D6E\u7A97\u9605\u8BFB\u6A21\u5F0F",children:(0,e.jsx)(yr.Z,{dot:me&&q,offset:[-5,5],children:(0,e.jsx)(N.ZP,{type:q?"primary":"text",icon:(0,e.jsx)(Er.Z,{}),onClick:function(){return Ae(!q)}})})}),(0,e.jsx)(ve.Z,{title:u?"\u5207\u6362\u5230\u6478\u9C7C\u6A21\u5F0F":"\u5207\u6362\u5230\u5B66\u4E60\u6A21\u5F0F",children:(0,e.jsx)(N.ZP,{type:"text",icon:u?(0,e.jsx)(rt.Z,{}):(0,e.jsx)(Vt.Z,{}),onClick:Xe})}),(0,e.jsx)(N.ZP,{type:"text",icon:(0,e.jsx)(jr.Z,{}),onClick:Re,children:"\u8BBE\u7F6E"})]})]}),(0,e.jsx)(qr,{style:{padding:m?"12px":"24px"},children:(0,e.jsxs)(Sr.Z,{children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[(0,e.jsxs)(ir,{level:4,style:{fontSize:m?"18px":"20px",margin:0},children:[u?(0,e.jsx)(Jt.Z,{}):(0,e.jsx)(rt.Z,{})," ",u?"\u5B66\u4E60\u5FC3\u5F97":"\u6211\u7684\u4E66\u67B6"]}),(0,e.jsx)(Ie.Z,{children:(0,e.jsx)(ve.Z,{title:"\u60AC\u6D6E\u7A97\u9605\u8BFB\u6A21\u5F0F",children:(0,e.jsx)(Cr.Z,{checked:q,onChange:Ae,checkedChildren:"\u60AC\u6D6E",unCheckedChildren:"\u9875\u5185"})})})]}),(0,e.jsx)(vt.Z,{}),u?(0,e.jsxs)("div",{style:{textAlign:"center",padding:"40px 0"},children:[(0,e.jsx)("img",{src:"https://pic1.imgdb.cn/item/680a1eb158cb8da5c8c90187.jpg",alt:"\u5B66\u4E60\u56FE\u7247",style:{width:"150px",marginBottom:"20px"}}),(0,e.jsx)(tt.Z.Paragraph,{style:{fontSize:"16px"},children:"\u6B63\u5728\u4E13\u6CE8\u5DE5\u4F5C\u4E2D\uFF0C\u8BF7\u52FF\u6253\u6270..."}),(0,e.jsx)(tt.Z.Paragraph,{type:"secondary",children:"\u4ECA\u65E5\u5DE5\u4F5C\u76EE\u6807\uFF1A\u6309\u65F6\u5B8C\u6210\u4EA7\u54C1\u9700\u6C42\uFF0C\u4FDD\u8BC1\u4EA7\u51FA"})]}):t.length>0?(0,e.jsxs)("div",{style:{display:"grid",gridTemplateColumns:m?"repeat(2, 1fr)":"repeat(4, 1fr)",gap:"12px"},children:[(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",cursor:"pointer",transition:"all 0.3s",transform:"translateY(0)",backgroundColor:"#fff",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",height:"100%",border:"2px dashed #d9d9d9",minHeight:"120px"},onClick:pe,onMouseEnter:function(d){d.currentTarget.style.transform="translateY(-5px)",d.currentTarget.style.boxShadow="0 5px 15px rgba(0,0,0,0.2)",d.currentTarget.style.borderColor=V.colorPrimary},onMouseLeave:function(d){d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)",d.currentTarget.style.borderColor="#d9d9d9"},children:[(0,e.jsx)(Yt.Z,{style:{fontSize:"32px",color:V.colorPrimary,marginBottom:"8px"}}),(0,e.jsx)("div",{style:{fontSize:"14px",color:V.colorTextSecondary},children:"\u641C\u7D22\u4E66\u7C4D"})]}),t.map(function(p){return(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",cursor:"pointer",transition:"all 0.3s",transform:"translateY(0)",backgroundColor:"#fff",borderRadius:"8px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",height:"100%",position:"relative",padding:"16px"},onClick:function(){return ie(p)},onMouseEnter:function(x){x.currentTarget.style.transform="translateY(-5px)",x.currentTarget.style.boxShadow="0 5px 15px rgba(0,0,0,0.2)";var B=x.currentTarget.querySelector(".book-action-buttons");B&&(B.style.opacity="1")},onMouseLeave:function(x){x.currentTarget.style.transform="translateY(0)",x.currentTarget.style.boxShadow="0 2px 8px rgba(0,0,0,0.1)";var B=x.currentTarget.querySelector(".book-action-buttons");B&&(B.style.opacity="0")},children:[(0,e.jsxs)("div",{className:"book-action-buttons",style:{position:"absolute",top:"8px",right:"8px",zIndex:2,display:"flex",gap:"8px",opacity:0,transition:"opacity 0.3s"},children:[(0,e.jsx)(N.ZP,{type:"text",size:"small",icon:(0,e.jsx)(Gt.Z,{}),onClick:function(x){return St(p,x)},title:"\u7AE0\u8282\u8DF3\u8F6C"}),(0,e.jsx)(N.ZP,{type:"text",size:"small",danger:!0,icon:(0,e.jsx)($t.Z,{}),onClick:function(x){return Pt(p.id,x)},title:"\u5220\u9664\u5C0F\u8BF4"})]}),(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,e.jsx)("div",{style:{marginRight:"8px"},children:Ct(p.format)}),(0,e.jsx)(br.Z,{color:"blue",children:p.format.toUpperCase()})]}),(0,e.jsxs)("div",{style:{flex:1},children:[(0,e.jsx)("div",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"8px",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.4"},children:p.title}),p.author&&(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#888",marginBottom:"8px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["\u4F5C\u8005: ",p.author]}),p.lastReadTime&&(0,e.jsxs)("div",{style:{fontSize:"12px",color:"#aaa"},children:["\u4E0A\u6B21\u9605\u8BFB: ",Mt(p.lastReadTime)]})]})]},p.id)})]}):(0,e.jsx)(Ke.Z,{description:(0,e.jsxs)("div",{style:{textAlign:"center"},children:[(0,e.jsx)("p",{style:{marginBottom:"8px",color:"#8c8c8c"},children:"\u4F60\u7684\u4E66\u67B6\u7A7A\u7A7A\u5982\u4E5F\uFF5E"}),(0,e.jsxs)(N.ZP,{type:"primary",onClick:pe,children:[(0,e.jsx)(Yt.Z,{})," \u641C\u7D22\u4E66\u7C4D"]})]}),image:Ke.Z.PRESENTED_IMAGE_SIMPLE,style:{margin:"40px 0"}})]})}),(0,e.jsx)(Wt.Z,{title:"\u641C\u7D22\u4E66\u7C4D",open:xe,onCancel:function(){return ee(!1)},footer:[(0,e.jsx)(N.ZP,{onClick:function(){return ee(!1)},children:"\u5173\u95ED"},"close")],width:800,children:(0,e.jsx)(Ur,{onAddLocalBook:at,onAddOnlineBook:I})}),(0,e.jsx)(Tt.Z,{title:"\u9605\u8BFB\u5668\u8BBE\u7F6E",placement:"right",width:400,onClose:function(){return F(!1)},open:fe,children:(0,e.jsx)(Rr,{settings:ke,onSave:ct})}),(0,e.jsx)(Tt.Z,{title:"\u7AE0\u8282\u5217\u8868",placement:"right",width:400,onClose:function(){return Se(!1)},open:je,zIndex:1003,children:Z&&(0,e.jsx)(Vr,{book:Z,onChapterSelect:Zt,settings:ke})}),(0,e.jsx)(Tt.Z,{title:"\u641C\u7D22\u5185\u5BB9",placement:"right",width:400,onClose:function(){return Q(!1)},open:ye,zIndex:1003,children:Z&&Z.source==="local"&&(0,e.jsx)(Xr,{book:Z,onSearch:ge,onSearchResultSelect:We,results:o})}),me&&Z&&(0,e.jsxs)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1002,backgroundColor:"rgba(0, 0, 0, 0.3)"},children:[(0,e.jsxs)("div",{style:{position:"absolute",top:10,right:10,zIndex:1010},children:[(0,e.jsx)(ve.Z,{title:"\u7AE0\u8282\u5217\u8868",children:(0,e.jsx)(N.ZP,{type:"primary",shape:"circle",icon:(0,e.jsx)(Gt.Z,{}),onClick:function(d){d.stopPropagation(),Z&&St(Z)},style:{marginRight:8}})}),(0,e.jsx)(ve.Z,{title:"\u7D27\u6025\u5207\u6362\u5230\u5DE5\u4F5C\u6A21\u5F0F",children:(0,e.jsx)(N.ZP,{type:"primary",danger:!0,shape:"circle",icon:(0,e.jsx)(Vt.Z,{}),onClick:Ft,style:{marginRight:8},title:"\u7D27\u6025\u5207\u6362\u5230\u5DE5\u4F5C\u6A21\u5F0F"})}),(0,e.jsx)(ve.Z,{title:"\u5173\u95ED\u9605\u8BFB\u5668",children:(0,e.jsx)(N.ZP,{type:"primary",danger:!0,shape:"circle",icon:(0,e.jsx)($t.Z,{}),onClick:function(){E(!1)}})})]}),(0,e.jsx)(Lr,{book:Z,settings:ke,onProgressUpdate:function(d,x){return Bt(Z.id,d,x)},onOpenChapterList:function(){return St(Z)}},"book-reader-".concat(Z.id))]})]})}}}]);
