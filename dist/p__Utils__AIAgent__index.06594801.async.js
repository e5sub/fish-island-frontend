"use strict";(self.webpackChunkreact_frontend_init=self.webpackChunkreact_frontend_init||[]).push([[6482],{42853:function(Bn,Ze,n){n.r(Ze),n.d(Ze,{default:function(){return ea}});var be=n(57566),U=n.n(be),Re=n(52487),me=n.n(Re),_e=n(64581),z=n.n(_e),He=n(84136),B=n.n(He),Le=n(90785),g=n.n(Le),r=n(67294),ve=n(26058),fe=n(71471),Y=n(55102),Z=n(68872),Ke=n(50136),p=n(83622),M=n(78957),Ue=n(85418),ae=n(34041),Ye=n(83062),Ge=n(4393),G=n(82061),Ie=n(50228),ze=n(51042),Qe=n(13923),Pe=n(43425),O=n(1413),Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},Me=Xe,ue=n(91146),we=function(o,x){return r.createElement(ue.Z,(0,O.Z)((0,O.Z)({},o),{},{ref:x,icon:Me}))},pe=r.forwardRef(we),he=pe,Ae=n(79090),We=n(27496),se=n(11941),y=n(47019),l=n(17788),F=n(2487),mn=n(32983),vn=n(86738),fn=n(96074),pn=n(47389),Rn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM769.1 441.7l-59.4 59.4-186.8-186.8 59.4-59.4c24.9-24.9 58.1-38.7 93.4-38.7 35.3 0 68.4 13.7 93.4 38.7 24.9 24.9 38.7 58.1 38.7 93.4 0 35.3-13.8 68.4-38.7 93.4zm-190.2 105a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 69-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2zM441.7 769.1a131.32 131.32 0 01-93.4 38.7c-35.3 0-68.4-13.7-93.4-38.7a131.32 131.32 0 01-38.7-93.4c0-35.3 13.7-68.4 38.7-93.4l59.4-59.4 186.8 186.8-59.4 59.4z"}}]},name:"api",theme:"outlined"},_n=Rn,Ln=function(o,x){return r.createElement(ue.Z,(0,O.Z)((0,O.Z)({},o),{},{ref:x,icon:_n}))},Kn=r.forwardRef(Ln),Fn=Kn,Un=n(29158),zn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M938 458.8l-29.6-312.6c-1.5-16.2-14.4-29-30.6-30.6L565.2 86h-.4c-3.2 0-5.7 1-7.6 2.9L88.9 557.2a9.96 9.96 0 000 14.1l363.8 363.8c1.9 1.9 4.4 2.9 7.1 2.9s5.2-1 7.1-2.9l468.3-468.3c2-2.1 3-5 2.8-8zM459.7 834.7L189.3 564.3 589 164.6 836 188l23.4 247-399.7 399.7zM680 256c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm0 120c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]},name:"tag",theme:"outlined"},wn=zn,Wn=function(o,x){return r.createElement(ue.Z,(0,O.Z)((0,O.Z)({},o),{},{ref:x,icon:wn}))},Jn=r.forwardRef(Wn),Vn=Jn,$n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},Hn=$n,Yn=function(o,x){return r.createElement(ue.Z,(0,O.Z)((0,O.Z)({},o),{},{ref:x,icon:Hn}))},Gn=r.forwardRef(Yn),Qn=Gn,e=n(85893),Je=ae.Z.Option,qe=se.Z.TabPane,Be=fe.Z.Text,fa=fe.Z.Title,Dn=["\u{1F916}","\u{1F9E0}","\u{1F52E}","\u{1F4DD}","\u{1F48E}","\u{1F468}\u200D\u{1F4BB}","\u{1F50D}","\u2728","\u{1F9E9}","\u{1F308}","\u{1F680}","\u{1F52C}","\u{1F310}","\u{1F3AF}","\u{1F9BE}","\u{1F506}","\u26A1","\u{1F31F}"],hn=[{key:"DeepSeek",name:"DeepSeek",icon:"\u{1F468}\u200D\u{1F4BB}",endpoint:"https://api.deepseek.com",models:[{value:"deepseek-chat",label:"DeepSeek V3"},{value:"deepseek-reasoner",label:"DeepSeek R1"}],apiKeyUrl:"https://platform.deepseek.com/api_keys"},{key:"Siliconflow",name:"\u7845\u57FA\u6D41\u52A8",icon:"\u{1F916}",endpoint:"https://api.siliconflow.cn",models:[{value:"deepseek-ai/DeepSeek-V3",label:"DeepSeek V3"},{value:"deepseek-ai/DeepSeek-R1",label:"DeepSeek R1"}],apiKeyUrl:"https://cloud.siliconflow.cn/account/ak"},{key:"Alibaba",name:"\u963F\u91CC\u5DF4\u5DF4",icon:"\u{1F50D}",endpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/",models:[{value:"qwen-turbo",label:"\u901A\u4E49\u5343\u95EETurbo"},{value:"qwen-max",label:"\u901A\u4E49\u5343\u95EEMax"},{value:"qwen-plus",label:"\u901A\u4E49\u5343\u95EEPlus"}],apiKeyUrl:"https://bailian.console.aliyun.com/?tab=model#/api-key"}],ke="ai-agent-providers",Xn=function(o){var x,b=o.visible,T=o.onClose,c=o.models,de=o.onAddModel,N=o.onUpdateModel,Q=o.onDeleteModel,Fe=y.Z.useForm(),H=g()(Fe,1),C=H[0],k=y.Z.useForm(),X=g()(k,1),j=X[0],D=y.Z.useForm(),V=g()(D,1),q=V[0],De=(0,r.useState)(!1),ee=g()(De,2),ie=ee[0],en=ee[1],nn=(0,r.useState)(null),tn=g()(nn,2),Se=tn[0],an=tn[1],sn=(0,r.useState)("manage"),R=g()(sn,2),ge=R[0],ce=R[1],rn=(0,r.useState)([]),_=g()(rn,2),v=_[0],L=_[1],je=(0,r.useState)(""),Te=g()(je,2),K=Te[0],ye=Te[1],ln=(0,r.useState)([]),$e=g()(ln,2),yn=$e[0],xn=$e[1],Cn=(0,r.useState)([]),on=g()(Cn,2),un=on[0],dn=on[1],En=(0,r.useState)(!1),cn=g()(En,2),xe=cn[0],u=cn[1],i=(0,r.useState)(null),d=g()(i,2),h=d[0],le=d[1],Ce=(0,r.useState)(!1),ne=g()(Ce,2),Ee=ne[0],Ne=ne[1],Tn=(0,r.useState)(null),S=g()(Tn,2),W=S[0],oe=S[1];(0,r.useEffect)(function(){var a=localStorage.getItem(ke);if(a)try{var t=JSON.parse(a);L(t)}catch(s){console.error("Failed to parse saved providers",s),L(hn)}else L(hn),localStorage.setItem(ke,JSON.stringify(hn))},[]),(0,r.useEffect)(function(){b&&ce("manage")},[b]),(0,r.useEffect)(function(){var a=v.map(function(t){return{value:t.key,label:"".concat(t.icon," ").concat(t.name)}});xn(a),!K&&v.length>0&&(ye(v[0].key),$(v[0].key))},[v]);var $=function(t){var s=v.find(function(m){return m.key===t});dn(s?s.models:[])},P=function(){C.resetFields(),en(!1),an(null),v.length>0&&(ye(v[0].key),$(v[0].key))},E=function(){j.resetFields(),u(!1),le(null)},An=function(){q.resetFields(),Ne(!1),oe(null)},na=function(){var a=me()(U()().mark(function t(){var s,m;return U()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.prev=0,f.next=3,C.validateFields();case 3:s=f.sent,m={key:ie&&Se?Se:"model-".concat(Date.now()),name:s.name,provider:s.provider,icon:s.icon,accessKey:s.accessKey,apiEndpoint:s.apiEndpoint,modelType:s.modelType},ie&&Se?N(m):de(m),P(),ce("manage"),f.next=13;break;case 10:f.prev=10,f.t0=f.catch(0),console.error("Form validation failed:",f.t0);case 13:case"end":return f.stop()}},t,null,[[0,10]])}));return function(){return a.apply(this,arguments)}}(),ta=function(){var a=me()(U()().mark(function t(){var s,m,I;return U()().wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.prev=0,J.next=3,j.validateFields();case 3:m=J.sent,I={key:xe&&h?h:"provider-".concat(Date.now()),name:m.name,icon:m.icon,endpoint:m.endpoint,apiKeyUrl:m.apiKeyUrl,models:xe&&h?((s=v.find(function(A){return A.key===h}))===null||s===void 0?void 0:s.models)||[]:[]},L(xe&&h?function(A){return A.map(function(te){return te.key===h?I:te})}:function(A){return[].concat(z()(A),[I])}),localStorage.setItem(ke,JSON.stringify(xe&&h?v.map(function(A){return A.key===h?I:A}):[].concat(z()(v),[I]))),E(),Z.ZP.success("\u6210\u529F".concat(xe?"\u66F4\u65B0":"\u6DFB\u52A0","\u63D0\u4F9B\u5546: ").concat(m.name)),J.next=14;break;case 11:J.prev=11,J.t0=J.catch(0),console.error("Provider form validation failed:",J.t0);case 14:case"end":return J.stop()}},t,null,[[0,11]])}));return function(){return a.apply(this,arguments)}}(),aa=function(){var a=me()(U()().mark(function t(){var s,m,I,f;return U()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.prev=0,A.next=3,q.validateFields();case 3:if(s=A.sent,m=v.find(function(te){return te.key===K}),m){A.next=8;break}return Z.ZP.error("\u8BF7\u5148\u9009\u62E9\u63D0\u4F9B\u5546"),A.abrupt("return");case 8:I={value:Ee&&W?W:s.value,label:s.label},f=v.map(function(te){return te.key===K?Ee&&W?B()(B()({},te),{},{models:te.models.map(function(Nn){return Nn.value===W?I:Nn})}):B()(B()({},te),{},{models:[].concat(z()(te.models),[I])}):te}),L(f),localStorage.setItem(ke,JSON.stringify(f)),An(),$(K),Z.ZP.success("\u6210\u529F".concat(Ee?"\u66F4\u65B0":"\u6DFB\u52A0","\u6A21\u578B\u7C7B\u578B: ").concat(s.label)),A.next=20;break;case 17:A.prev=17,A.t0=A.catch(0),console.error("Model type form validation failed:",A.t0);case 20:case"end":return A.stop()}},t,null,[[0,17]])}));return function(){return a.apply(this,arguments)}}(),sa=function(t){var s=c.some(function(I){return I.provider===t});if(s){Z.ZP.error("\u8BE5\u63D0\u4F9B\u5546\u5DF2\u88AB\u6A21\u578B\u4F7F\u7528\uFF0C\u65E0\u6CD5\u5220\u9664");return}var m=v.filter(function(I){return I.key!==t});L(m),localStorage.setItem(ke,JSON.stringify(m)),Z.ZP.success("\u5DF2\u5220\u9664\u63D0\u4F9B\u5546"),t===K&&m.length>0&&(ye(m[0].key),$(m[0].key))},ra=function(t){u(!0),le(t.key),j.setFieldsValue({name:t.name,icon:t.icon,endpoint:t.endpoint,apiKeyUrl:t.apiKeyUrl||""})},ia=function(t){var s=c.some(function(f){return f.modelType===t});if(s){Z.ZP.error("\u8BE5\u6A21\u578B\u7C7B\u578B\u5DF2\u88AB\u4F7F\u7528\uFF0C\u65E0\u6CD5\u5220\u9664");return}var m=v.find(function(f){return f.key===K});if(m){var I=v.map(function(f){return f.key===K?B()(B()({},f),{},{models:f.models.filter(function(J){return J.value!==t})}):f});L(I),localStorage.setItem(ke,JSON.stringify(I)),Z.ZP.success("\u5DF2\u5220\u9664\u6A21\u578B\u7C7B\u578B"),$(K)}},la=function(t){Ne(!0),oe(t.value),q.setFieldsValue({value:t.value,label:t.label})},oa=function(t){console.log(t),en(!0),an(t.key),ce("add"),ye(t.provider),$(t.provider),C.setFieldsValue({name:t.name,provider:t.provider,icon:t.icon,accessKey:t.accessKey||"",apiEndpoint:t.apiEndpoint||"",modelType:t.modelType||""})},ua=function(t){Q(t)},da=function(t){ce(t),t==="add"&&P()},ca=function(t){ye(t),$(t);var s=v.find(function(m){return m.key===t});s&&C.setFieldsValue({apiEndpoint:s.endpoint,modelType:void 0})},ma=function(t){if(t){var s=un.find(function(f){return f.value===t});if(s&&!ie){var m=v.find(function(f){return f.key===K}),I=m?"(".concat(m.name,")"):"";C.setFieldsValue({name:"".concat(s.label).concat(I)})}}},va=function(t){var s=v.find(function(m){return m.key===t});s&&s.apiKeyUrl?window.open(s.apiKeyUrl,"_blank"):Z.ZP.info("\u8BE5\u63D0\u4F9B\u5546\u672A\u63D0\u4F9BAPI\u5BC6\u94A5\u83B7\u53D6\u5730\u5740")};return(0,e.jsx)(l.Z,{title:"AI\u6A21\u578B\u8BBE\u7F6E",open:b,onCancel:function(){P(),E(),An(),ce("manage"),T()},footer:null,width:700,children:(0,e.jsxs)(se.Z,{activeKey:ge,onChange:da,children:[(0,e.jsxs)(qe,{tab:"\u7BA1\u7406\u6A21\u578B",children:[(0,e.jsx)("div",{style:{minHeight:300,maxHeight:500,overflow:"auto"},children:(0,e.jsx)(F.Z,{itemLayout:"horizontal",dataSource:c,locale:{emptyText:(0,e.jsx)(mn.Z,{description:"\u6682\u65E0\u6A21\u578B\uFF0C\u8BF7\u70B9\u51FB'\u6DFB\u52A0\u6A21\u578B'\u6309\u94AE\u6DFB\u52A0"})},renderItem:function(t){return(0,e.jsx)(F.Z.Item,{actions:[function(){var s=v.find(function(m){return m.key===t.provider});return s!=null&&s.apiKeyUrl?(0,e.jsx)(p.ZP,{type:"link",onClick:function(){return va(t.provider)},children:"\u83B7\u53D6\u5BC6\u94A5"},"getKey"):null}(),(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(pn.Z,{}),type:"text",onClick:function(){return oa(t)}},"edit"),(0,e.jsx)(vn.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6A21\u578B\u5417\uFF1F",onConfirm:function(){return ua(t.key)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(G.Z,{}),type:"text",danger:!0})},"delete")],children:(0,e.jsx)(F.Z.Item.Meta,{avatar:(0,e.jsx)("div",{style:{fontSize:24},children:t.icon}),title:t.name,description:(0,e.jsxs)(M.Z,{direction:"vertical",size:0,children:[(0,e.jsxs)(Be,{type:"secondary",children:["\u63D0\u4F9B\u5546: ",t.provider]}),t.modelType&&(0,e.jsxs)(Be,{type:"secondary",children:["\u6A21\u578B\u7C7B\u578B: ",t.modelType]}),t.accessKey&&(0,e.jsx)(Be,{type:"secondary",children:"API\u5BC6\u94A5: \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})})})}})}),(0,e.jsx)("div",{style:{marginTop:16,textAlign:"right"},children:(0,e.jsx)(p.ZP,{type:"primary",icon:(0,e.jsx)(ze.Z,{}),onClick:function(){return ce("add")},children:"\u6DFB\u52A0\u6A21\u578B"})})]},"manage"),(0,e.jsxs)(qe,{tab:"\u7BA1\u7406\u63D0\u4F9B\u5546",children:[(0,e.jsx)("div",{style:{minHeight:300,maxHeight:500,overflow:"auto"},children:(0,e.jsx)(F.Z,{itemLayout:"horizontal",dataSource:v,locale:{emptyText:(0,e.jsx)(mn.Z,{description:"\u6682\u65E0\u63D0\u4F9B\u5546\uFF0C\u8BF7\u70B9\u51FB'\u6DFB\u52A0\u63D0\u4F9B\u5546'\u6309\u94AE\u6DFB\u52A0"})},renderItem:function(t){return(0,e.jsx)(F.Z.Item,{actions:[(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(pn.Z,{}),type:"text",onClick:function(){return ra(t)}},"edit"),(0,e.jsx)(vn.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u63D0\u4F9B\u5546\u5417\uFF1F",onConfirm:function(){return sa(t.key)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",disabled:c.some(function(s){return s.provider===t.key}),children:(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(G.Z,{}),type:"text",danger:!0,disabled:c.some(function(s){return s.provider===t.key})})},"delete")],children:(0,e.jsx)(F.Z.Item.Meta,{avatar:(0,e.jsx)("div",{style:{fontSize:24},children:t.icon}),title:t.name,description:(0,e.jsxs)(M.Z,{direction:"vertical",size:0,children:[(0,e.jsxs)(Be,{type:"secondary",children:["API\u7AEF\u70B9: ",t.endpoint]}),t.apiKeyUrl&&(0,e.jsxs)(Be,{type:"secondary",children:["API\u5BC6\u94A5\u83B7\u53D6: ",(0,e.jsx)("a",{href:t.apiKeyUrl,target:"_blank",rel:"noopener noreferrer",children:"\u83B7\u53D6\u5BC6\u94A5"})]}),(0,e.jsxs)(Be,{type:"secondary",children:["\u6A21\u578B\u6570\u91CF: ",t.models.length]})]})})})}})}),(0,e.jsx)(fn.Z,{orientation:"left",children:"\u6DFB\u52A0/\u7F16\u8F91\u63D0\u4F9B\u5546"}),(0,e.jsxs)(y.Z,{form:j,layout:"vertical",initialValues:{icon:"\u{1F916}"},children:[(0,e.jsx)(y.Z.Item,{name:"name",label:"\u63D0\u4F9B\u5546\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63D0\u4F9B\u5546\u540D\u79F0"}],children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: DeekSeek"})}),(0,e.jsx)(y.Z.Item,{name:"icon",label:"\u56FE\u6807",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u56FE\u6807"}],children:(0,e.jsx)(ae.Z,{children:Dn.map(function(a){return(0,e.jsx)(Je,{value:a,children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{style:{fontSize:20},children:a}),(0,e.jsx)("span",{children:a})]})},a)})})}),(0,e.jsx)(y.Z.Item,{name:"endpoint",label:"\u9ED8\u8BA4API\u7AEF\u70B9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165API\u7AEF\u70B9URL"}],tooltip:"\u6B64\u63D0\u4F9B\u5546\u7684\u9ED8\u8BA4API\u7AEF\u70B9\u5730\u5740",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Fn,{}),placeholder:"https://api.example.com"})}),(0,e.jsx)(y.Z.Item,{name:"apiKeyUrl",label:"API\u5BC6\u94A5\u83B7\u53D6\u5730\u5740",tooltip:"\u7528\u6237\u53EF\u4EE5\u4ECE\u8FD9\u4E2A\u5730\u5740\u83B7\u53D6API\u5BC6\u94A5\uFF08\u9009\u586B\uFF09",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Un.Z,{}),placeholder:"https://example.com/get-api-key"})}),(0,e.jsx)(y.Z.Item,{children:(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(p.ZP,{onClick:E,children:"\u53D6\u6D88"}),(0,e.jsx)(p.ZP,{type:"primary",onClick:ta,children:xe?"\u66F4\u65B0\u63D0\u4F9B\u5546":"\u6DFB\u52A0\u63D0\u4F9B\u5546"})]})})})]})]},"providers"),(0,e.jsxs)(qe,{tab:"\u7BA1\u7406\u6A21\u578B\u7C7B\u578B",children:[(0,e.jsx)("div",{style:{marginBottom:16},children:(0,e.jsx)(y.Z.Item,{label:"\u9009\u62E9\u63D0\u4F9B\u5546",children:(0,e.jsx)(ae.Z,{value:K,onChange:ye,style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u63D0\u4F9B\u5546",optionLabelProp:"label",children:v.map(function(a){return(0,e.jsx)(Je,{value:a.key,label:"".concat(a.icon," ").concat(a.name),children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{children:a.icon}),(0,e.jsx)("span",{children:a.name})]})},a.key)})})})}),K&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{minHeight:200,maxHeight:300,overflow:"auto"},children:(0,e.jsx)(F.Z,{itemLayout:"horizontal",dataSource:((x=v.find(function(a){return a.key===K}))===null||x===void 0?void 0:x.models)||[],locale:{emptyText:(0,e.jsx)(mn.Z,{description:"\u8BE5\u63D0\u4F9B\u5546\u6682\u65E0\u6A21\u578B\u7C7B\u578B\uFF0C\u8BF7\u6DFB\u52A0"})},renderItem:function(t){return(0,e.jsx)(F.Z.Item,{actions:[(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(pn.Z,{}),type:"text",onClick:function(){return la(t)}},"edit"),(0,e.jsx)(vn.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6A21\u578B\u7C7B\u578B\u5417\uFF1F",onConfirm:function(){return ia(t.value)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",disabled:c.some(function(s){return s.modelType===t.value}),children:(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(G.Z,{}),type:"text",danger:!0,disabled:c.some(function(s){return s.modelType===t.value})})},"delete")],children:(0,e.jsx)(F.Z.Item.Meta,{avatar:(0,e.jsx)(Vn,{style:{fontSize:18}}),title:t.label,description:(0,e.jsxs)(Be,{type:"secondary",children:["ID: ",t.value]})})})}})}),(0,e.jsx)(fn.Z,{orientation:"left",children:"\u6DFB\u52A0/\u7F16\u8F91\u6A21\u578B\u7C7B\u578B"}),(0,e.jsxs)(y.Z,{form:q,layout:"vertical",children:[(0,e.jsx)(y.Z.Item,{name:"value",label:"\u6A21\u578BID",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6A21\u578BID"}],tooltip:"\u6A21\u578B\u7684\u552F\u4E00\u6807\u8BC6\u7B26\uFF0C\u7528\u4E8EAPI\u8BF7\u6C42",children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: deepseek-chat",disabled:Ee})}),(0,e.jsx)(y.Z.Item,{name:"label",label:"\u663E\u793A\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0"}],tooltip:"\u6A21\u578B\u7684\u53CB\u597D\u663E\u793A\u540D\u79F0",children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: DeepSeek V3"})}),(0,e.jsx)(y.Z.Item,{children:(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(p.ZP,{onClick:An,children:"\u53D6\u6D88"}),(0,e.jsx)(p.ZP,{type:"primary",onClick:aa,disabled:!K,children:Ee?"\u66F4\u65B0\u6A21\u578B\u7C7B\u578B":"\u6DFB\u52A0\u6A21\u578B\u7C7B\u578B"})]})})})]})]})]},"modelTypes"),(0,e.jsx)(qe,{tab:ie?"\u7F16\u8F91\u6A21\u578B":"\u6DFB\u52A0\u6A21\u578B",children:(0,e.jsxs)(y.Z,{form:C,layout:"vertical",initialValues:{icon:"\u{1F916}",provider:v.length>0?v[0].key:""},children:[(0,e.jsx)(y.Z.Item,{name:"provider",label:"\u63D0\u4F9B\u5546",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u63D0\u4F9B\u5546"}],children:(0,e.jsx)(ae.Z,{onChange:ca,optionLabelProp:"label",children:v.map(function(a){return(0,e.jsx)(Je,{value:a.key,label:"".concat(a.icon," ").concat(a.name),children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{children:a.icon}),(0,e.jsx)("span",{children:a.name})]})},a.key)})})}),(0,e.jsx)(y.Z.Item,{name:"modelType",label:"\u6A21\u578B\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6A21\u578B\u7C7B\u578B"}],children:(0,e.jsx)(ae.Z,{onChange:ma,showSearch:!0,optionFilterProp:"label",placeholder:"\u9009\u62E9\u6A21\u578B\u7C7B\u578B",children:un.map(function(a){return(0,e.jsx)(Je,{value:a.value,label:a.label,children:a.label},a.value)})})}),(0,e.jsx)(y.Z.Item,{name:"name",label:"\u663E\u793A\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6A21\u578B\u540D\u79F0"}],children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: DeepSeek V3"})}),(0,e.jsx)(y.Z.Item,{name:"icon",label:"\u56FE\u6807",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u56FE\u6807"}],children:(0,e.jsx)(ae.Z,{children:Dn.map(function(a){return(0,e.jsx)(Je,{value:a,children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{style:{fontSize:20},children:a}),(0,e.jsx)("span",{children:a})]})},a)})})}),(0,e.jsx)(fn.Z,{orientation:"left",children:"API\u914D\u7F6E"}),(0,e.jsx)(y.Z.Item,{name:"accessKey",label:"API\u5BC6\u94A5",rules:[{required:!0,message:"\u8BF7\u8F93\u5165API\u5BC6\u94A5"}],tooltip:"AI\u63D0\u4F9B\u5546\u7684API\u8BBF\u95EE\u5BC6\u94A5\uFF0C\u5C06\u5B89\u5168\u5B58\u50A8\u5728\u672C\u5730",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Qn,{}),placeholder:"\u8F93\u5165\u60A8\u7684API\u5BC6\u94A5"})}),(0,e.jsx)(y.Z.Item,{name:"apiEndpoint",label:"API\u7AEF\u70B9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165API\u7AEF\u70B9URL"}],tooltip:"AI\u670D\u52A1\u63D0\u4F9B\u5546\u7684API\u7AEF\u70B9\u5730\u5740",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Fn,{}),placeholder:"https://api.example.com"})}),(0,e.jsx)(y.Z.Item,{children:(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(p.ZP,{onClick:function(){P(),ce("manage")},children:"\u53D6\u6D88"}),(0,e.jsx)(p.ZP,{type:"primary",onClick:na,children:ie?"\u66F4\u65B0":"\u6DFB\u52A0"})]})})})]})},"add")]})})},qn=Xn,Sn=n(47221),Zn=n(68997),bn=n(74330),et=n(38925),nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"},tt=nt,at=function(o,x){return r.createElement(ue.Z,(0,O.Z)((0,O.Z)({},o),{},{ref:x,icon:tt}))},st=r.forwardRef(at),In=st,rt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},it=rt,lt=function(o,x){return r.createElement(ue.Z,(0,O.Z)((0,O.Z)({},o),{},{ref:x,icon:it}))},ot=r.forwardRef(lt),ut=ot,dt=n(87547),ct=n(27484),Pn=n.n(ct),mt=n(56840),vt=n.n(mt),ft=n(556),pt=n(4958),ht=n(48592),gt=n(5891),jt=n(11215),gn=n.n(jt),jn=(0,gt.Z)(gn(),{});jn.registerLanguage=function(w,o){return gn().register(o)},jn.alias=function(w,o){return gn().alias(w,o)};var re=jn,yt=n(74346),xt=n(96412),Ct=n.n(xt),Et=Ct(),At=n(36155),Bt=n.n(At),Mn=Bt(),Ft=n(4979),Dt=n.n(Ft),kn=Dt(),St=n(6979),Zt=n.n(St),bt=Zt(),It=n(12049),Pt=n.n(It),Mt=Pt(),kt=n(45950),Ot=n.n(kt),Tt=Ot(),Nt=n(15909),Rt=n.n(Nt),_t=Rt(),Lt=n(88284),Kt=n(85175),Ut=["className","children"];re.registerLanguage("jsx",Et),re.registerLanguage("javascript",Mn),re.registerLanguage("js",Mn),re.registerLanguage("typescript",kn),re.registerLanguage("ts",kn),re.registerLanguage("bash",bt),re.registerLanguage("css",Mt),re.registerLanguage("json",Tt),re.registerLanguage("java",_t);var zt=function(o){var x=o.content,b=(0,r.useState)(null),T=g()(b,2),c=T[0],de=T[1],N=function(H,C){navigator.clipboard.writeText(H).then(function(){de(C),Z.ZP.success("\u4EE3\u7801\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"),setTimeout(function(){de(null)},2e3)},function(k){console.error("\u590D\u5236\u5931\u8D25: ",k),Z.ZP.error("\u590D\u5236\u5931\u8D25")})},Q=0;return(0,e.jsx)("div",{className:"markdown-content",children:(0,e.jsx)(ft.UG,{remarkPlugins:[pt.Z],rehypePlugins:[ht.Z],components:{code:function(H){var C=H.className,k=H.children,X=vt()(H,Ut),j=/language-(\w+)/.exec(C||""),D=j!==null,V=D?Q++:-1,q=Array.isArray(k)?k.join(""):String(k||"");return D?(0,e.jsxs)("div",{className:"code-block-wrapper",children:[(0,e.jsxs)("div",{className:"code-block-header",children:[(0,e.jsx)("span",{className:"code-language",children:j?j[1]:"code"}),(0,e.jsx)(p.ZP,{className:"copy-button",type:"text",size:"small",icon:c===V?(0,e.jsx)(Lt.Z,{}):(0,e.jsx)(Kt.Z,{}),onClick:function(){return N(q,V)},children:c===V?"\u5DF2\u590D\u5236":"\u590D\u5236"})]}),(0,e.jsx)(re,B()(B()({style:yt.Z,language:j?j[1]:"",PreTag:"div"},X),{},{children:q.replace(/\n$/,"")}))]}):(0,e.jsx)("code",B()(B()({className:C},X),{},{children:k}))}},children:x})})},On=zt,Oe=fe.Z.Text,wt=fe.Z.Paragraph,Wt=Sn.Z.Panel,Jt=r.memo(function(w){var o=w.message,x=w.models,b=function(){if(o.model){var j=x.find(function(D){return D.key===o.model});if(j)return"".concat(j.icon," ").concat(j.name)}return null},T=function(j){return Pn()(j).format("YYYY-MM-DD HH:mm:ss")},c=o.role==="user",de=!c&&o.content==="",N=!!(o.thinking||o.reasoning_process),Q=function(){return o.reasoning_process||o.thinking||""},Fe=!c&&o.content===""&&N,H=!c&&o.error===!0,C=(0,e.jsx)(Ae.Z,{style:{fontSize:24,color:"#1890ff"},spin:!0}),k=function(j){var D=0,V=[/^#{1,6}\s.+$/m,/(`{1,3})[\s\S]*?\1/,/\[.+?\]\(.+?\)/,/!\[.+?\]\(.+?\)/,/^(\s*[-*+]\s+)(?!\[[x ]\]).*$/m,/^\s*\d+\.\s+.+$/m,/^\s*([-*+])\s+\[[x ]\].+$/m,/^\|.+\|.+\|$/m,/^>.+$/m,/^-{3,}$/m,/\*\*.+?\*\*/,/\*.+?\*/,/~~.+?~~/,/^```[\s\S]+?```$/m];if(V.forEach(function(De){De.test(j)&&D++}),D>=2)return!0;var q=/```[\s\S]+?```/;return!!q.test(j)};return(0,e.jsx)("div",{className:"message-item ".concat(c?"user-message":"ai-message"),children:(0,e.jsxs)("div",{className:"message-container",style:{justifyContent:c?"flex-end":"flex-start"},children:[!c&&(0,e.jsx)(Zn.Z,{className:"message-avatar",icon:(0,e.jsx)(Ie.Z,{}),style:{backgroundColor:"#52c41a"}}),(0,e.jsxs)("div",{className:"message-bubble",style:{marginLeft:c?"auto":"8px",marginRight:c?"8px":"auto",background:c?"linear-gradient(145deg, #5e9cea, #4881d6)":"#f5f5f5",color:c?"white":"rgba(0, 0, 0, 0.85)",borderRadius:c?"18px 18px 4px 18px":"18px 18px 18px 4px",maxWidth:"80%"},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,e.jsxs)(Oe,{strong:!0,style:{color:c?"white":"rgba(0, 0, 0, 0.85)"},children:[c?"\u7528\u6237":"\u52A9\u624B",!c&&b()&&(0,e.jsxs)(Oe,{style:{marginLeft:8,fontSize:12,color:"rgba(0, 0, 0, 0.45)"},children:["(",b(),")"]})]}),(0,e.jsx)(Oe,{className:"message-time",style:{color:c?"rgba(255, 255, 255, 0.85)":"rgba(0, 0, 0, 0.45)",marginLeft:"12px",fontSize:"11px"},children:T(o.timestamp)})]}),de&&!N?(0,e.jsxs)("div",{className:"thinking-animation",children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"12px 0"},children:[(0,e.jsx)(bn.Z,{indicator:C}),(0,e.jsx)(Oe,{style:{marginLeft:12,color:"rgba(0, 0, 0, 0.65)"},children:"AI\u6B63\u5728\u601D\u8003\u4E2D"})]}),(0,e.jsxs)("div",{className:"typing-animation",children:[(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"})]})]}):Fe?(0,e.jsxs)("div",{className:"thinking-process",children:[(0,e.jsxs)("div",{className:"thinking-process-header",children:[(0,e.jsx)(In,{className:"bulb-icon"}),(0,e.jsx)(Oe,{className:"thinking-title",children:"\u601D\u8003\u8FC7\u7A0B\uFF1A"}),(0,e.jsx)(bn.Z,{indicator:(0,e.jsx)(Ae.Z,{style:{fontSize:14,marginLeft:"8px"},spin:!0})})]}),(0,e.jsx)("div",{className:"message-thinking",children:Q()})]}):H?(0,e.jsx)(et.Z,{message:"\u8BF7\u6C42\u9519\u8BEF",description:(0,e.jsxs)("div",{className:"error-message",children:[(0,e.jsxs)("div",{className:"error-title",children:[(0,e.jsx)(ut,{style:{color:"#ff4d4f",marginRight:"8px"}}),"\u670D\u52A1\u5668\u8FD4\u56DE\u9519\u8BEF:"]}),(0,e.jsx)("div",{className:"error-content",children:o.errorMessage||o.content.replace("[\u9519\u8BEF] \u8BF7\u6C42\u5931\u8D25\uFF1A","")}),(0,e.jsx)("div",{className:"error-hint",children:"\u5E38\u89C1\u9519\u8BEF\u539F\u56E0: API\u5BC6\u94A5\u4E0D\u6B63\u786E\u3001\u670D\u52A1\u5668\u8FDE\u63A5\u95EE\u9898\u3001\u6A21\u578B\u4E0D\u53EF\u7528\u6216\u8BF7\u6C42\u53C2\u6570\u9519\u8BEF"})]}),type:"error",showIcon:!1,className:"error-alert",style:{borderRadius:"8px"}}):(0,e.jsx)("div",{className:"message-content",style:{color:c?"white":"rgba(0, 0, 0, 0.85)"},children:!c&&k(o.content)?(0,e.jsx)(On,{content:o.content}):(0,e.jsx)(wt,{style:{color:c?"white":"rgba(0, 0, 0, 0.85)"},children:o.content})}),o.content&&N&&!c&&(0,e.jsx)(Sn.Z,{ghost:!0,className:"thinking-collapse",expandIcon:function(j){var D=j.isActive;return(0,e.jsx)(In,{style:{color:D?"#faad14":"rgba(0, 0, 0, 0.45)",fontSize:16}})},children:(0,e.jsx)(Wt,{header:(0,e.jsx)(Oe,{type:"secondary",children:"\u601D\u8003\u8FC7\u7A0B"}),children:(0,e.jsx)("div",{className:"message-thinking",children:k(Q())?(0,e.jsx)(On,{content:Q()}):Q()})},"thinking")})]}),c&&(0,e.jsx)(Zn.Z,{className:"message-avatar",icon:(0,e.jsx)(dt.Z,{}),style:{backgroundColor:"#1890ff"}})]})})}),Vt=Jt,$t=n(81778),Ht=ve.Z.Header,Yt=ve.Z.Content,Gt=fe.Z.Title,Ve=fe.Z.Text,Qt=Y.Z.TextArea,Xt=[{key:"deepseek-chat",name:"DeepSeek V3",provider:"DeepSeek",icon:"\u{1F50D}",modelType:"deepseek-chat",apiEndpoint:"https://api.deepseek.com",openaiCompatible:!0},{key:"deepseek-reasoner",name:"DeepSeek R1",provider:"DeepSeek",icon:"\u{1F4AC}",modelType:"deepseek-reasoner",apiEndpoint:"https://api.deepseek.com",openaiCompatible:!0},{key:"deepseek-ai/DeepSeek-V3",name:"\u7845\u57FA\u6D41\u52A8 DeepSeek V3",provider:"Siliconflow",icon:"\u{1F441}\uFE0F",modelType:"deepseek-ai/DeepSeek-V3",apiEndpoint:"https://api.siliconflow.cn",openaiCompatible:!0},{key:"deepseek-ai/DeepSeek-R1",name:"\u7845\u57FA\u6D41\u52A8 DeepSeek R1",provider:"Siliconflow",icon:"\u2728",modelType:"deepseek-ai/DeepSeek-R1",apiEndpoint:"https://api.siliconflow.cn",openaiCompatible:!0},{key:"qwen-turbo",name:"\u901A\u4E49\u5343\u95EETurbo",provider:"Alibaba",icon:"\u26A1",modelType:"qwen-turbo",openaiCompatible:!0,apiEndpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/"},{key:"qwen-plus",name:"\u901A\u4E49\u5343\u95EEPlus",provider:"Alibaba",icon:"\u2795",modelType:"qwen-plus",openaiCompatible:!0,apiEndpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/"},{key:"qwen-max",name:"\u901A\u4E49\u5343\u95EEMax",provider:"Alibaba",icon:"\u{1F50D}",modelType:"qwen-max",openaiCompatible:!0,apiEndpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/"}],qt=function(){var o=(0,r.useState)([]),x=g()(o,2),b=x[0],T=x[1],c=(0,r.useState)(""),de=g()(c,2),N=de[0],Q=de[1],Fe=(0,r.useState)(!1),H=g()(Fe,2),C=H[0],k=H[1],X=(0,r.useState)("deepseek-chat"),j=g()(X,2),D=j[0],V=j[1],q=(0,r.useState)(Xt),De=g()(q,2),ee=De[0],ie=De[1],en=(0,r.useState)(!1),nn=g()(en,2),tn=nn[0],Se=nn[1],an=(0,r.useState)([]),sn=g()(an,2),R=sn[0],ge=sn[1],ce=(0,r.useState)(null),rn=g()(ce,2),_=rn[0],v=rn[1],L=(0,r.useRef)(null),je=(0,r.useRef)(null),Te=(0,r.useRef)(null),K=(0,r.useRef)(null),ye=function(){var i;(i=je.current)===null||i===void 0||i.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(function(){ye()},[b]),(0,r.useEffect)(function(){var u=localStorage.getItem("ai-agent-conversations");if(u)try{var i=JSON.parse(u);ge(i);var d=localStorage.getItem("ai-agent-current-conversation");if(d){v(d);var h=i.find(function(ne){return ne.id===d});h&&(T(h.messages),V(h.model))}}catch(ne){console.error("Failed to parse saved conversations",ne)}var le=localStorage.getItem("ai-agent-models");if(le)try{ie(JSON.parse(le))}catch(ne){console.error("Failed to parse saved models",ne)}if(!_){var Ce=localStorage.getItem("ai-agent-current-model");Ce&&V(Ce)}},[]),(0,r.useEffect)(function(){if(_&&b.length>0){var u=R.map(function(i){return i.id===_?B()(B()({},i),{},{messages:b,model:D,updatedAt:Date.now()}):i});ge(u),localStorage.setItem("ai-agent-conversations",JSON.stringify(u))}},[b,D,_]),(0,r.useEffect)(function(){localStorage.setItem("ai-agent-conversations",JSON.stringify(R))},[R]),(0,r.useEffect)(function(){_&&localStorage.setItem("ai-agent-current-conversation",_)},[_]),(0,r.useEffect)(function(){localStorage.setItem("ai-agent-models",JSON.stringify(ee))},[ee]),(0,r.useEffect)(function(){localStorage.setItem("ai-agent-current-model",D)},[D]);var ln=function(){var i=Date.now().toString(),d={id:i,title:"\u65B0\u5BF9\u8BDD ".concat(R.length+1),messages:[],model:D,createdAt:Date.now(),updatedAt:Date.now()};ge([].concat(z()(R),[d])),v(i),T([])},$e=function(i){var d=R.find(function(h){return h.id===i});d&&(v(i),T(d.messages),V(d.model))},yn=function(){var u=me()(U()().mark(function i(){var d,h,le,Ce,ne,Ee,Ne;return U()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(!N.trim()||C)){S.next=2;break}return S.abrupt("return");case 2:if(d=ee.find(function(W){return W.key===D}),d){S.next=6;break}return Z.ZP.error("\u6240\u9009\u6A21\u578B\u4E0D\u5B58\u5728"),S.abrupt("return");case 6:if(d.accessKey){S.next=10;break}return Z.ZP.error("\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u914D\u7F6EAPI\u5BC6\u94A5"),Se(!0),S.abrupt("return");case 10:return(!_||R.length===0)&&ln(),h={id:Date.now().toString(),role:"user",content:N,timestamp:Date.now()},le={id:(Date.now()+1).toString(),role:"assistant",content:"",timestamp:Date.now()+1,model:D},Ce=[].concat(z()(b),[h,le]),T(Ce),Q(""),k(!0),b.length===0&&(ne=N.length>20?"".concat(N.substring(0,20),"..."):N,Ee=R.map(function(W){return W.id===_?B()(B()({},W),{},{title:ne,messages:Ce}):W}),ge(Ee)),Ne=new $t.Z(d,b),L.current=Ne,S.prev=20,S.next=23,Ne.sendMessage(N,!1,{onMessage:function(oe){T(function($){var P=z()($),E=P[P.length-1];return E&&E.role==="assistant"&&(E.content+=oe),P}),setTimeout(function(){je.current&&je.current.scrollIntoView({behavior:"smooth"})},0)},onReasoningProcess:function(oe){T(function($){var P=z()($),E=P[P.length-1];return E&&E.role==="assistant"&&(E.thinking=(E.thinking||"")+oe,E.reasoning_process=(E.reasoning_process||"")+oe,P[P.length-1]=B()({},E)),z()(P)}),setTimeout(function(){je.current&&je.current.scrollIntoView({behavior:"smooth"})},0)},onError:function(oe){T(function($){var P=z()($),E=P[P.length-1];return E&&E.role==="assistant"&&(E.content||(E.content="[\u9519\u8BEF] \u8BF7\u6C42\u5931\u8D25\uFF1A".concat(oe),E.error=!0,E.errorMessage=String(oe))),P}),k(!1)},onComplete:function(){k(!1),L.current=null,Te.current&&Te.current.focus()}});case 23:S.next=31;break;case 25:S.prev=25,S.t0=S.catch(20),console.error("\u53D1\u9001\u6D88\u606F\u5931\u8D25",S.t0),Z.ZP.error("\u53D1\u9001\u6D88\u606F\u5931\u8D25: ".concat(S.t0.message)),k(!1),L.current=null;case 31:case"end":return S.stop()}},i,null,[[20,25]])}));return function(){return u.apply(this,arguments)}}(),xn=function(){L.current&&(L.current.cancel(),L.current=null,k(!1),Z.ZP.info("\u5DF2\u53D6\u6D88\u8BF7\u6C42"))},Cn=function(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),yn())},on=function(){if(_){var i=R.map(function(d){return d.id===_?B()(B()({},d),{},{messages:[]}):d});ge(i)}T([])},un=function(i){var d=R.filter(function(h){return h.id!==i});ge(d),i===_&&(d.length>0?$e(d[0].id):(v(null),T([])))},dn=function(i){ie(function(d){return[].concat(z()(d),[i])}),Z.ZP.success("\u6210\u529F\u6DFB\u52A0\u6A21\u578B: ".concat(i.name))},En=function(i){ie(function(d){return d.map(function(h){return h.key===i.key?i:h})}),Z.ZP.success("\u6210\u529F\u66F4\u65B0\u6A21\u578B: ".concat(i.name))},cn=function(i){if(ie(function(h){return h.filter(function(le){return le.key!==i})}),i===D&&ee.length>1){var d=ee.find(function(h){return h.key!==i});d&&V(d.key)}Z.ZP.success("\u5DF2\u5220\u9664\u6A21\u578B")},xe=(0,e.jsx)(Ke.Z,{children:R.length===0?(0,e.jsx)(Ke.Z.Item,{disabled:!0,children:"\u6682\u65E0\u5BF9\u8BDD\u5386\u53F2"},"empty"):R.sort(function(u,i){return i.createdAt-u.createdAt}).map(function(u){return(0,e.jsx)(Ke.Z.Item,{onClick:function(){return $e(u.id)},style:{padding:"10px 16px"},children:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,e.jsxs)("div",{style:{flex:1,overflow:"hidden",marginRight:"8px"},children:[(0,e.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:u.title}),(0,e.jsxs)("div",{style:{fontSize:"11px",color:"rgba(0, 0, 0, 0.45)",marginTop:"4px"},children:["\u521B\u5EFA\u4E8E: ",Pn()(u.createdAt).format("YYYY-MM-DD HH:mm")]})]}),(0,e.jsx)(p.ZP,{type:"text",danger:!0,size:"small",icon:(0,e.jsx)(G.Z,{}),style:{flexShrink:0,lineHeight:1},onClick:function(d){d.stopPropagation(),un(u.id)}})]})},u.id)})});return(0,e.jsxs)(ve.Z,{className:"ai-agent-container",children:[(0,e.jsxs)(Ht,{className:"ai-agent-header",children:[(0,e.jsxs)("div",{className:"header-left",children:[(0,e.jsx)(Ie.Z,{className:"header-icon"}),(0,e.jsx)(Gt,{level:4,className:"header-title",children:"AI\u667A\u80FD\u4F53"})]}),(0,e.jsx)("div",{className:"header-right",children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(p.ZP,{type:"primary",icon:(0,e.jsx)(ze.Z,{}),onClick:ln,children:"\u65B0\u5EFA\u5BF9\u8BDD"}),(0,e.jsx)(Ue.Z,{overlay:xe,placement:"bottomRight",trigger:["click"],children:(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(Qe.Z,{}),type:"text",children:"\u5BF9\u8BDD\u5386\u53F2"})}),(0,e.jsx)(ae.Z,{value:D,onChange:V,style:{width:180},dropdownMatchSelectWidth:!1,disabled:C,optionLabelProp:"label",optionFilterProp:"label",showSearch:!0,options:ee.map(function(u){return{value:u.key,label:"".concat(u.icon," ").concat(u.name),children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{children:u.icon}),(0,e.jsx)("span",{children:u.name}),(0,e.jsxs)(Ve,{type:"secondary",style:{fontSize:"12px"},children:["(",u.provider,")"]})]})}})}),(0,e.jsx)(Ye.Z,{title:"\u6A21\u578B\u8BBE\u7F6E",children:(0,e.jsx)(p.ZP,{icon:(0,e.jsx)(Pe.Z,{}),onClick:function(){return Se(!0)},type:"text",disabled:C})})]})})]}),(0,e.jsxs)(Yt,{className:"ai-agent-content",children:[(0,e.jsxs)("div",{className:"messages-container",ref:K,children:[b.length===0?(0,e.jsxs)("div",{className:"empty-state",children:[(0,e.jsx)(Ie.Z,{className:"empty-icon"}),(0,e.jsx)(Ve,{className:"empty-title",children:"\u5F00\u59CB\u4E0EAI\u667A\u80FD\u4F53\u5BF9\u8BDD"}),(0,e.jsx)(Ve,{className:"empty-subtitle",children:"\u60A8\u53EF\u4EE5\u8BE2\u95EE\u4EFB\u4F55\u95EE\u9898\uFF0CAI\u5C06\u4F1A\u5C3D\u529B\u56DE\u7B54"}),(0,e.jsx)(Ve,{className:"empty-notice",type:"secondary",style:{marginTop:"10px"},children:"\u672CAI\u667A\u80FD\u4F53\u57FA\u4E8EOpenAI\u5E93\u5B9E\u73B0\uFF0C\u652F\u6301\u5404\u79CD\u5927\u8BED\u8A00\u6A21\u578B\uFF0C\u63D0\u4F9B\u6D41\u7545\u7A33\u5B9A\u7684\u4F53\u9A8C"})]}):(0,e.jsxs)("div",{className:"messages-wrapper",children:[(0,e.jsx)("div",{className:"messages-header",children:(0,e.jsx)(p.ZP,{type:"text",danger:!0,icon:(0,e.jsx)(G.Z,{}),onClick:on,disabled:C||b.length===0,children:"\u6E05\u7A7A\u5BF9\u8BDD"})}),b.map(function(u,i){return(0,e.jsx)(Vt,{message:u,models:ee},"".concat(u.id,"-").concat(i,"-").concat(u.content.length))})]}),(0,e.jsx)("div",{ref:je})]}),(0,e.jsx)("div",{className:"input-container",children:(0,e.jsxs)(Ge.Z,{className:"input-card",children:[(0,e.jsx)("div",{className:"input-options",children:C&&(0,e.jsx)(p.ZP,{danger:!0,type:"primary",icon:(0,e.jsx)(he,{}),onClick:xn,children:"\u505C\u6B62\u751F\u6210"})}),(0,e.jsxs)("div",{className:"textarea-container",children:[(0,e.jsx)(Qt,{ref:Te,value:N,onChange:function(i){return Q(i.target.value)},onKeyDown:Cn,placeholder:"\u8F93\u5165\u60A8\u7684\u95EE\u9898\uFF0C\u6309\u56DE\u8F66\u53D1\u9001\uFF0CShift+\u56DE\u8F66\u6362\u884C...",autoSize:{minRows:1,maxRows:6},disabled:C}),(0,e.jsx)(p.ZP,{type:"primary",icon:C?(0,e.jsx)(Ae.Z,{}):(0,e.jsx)(We.Z,{}),onClick:yn,disabled:!N.trim()||C,className:"send-button",style:{flexShrink:0,borderRadius:"50%",width:"40px",height:"40px",minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center",padding:0}})]}),(0,e.jsx)(Ve,{type:"secondary",className:"input-hint",children:"\u63D0\u793A: \u4F7F\u7528 \u56DE\u8F66\u952E \u5FEB\u6377\u53D1\u9001\u6D88\u606F\uFF0CShift+\u56DE\u8F66 \u6362\u884C"})]})})]}),(0,e.jsx)(qn,{visible:tn,onClose:function(){return Se(!1)},models:ee,onAddModel:dn,onUpdateModel:En,onDeleteModel:cn})]})},ea=qt},81778:function(Bn,Ze,n){var be=n(57566),U=n.n(be),Re=n(64581),me=n.n(Re),_e=n(52487),z=n.n(_e),He=n(84169),B=n.n(He),Le=n(29957),g=n.n(Le),r=n(75204),ve=n.n(r),fe=n(75600),Y=n.n(fe),Z=n(52138),Ke=function(){function p(M){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];B()(this,p),ve()(this,"modelConfig",void 0),ve()(this,"messages",void 0),ve()(this,"client",null),ve()(this,"abortController",null),this.modelConfig=M,this.messages=Ue,this.initClient()}return g()(p,[{key:"initClient",value:function(){this.modelConfig.accessKey&&(this.client=new Z.ZP({apiKey:this.modelConfig.accessKey,baseURL:this.modelConfig.apiEndpoint,dangerouslyAllowBrowser:!0}))}},{key:"sendMessage",value:function(){var M=z()(U()().mark(function ae(Ye,Ge,G){var Ie,ze,Qe,Pe,O,Xe,Me,ue,we,pe,he,Ae,We,se;return U()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.abortController&&this.abortController.abort(),this.abortController=new AbortController,l.prev=2,this.client){l.next=7;break}if(this.initClient(),this.client){l.next=7;break}throw new Error("OpenAI\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5API\u5BC6\u94A5");case 7:return Ie=this.messages.filter(function(F){return F.role==="user"||F.role==="assistant"||F.role==="system"}).map(function(F){return{role:F.role,content:F.content}}),ze=this.modelConfig.modelType||this.modelConfig.key,l.next=11,this.client.chat.completions.create({model:ze,messages:[].concat(me()(Ie),[{role:"user",content:Ye}]),stream:!0,temperature:.7,tools:Ge?[{type:"function",function:{name:"search",description:"Search the web for information",parameters:{type:"object",properties:{query:{type:"string",description:"The search query"}},required:["query"]}}}]:void 0},{signal:this.abortController.signal});case 11:Qe=l.sent,Pe=!1,O=!1,l.prev=14,Me=Y()(Qe);case 16:return l.next=18,Me.next();case 18:if(!(Pe=!(ue=l.sent).done)){l.next=33;break}if(we=ue.value,Ae=((pe=we.choices[0])===null||pe===void 0||(pe=pe.delta)===null||pe===void 0?void 0:pe.content)||"",We=((he=we.choices[0])===null||he===void 0||(he=he.delta)===null||he===void 0?void 0:he.reasoning_content)||"",!Ae){l.next=26;break}return G.onMessage(Ae),l.next=26,new Promise(function(F){return setTimeout(F,5)});case 26:if(!(We&&G.onReasoningProcess)){l.next=30;break}return G.onReasoningProcess(We),l.next=30,new Promise(function(F){return setTimeout(F,5)});case 30:Pe=!1,l.next=16;break;case 33:l.next=39;break;case 35:l.prev=35,l.t0=l.catch(14),O=!0,Xe=l.t0;case 39:if(l.prev=39,l.prev=40,!(Pe&&Me.return!=null)){l.next=44;break}return l.next=44,Me.return();case 44:if(l.prev=44,!O){l.next=47;break}throw Xe;case 47:return l.finish(44);case 48:return l.finish(39);case 49:G.onComplete(),l.next=55;break;case 52:if(l.prev=52,l.t1=l.catch(2),l.t1.name!=="AbortError"){console.error("AI\u8BF7\u6C42\u9519\u8BEF:",l.t1),se="";try{l.t1.response&&l.t1.response.data?se=JSON.stringify(l.t1.response.data,null,2):l.t1.message?se=l.t1.message:typeof l.t1=="string"?se=l.t1:se=JSON.stringify(l.t1,null,2)}catch(F){se="\u672A\u80FD\u89E3\u6790\u9519\u8BEF\u8BE6\u60C5"}G.onError(se||"\u8BF7\u6C42\u5931\u8D25")}case 55:return l.prev=55,this.abortController=null,l.finish(55);case 58:case"end":return l.stop()}},ae,this,[[2,52,55,58],[14,35,39,49],[40,,44,48]])}));function Ue(ae,Ye,Ge){return M.apply(this,arguments)}return Ue}()},{key:"cancel",value:function(){this.abortController&&(this.abortController.abort(),this.abortController=null)}}]),p}();Ze.Z=Ke},79090:function(Bn,Ze,n){var be=n(1413),U=n(67294),Re=n(15294),me=n(91146),_e=function(B,Le){return U.createElement(me.Z,(0,be.Z)((0,be.Z)({},B),{},{ref:Le,icon:Re.Z}))},z=U.forwardRef(_e);Ze.Z=z}}]);
