"use strict";(self.webpackChunkreact_frontend_init=self.webpackChunkreact_frontend_init||[]).push([[6482],{79090:function(Bn,Se,n){var be=n(1413),z=n(67294),Ne=n(15294),me=n(91146),Le=function(B,Ke){return z.createElement(me.Z,(0,be.Z)((0,be.Z)({},B),{},{ref:Ke,icon:Ne.Z}))},w=z.forwardRef(Le);Se.Z=w},70498:function(Bn,Se,n){n.r(Se),n.d(Se,{default:function(){return ea}});var be=n(95688),z=n.n(be),Ne=n(76069),me=n.n(Ne),Le=n(63894),w=n.n(Le),Je=n(79810),B=n.n(Je),Ke=n(52419),g=n.n(Ke),s=n(67294),fe=n(26058),he=n(71471),Y=n(55102),S=n(68872),Ue=n(50136),v=n(83622),M=n(78957),ze=n(85418),ae=n(34041),Ye=n(83062),Ge=n(4393),G=n(82061),Pe=n(50228),we=n(51042),Qe=n(13923),Ie=n(31776),T=n(1413),Xe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},Me=Xe,oe=n(91146),We=function(u,j){return s.createElement(oe.Z,(0,T.Z)((0,T.Z)({},u),{},{ref:j,icon:Me}))},ve=s.forwardRef(We),pe=ve,Ae=n(79090),Ve=n(27496),re=n(11941),x=n(47019),l=n(17788),F=n(2487),mn=n(32983),fn=n(86738),hn=n(96074),vn=n(47389),Nn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M917.7 148.8l-42.4-42.4c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-76.1 76.1a199.27 199.27 0 00-112.1-34.3c-51.2 0-102.4 19.5-141.5 58.6L432.3 308.7a8.03 8.03 0 000 11.3L704 591.7c1.6 1.6 3.6 2.3 5.7 2.3 2 0 4.1-.8 5.7-2.3l101.9-101.9c68.9-69 77-175.7 24.3-253.5l76.1-76.1c3.1-3.2 3.1-8.3 0-11.4zM769.1 441.7l-59.4 59.4-186.8-186.8 59.4-59.4c24.9-24.9 58.1-38.7 93.4-38.7 35.3 0 68.4 13.7 93.4 38.7 24.9 24.9 38.7 58.1 38.7 93.4 0 35.3-13.8 68.4-38.7 93.4zm-190.2 105a8.03 8.03 0 00-11.3 0L501 613.3 410.7 523l66.7-66.7c3.1-3.1 3.1-8.2 0-11.3L441 408.6a8.03 8.03 0 00-11.3 0L363 475.3l-43-43a7.85 7.85 0 00-5.7-2.3c-2 0-4.1.8-5.7 2.3L206.8 534.2c-68.9 69-77 175.7-24.3 253.5l-76.1 76.1a8.03 8.03 0 000 11.3l42.4 42.4c1.6 1.6 3.6 2.3 5.7 2.3s4.1-.8 5.7-2.3l76.1-76.1c33.7 22.9 72.9 34.3 112.1 34.3 51.2 0 102.4-19.5 141.5-58.6l101.9-101.9c3.1-3.1 3.1-8.2 0-11.3l-43-43 66.7-66.7c3.1-3.1 3.1-8.2 0-11.3l-36.6-36.2zM441.7 769.1a131.32 131.32 0 01-93.4 38.7c-35.3 0-68.4-13.7-93.4-38.7a131.32 131.32 0 01-38.7-93.4c0-35.3 13.7-68.4 38.7-93.4l59.4-59.4 186.8 186.8-59.4 59.4z"}}]},name:"api",theme:"outlined"},Ln=Nn,Kn=function(u,j){return s.createElement(oe.Z,(0,T.Z)((0,T.Z)({},u),{},{ref:j,icon:Ln}))},Un=s.forwardRef(Kn),Fn=Un,zn=n(29158),wn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M938 458.8l-29.6-312.6c-1.5-16.2-14.4-29-30.6-30.6L565.2 86h-.4c-3.2 0-5.7 1-7.6 2.9L88.9 557.2a9.96 9.96 0 000 14.1l363.8 363.8c1.9 1.9 4.4 2.9 7.1 2.9s5.2-1 7.1-2.9l468.3-468.3c2-2.1 3-5 2.8-8zM459.7 834.7L189.3 564.3 589 164.6 836 188l23.4 247-399.7 399.7zM680 256c-48.5 0-88 39.5-88 88s39.5 88 88 88 88-39.5 88-88-39.5-88-88-88zm0 120c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"}}]},name:"tag",theme:"outlined"},Wn=wn,Vn=function(u,j){return s.createElement(oe.Z,(0,T.Z)((0,T.Z)({},u),{},{ref:j,icon:Wn}))},$n=s.forwardRef(Vn),_n=$n,Hn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 112c-167.9 0-304 136.1-304 304 0 70.3 23.9 135 63.9 186.5l-41.1 41.1-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-44.9 44.9-62.3-62.3a8.15 8.15 0 00-11.4 0l-39.8 39.8a8.15 8.15 0 000 11.4l62.3 62.3-65.3 65.3a8.03 8.03 0 000 11.3l42.3 42.3c3.1 3.1 8.2 3.1 11.3 0l253.6-253.6A304.06 304.06 0 00608 720c167.9 0 304-136.1 304-304S775.9 112 608 112zm161.2 465.2C726.2 620.3 668.9 644 608 644c-60.9 0-118.2-23.7-161.2-66.8-43.1-43-66.8-100.3-66.8-161.2 0-60.9 23.7-118.2 66.8-161.2 43-43.1 100.3-66.8 161.2-66.8 60.9 0 118.2 23.7 161.2 66.8 43.1 43 66.8 100.3 66.8 161.2 0 60.9-23.7 118.2-66.8 161.2z"}}]},name:"key",theme:"outlined"},Jn=Hn,Yn=function(u,j){return s.createElement(oe.Z,(0,T.Z)((0,T.Z)({},u),{},{ref:j,icon:Jn}))},Gn=s.forwardRef(Yn),Qn=Gn,e=n(85893),$e=ae.Z.Option,qe=re.Z.TabPane,Be=he.Z.Text,ha=he.Z.Title,Dn=["\u{1F916}","\u{1F9E0}","\u{1F52E}","\u{1F4DD}","\u{1F48E}","\u{1F468}\u200D\u{1F4BB}","\u{1F50D}","\u2728","\u{1F9E9}","\u{1F308}","\u{1F680}","\u{1F52C}","\u{1F310}","\u{1F3AF}","\u{1F9BE}","\u{1F506}","\u26A1","\u{1F31F}"],pn=[{key:"DeepSeek",name:"DeepSeek",icon:"\u{1F468}\u200D\u{1F4BB}",endpoint:"https://api.deepseek.com",models:[{value:"deepseek-chat",label:"DeepSeek V3"},{value:"deepseek-reasoner",label:"DeepSeek R1"}],apiKeyUrl:"https://platform.deepseek.com/api_keys"},{key:"Siliconflow",name:"\u7845\u57FA\u6D41\u52A8",icon:"\u{1F916}",endpoint:"https://api.siliconflow.cn",models:[{value:"deepseek-ai/DeepSeek-V3",label:"DeepSeek V3"},{value:"deepseek-ai/DeepSeek-R1",label:"DeepSeek R1"}],apiKeyUrl:"https://cloud.siliconflow.cn/account/ak"},{key:"Alibaba",name:"\u963F\u91CC\u5DF4\u5DF4",icon:"\u{1F50D}",endpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/",models:[{value:"qwen-turbo",label:"\u901A\u4E49\u5343\u95EETurbo"},{value:"qwen-max",label:"\u901A\u4E49\u5343\u95EEMax"},{value:"qwen-plus",label:"\u901A\u4E49\u5343\u95EEPlus"}],apiKeyUrl:"https://bailian.console.aliyun.com/?tab=model#/api-key"}],Oe="ai-agent-providers",Xn=function(u){var j,b=u.visible,k=u.onClose,c=u.models,de=u.onAddModel,R=u.onUpdateModel,Q=u.onDeleteModel,Fe=x.Z.useForm(),J=g()(Fe,1),C=J[0],O=x.Z.useForm(),X=g()(O,1),y=X[0],D=x.Z.useForm(),_=g()(D,1),q=_[0],De=(0,s.useState)(!1),ee=g()(De,2),ie=ee[0],en=ee[1],nn=(0,s.useState)(null),tn=g()(nn,2),Ze=tn[0],an=tn[1],rn=(0,s.useState)("manage"),N=g()(rn,2),ge=N[0],ce=N[1],sn=(0,s.useState)([]),L=g()(sn,2),f=L[0],K=L[1],ye=(0,s.useState)(""),ke=g()(ye,2),U=ke[0],xe=ke[1],ln=(0,s.useState)([]),He=g()(ln,2),xn=He[0],jn=He[1],Cn=(0,s.useState)([]),un=g()(Cn,2),on=un[0],dn=un[1],En=(0,s.useState)(!1),cn=g()(En,2),je=cn[0],o=cn[1],i=(0,s.useState)(null),d=g()(i,2),p=d[0],le=d[1],Ce=(0,s.useState)(!1),ne=g()(Ce,2),Ee=ne[0],Re=ne[1],kn=(0,s.useState)(null),Z=g()(kn,2),V=Z[0],ue=Z[1];(0,s.useEffect)(function(){var a=localStorage.getItem(Oe);if(a)try{var t=JSON.parse(a);K(t)}catch(r){console.error("Failed to parse saved providers",r),K(pn)}else K(pn),localStorage.setItem(Oe,JSON.stringify(pn))},[]),(0,s.useEffect)(function(){b&&ce("manage")},[b]),(0,s.useEffect)(function(){var a=f.map(function(t){return{value:t.key,label:"".concat(t.icon," ").concat(t.name)}});jn(a),!U&&f.length>0&&(xe(f[0].key),H(f[0].key))},[f]);var H=function(t){var r=f.find(function(m){return m.key===t});dn(r?r.models:[])},I=function(){C.resetFields(),en(!1),an(null),f.length>0&&(xe(f[0].key),H(f[0].key))},E=function(){y.resetFields(),o(!1),le(null)},An=function(){q.resetFields(),Re(!1),ue(null)},na=function(){var a=me()(z()().mark(function t(){var r,m;return z()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,h.next=3,C.validateFields();case 3:r=h.sent,m={key:ie&&Ze?Ze:"model-".concat(Date.now()),name:r.name,provider:r.provider,icon:r.icon,accessKey:r.accessKey,apiEndpoint:r.apiEndpoint,modelType:r.modelType},ie&&Ze?R(m):de(m),I(),ce("manage"),h.next=13;break;case 10:h.prev=10,h.t0=h.catch(0),console.error("Form validation failed:",h.t0);case 13:case"end":return h.stop()}},t,null,[[0,10]])}));return function(){return a.apply(this,arguments)}}(),ta=function(){var a=me()(z()().mark(function t(){var r,m,P;return z()().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.prev=0,$.next=3,y.validateFields();case 3:m=$.sent,P={key:je&&p?p:"provider-".concat(Date.now()),name:m.name,icon:m.icon,endpoint:m.endpoint,apiKeyUrl:m.apiKeyUrl,models:je&&p?((r=f.find(function(A){return A.key===p}))===null||r===void 0?void 0:r.models)||[]:[]},K(je&&p?function(A){return A.map(function(te){return te.key===p?P:te})}:function(A){return[].concat(w()(A),[P])}),localStorage.setItem(Oe,JSON.stringify(je&&p?f.map(function(A){return A.key===p?P:A}):[].concat(w()(f),[P]))),E(),S.ZP.success("\u6210\u529F".concat(je?"\u66F4\u65B0":"\u6DFB\u52A0","\u63D0\u4F9B\u5546: ").concat(m.name)),$.next=14;break;case 11:$.prev=11,$.t0=$.catch(0),console.error("Provider form validation failed:",$.t0);case 14:case"end":return $.stop()}},t,null,[[0,11]])}));return function(){return a.apply(this,arguments)}}(),aa=function(){var a=me()(z()().mark(function t(){var r,m,P,h;return z()().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.prev=0,A.next=3,q.validateFields();case 3:if(r=A.sent,m=f.find(function(te){return te.key===U}),m){A.next=8;break}return S.ZP.error("\u8BF7\u5148\u9009\u62E9\u63D0\u4F9B\u5546"),A.abrupt("return");case 8:P={value:Ee&&V?V:r.value,label:r.label},h=f.map(function(te){return te.key===U?Ee&&V?B()(B()({},te),{},{models:te.models.map(function(Rn){return Rn.value===V?P:Rn})}):B()(B()({},te),{},{models:[].concat(w()(te.models),[P])}):te}),K(h),localStorage.setItem(Oe,JSON.stringify(h)),An(),H(U),S.ZP.success("\u6210\u529F".concat(Ee?"\u66F4\u65B0":"\u6DFB\u52A0","\u6A21\u578B\u7C7B\u578B: ").concat(r.label)),A.next=20;break;case 17:A.prev=17,A.t0=A.catch(0),console.error("Model type form validation failed:",A.t0);case 20:case"end":return A.stop()}},t,null,[[0,17]])}));return function(){return a.apply(this,arguments)}}(),ra=function(t){var r=c.some(function(P){return P.provider===t});if(r){S.ZP.error("\u8BE5\u63D0\u4F9B\u5546\u5DF2\u88AB\u6A21\u578B\u4F7F\u7528\uFF0C\u65E0\u6CD5\u5220\u9664");return}var m=f.filter(function(P){return P.key!==t});K(m),localStorage.setItem(Oe,JSON.stringify(m)),S.ZP.success("\u5DF2\u5220\u9664\u63D0\u4F9B\u5546"),t===U&&m.length>0&&(xe(m[0].key),H(m[0].key))},sa=function(t){o(!0),le(t.key),y.setFieldsValue({name:t.name,icon:t.icon,endpoint:t.endpoint,apiKeyUrl:t.apiKeyUrl||""})},ia=function(t){var r=c.some(function(h){return h.modelType===t});if(r){S.ZP.error("\u8BE5\u6A21\u578B\u7C7B\u578B\u5DF2\u88AB\u4F7F\u7528\uFF0C\u65E0\u6CD5\u5220\u9664");return}var m=f.find(function(h){return h.key===U});if(m){var P=f.map(function(h){return h.key===U?B()(B()({},h),{},{models:h.models.filter(function($){return $.value!==t})}):h});K(P),localStorage.setItem(Oe,JSON.stringify(P)),S.ZP.success("\u5DF2\u5220\u9664\u6A21\u578B\u7C7B\u578B"),H(U)}},la=function(t){Re(!0),ue(t.value),q.setFieldsValue({value:t.value,label:t.label})},ua=function(t){console.log(t),en(!0),an(t.key),ce("add"),xe(t.provider),H(t.provider),C.setFieldsValue({name:t.name,provider:t.provider,icon:t.icon,accessKey:t.accessKey||"",apiEndpoint:t.apiEndpoint||"",modelType:t.modelType||""})},oa=function(t){Q(t)},da=function(t){ce(t),t==="add"&&I()},ca=function(t){xe(t),H(t);var r=f.find(function(m){return m.key===t});r&&C.setFieldsValue({apiEndpoint:r.endpoint,modelType:void 0})},ma=function(t){if(t){var r=on.find(function(h){return h.value===t});if(r&&!ie){var m=f.find(function(h){return h.key===U}),P=m?"(".concat(m.name,")"):"";C.setFieldsValue({name:"".concat(r.label).concat(P)})}}},fa=function(t){var r=f.find(function(m){return m.key===t});r&&r.apiKeyUrl?window.open(r.apiKeyUrl,"_blank"):S.ZP.info("\u8BE5\u63D0\u4F9B\u5546\u672A\u63D0\u4F9BAPI\u5BC6\u94A5\u83B7\u53D6\u5730\u5740")};return(0,e.jsx)(l.Z,{title:"AI\u6A21\u578B\u8BBE\u7F6E",open:b,onCancel:function(){I(),E(),An(),ce("manage"),k()},footer:null,width:700,children:(0,e.jsxs)(re.Z,{activeKey:ge,onChange:da,children:[(0,e.jsxs)(qe,{tab:"\u7BA1\u7406\u6A21\u578B",children:[(0,e.jsx)("div",{style:{minHeight:300,maxHeight:500,overflow:"auto"},children:(0,e.jsx)(F.Z,{itemLayout:"horizontal",dataSource:c,locale:{emptyText:(0,e.jsx)(mn.Z,{description:"\u6682\u65E0\u6A21\u578B\uFF0C\u8BF7\u70B9\u51FB'\u6DFB\u52A0\u6A21\u578B'\u6309\u94AE\u6DFB\u52A0"})},renderItem:function(t){return(0,e.jsx)(F.Z.Item,{actions:[function(){var r=f.find(function(m){return m.key===t.provider});return r!=null&&r.apiKeyUrl?(0,e.jsx)(v.ZP,{type:"link",onClick:function(){return fa(t.provider)},children:"\u83B7\u53D6\u5BC6\u94A5"},"getKey"):null}(),(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(vn.Z,{}),type:"text",onClick:function(){return ua(t)}},"edit"),(0,e.jsx)(fn.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6A21\u578B\u5417\uFF1F",onConfirm:function(){return oa(t.key)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",children:(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(G.Z,{}),type:"text",danger:!0})},"delete")],children:(0,e.jsx)(F.Z.Item.Meta,{avatar:(0,e.jsx)("div",{style:{fontSize:24},children:t.icon}),title:t.name,description:(0,e.jsxs)(M.Z,{direction:"vertical",size:0,children:[(0,e.jsxs)(Be,{type:"secondary",children:["\u63D0\u4F9B\u5546: ",t.provider]}),t.modelType&&(0,e.jsxs)(Be,{type:"secondary",children:["\u6A21\u578B\u7C7B\u578B: ",t.modelType]}),t.accessKey&&(0,e.jsx)(Be,{type:"secondary",children:"API\u5BC6\u94A5: \u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})})})}})}),(0,e.jsx)("div",{style:{marginTop:16,textAlign:"right"},children:(0,e.jsx)(v.ZP,{type:"primary",icon:(0,e.jsx)(we.Z,{}),onClick:function(){return ce("add")},children:"\u6DFB\u52A0\u6A21\u578B"})})]},"manage"),(0,e.jsxs)(qe,{tab:"\u7BA1\u7406\u63D0\u4F9B\u5546",children:[(0,e.jsx)("div",{style:{minHeight:300,maxHeight:500,overflow:"auto"},children:(0,e.jsx)(F.Z,{itemLayout:"horizontal",dataSource:f,locale:{emptyText:(0,e.jsx)(mn.Z,{description:"\u6682\u65E0\u63D0\u4F9B\u5546\uFF0C\u8BF7\u70B9\u51FB'\u6DFB\u52A0\u63D0\u4F9B\u5546'\u6309\u94AE\u6DFB\u52A0"})},renderItem:function(t){return(0,e.jsx)(F.Z.Item,{actions:[(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(vn.Z,{}),type:"text",onClick:function(){return sa(t)}},"edit"),(0,e.jsx)(fn.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u63D0\u4F9B\u5546\u5417\uFF1F",onConfirm:function(){return ra(t.key)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",disabled:c.some(function(r){return r.provider===t.key}),children:(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(G.Z,{}),type:"text",danger:!0,disabled:c.some(function(r){return r.provider===t.key})})},"delete")],children:(0,e.jsx)(F.Z.Item.Meta,{avatar:(0,e.jsx)("div",{style:{fontSize:24},children:t.icon}),title:t.name,description:(0,e.jsxs)(M.Z,{direction:"vertical",size:0,children:[(0,e.jsxs)(Be,{type:"secondary",children:["API\u7AEF\u70B9: ",t.endpoint]}),t.apiKeyUrl&&(0,e.jsxs)(Be,{type:"secondary",children:["API\u5BC6\u94A5\u83B7\u53D6: ",(0,e.jsx)("a",{href:t.apiKeyUrl,target:"_blank",rel:"noopener noreferrer",children:"\u83B7\u53D6\u5BC6\u94A5"})]}),(0,e.jsxs)(Be,{type:"secondary",children:["\u6A21\u578B\u6570\u91CF: ",t.models.length]})]})})})}})}),(0,e.jsx)(hn.Z,{orientation:"left",children:"\u6DFB\u52A0/\u7F16\u8F91\u63D0\u4F9B\u5546"}),(0,e.jsxs)(x.Z,{form:y,layout:"vertical",initialValues:{icon:"\u{1F916}"},children:[(0,e.jsx)(x.Z.Item,{name:"name",label:"\u63D0\u4F9B\u5546\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u63D0\u4F9B\u5546\u540D\u79F0"}],children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: DeekSeek"})}),(0,e.jsx)(x.Z.Item,{name:"icon",label:"\u56FE\u6807",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u56FE\u6807"}],children:(0,e.jsx)(ae.Z,{children:Dn.map(function(a){return(0,e.jsx)($e,{value:a,children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{style:{fontSize:20},children:a}),(0,e.jsx)("span",{children:a})]})},a)})})}),(0,e.jsx)(x.Z.Item,{name:"endpoint",label:"\u9ED8\u8BA4API\u7AEF\u70B9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165API\u7AEF\u70B9URL"}],tooltip:"\u6B64\u63D0\u4F9B\u5546\u7684\u9ED8\u8BA4API\u7AEF\u70B9\u5730\u5740",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Fn,{}),placeholder:"https://api.example.com"})}),(0,e.jsx)(x.Z.Item,{name:"apiKeyUrl",label:"API\u5BC6\u94A5\u83B7\u53D6\u5730\u5740",tooltip:"\u7528\u6237\u53EF\u4EE5\u4ECE\u8FD9\u4E2A\u5730\u5740\u83B7\u53D6API\u5BC6\u94A5\uFF08\u9009\u586B\uFF09",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(zn.Z,{}),placeholder:"https://example.com/get-api-key"})}),(0,e.jsx)(x.Z.Item,{children:(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(v.ZP,{onClick:E,children:"\u53D6\u6D88"}),(0,e.jsx)(v.ZP,{type:"primary",onClick:ta,children:je?"\u66F4\u65B0\u63D0\u4F9B\u5546":"\u6DFB\u52A0\u63D0\u4F9B\u5546"})]})})})]})]},"providers"),(0,e.jsxs)(qe,{tab:"\u7BA1\u7406\u6A21\u578B\u7C7B\u578B",children:[(0,e.jsx)("div",{style:{marginBottom:16},children:(0,e.jsx)(x.Z.Item,{label:"\u9009\u62E9\u63D0\u4F9B\u5546",children:(0,e.jsx)(ae.Z,{value:U,onChange:xe,style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u63D0\u4F9B\u5546",optionLabelProp:"label",children:f.map(function(a){return(0,e.jsx)($e,{value:a.key,label:"".concat(a.icon," ").concat(a.name),children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{children:a.icon}),(0,e.jsx)("span",{children:a.name})]})},a.key)})})})}),U&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{style:{minHeight:200,maxHeight:300,overflow:"auto"},children:(0,e.jsx)(F.Z,{itemLayout:"horizontal",dataSource:((j=f.find(function(a){return a.key===U}))===null||j===void 0?void 0:j.models)||[],locale:{emptyText:(0,e.jsx)(mn.Z,{description:"\u8BE5\u63D0\u4F9B\u5546\u6682\u65E0\u6A21\u578B\u7C7B\u578B\uFF0C\u8BF7\u6DFB\u52A0"})},renderItem:function(t){return(0,e.jsx)(F.Z.Item,{actions:[(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(vn.Z,{}),type:"text",onClick:function(){return la(t)}},"edit"),(0,e.jsx)(fn.Z,{title:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u6A21\u578B\u7C7B\u578B\u5417\uFF1F",onConfirm:function(){return ia(t.value)},okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",disabled:c.some(function(r){return r.modelType===t.value}),children:(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(G.Z,{}),type:"text",danger:!0,disabled:c.some(function(r){return r.modelType===t.value})})},"delete")],children:(0,e.jsx)(F.Z.Item.Meta,{avatar:(0,e.jsx)(_n,{style:{fontSize:18}}),title:t.label,description:(0,e.jsxs)(Be,{type:"secondary",children:["ID: ",t.value]})})})}})}),(0,e.jsx)(hn.Z,{orientation:"left",children:"\u6DFB\u52A0/\u7F16\u8F91\u6A21\u578B\u7C7B\u578B"}),(0,e.jsxs)(x.Z,{form:q,layout:"vertical",children:[(0,e.jsx)(x.Z.Item,{name:"value",label:"\u6A21\u578BID",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6A21\u578BID"}],tooltip:"\u6A21\u578B\u7684\u552F\u4E00\u6807\u8BC6\u7B26\uFF0C\u7528\u4E8EAPI\u8BF7\u6C42",children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: deepseek-chat",disabled:Ee})}),(0,e.jsx)(x.Z.Item,{name:"label",label:"\u663E\u793A\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u663E\u793A\u540D\u79F0"}],tooltip:"\u6A21\u578B\u7684\u53CB\u597D\u663E\u793A\u540D\u79F0",children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: DeepSeek V3"})}),(0,e.jsx)(x.Z.Item,{children:(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(v.ZP,{onClick:An,children:"\u53D6\u6D88"}),(0,e.jsx)(v.ZP,{type:"primary",onClick:aa,disabled:!U,children:Ee?"\u66F4\u65B0\u6A21\u578B\u7C7B\u578B":"\u6DFB\u52A0\u6A21\u578B\u7C7B\u578B"})]})})})]})]})]},"modelTypes"),(0,e.jsx)(qe,{tab:ie?"\u7F16\u8F91\u6A21\u578B":"\u6DFB\u52A0\u6A21\u578B",children:(0,e.jsxs)(x.Z,{form:C,layout:"vertical",initialValues:{icon:"\u{1F916}",provider:f.length>0?f[0].key:""},children:[(0,e.jsx)(x.Z.Item,{name:"provider",label:"\u63D0\u4F9B\u5546",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u63D0\u4F9B\u5546"}],children:(0,e.jsx)(ae.Z,{onChange:ca,optionLabelProp:"label",children:f.map(function(a){return(0,e.jsx)($e,{value:a.key,label:"".concat(a.icon," ").concat(a.name),children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{children:a.icon}),(0,e.jsx)("span",{children:a.name})]})},a.key)})})}),(0,e.jsx)(x.Z.Item,{name:"modelType",label:"\u6A21\u578B\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6A21\u578B\u7C7B\u578B"}],children:(0,e.jsx)(ae.Z,{onChange:ma,showSearch:!0,optionFilterProp:"label",placeholder:"\u9009\u62E9\u6A21\u578B\u7C7B\u578B",children:on.map(function(a){return(0,e.jsx)($e,{value:a.value,label:a.label,children:a.label},a.value)})})}),(0,e.jsx)(x.Z.Item,{name:"name",label:"\u663E\u793A\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6A21\u578B\u540D\u79F0"}],children:(0,e.jsx)(Y.Z,{placeholder:"\u4F8B\u5982: DeepSeek V3"})}),(0,e.jsx)(x.Z.Item,{name:"icon",label:"\u56FE\u6807",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u56FE\u6807"}],children:(0,e.jsx)(ae.Z,{children:Dn.map(function(a){return(0,e.jsx)($e,{value:a,children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{style:{fontSize:20},children:a}),(0,e.jsx)("span",{children:a})]})},a)})})}),(0,e.jsx)(hn.Z,{orientation:"left",children:"API\u914D\u7F6E"}),(0,e.jsx)(x.Z.Item,{name:"accessKey",label:"API\u5BC6\u94A5",rules:[{required:!0,message:"\u8BF7\u8F93\u5165API\u5BC6\u94A5"}],tooltip:"AI\u63D0\u4F9B\u5546\u7684API\u8BBF\u95EE\u5BC6\u94A5\uFF0C\u5C06\u5B89\u5168\u5B58\u50A8\u5728\u672C\u5730",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Qn,{}),placeholder:"\u8F93\u5165\u60A8\u7684API\u5BC6\u94A5"})}),(0,e.jsx)(x.Z.Item,{name:"apiEndpoint",label:"API\u7AEF\u70B9",rules:[{required:!0,message:"\u8BF7\u8F93\u5165API\u7AEF\u70B9URL"}],tooltip:"AI\u670D\u52A1\u63D0\u4F9B\u5546\u7684API\u7AEF\u70B9\u5730\u5740",children:(0,e.jsx)(Y.Z,{prefix:(0,e.jsx)(Fn,{}),placeholder:"https://api.example.com"})}),(0,e.jsx)(x.Z.Item,{children:(0,e.jsx)("div",{style:{display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(v.ZP,{onClick:function(){I(),ce("manage")},children:"\u53D6\u6D88"}),(0,e.jsx)(v.ZP,{type:"primary",onClick:na,children:ie?"\u66F4\u65B0":"\u6DFB\u52A0"})]})})})]})},"add")]})})},qn=Xn,Zn=n(47221),Sn=n(68997),bn=n(74330),et=n(38925),nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M632 888H392c-4.4 0-8 3.6-8 8v32c0 17.7 14.3 32 32 32h192c17.7 0 32-14.3 32-32v-32c0-4.4-3.6-8-8-8zM512 64c-181.1 0-328 146.9-328 328 0 121.4 66 227.4 164 284.1V792c0 17.7 14.3 32 32 32h264c17.7 0 32-14.3 32-32V676.1c98-56.7 164-162.7 164-284.1 0-181.1-146.9-328-328-328zm127.9 549.8L604 634.6V752H420V634.6l-35.9-20.8C305.4 568.3 256 484.5 256 392c0-141.4 114.6-256 256-256s256 114.6 256 256c0 92.5-49.4 176.3-128.1 221.8z"}}]},name:"bulb",theme:"outlined"},tt=nt,at=function(u,j){return s.createElement(oe.Z,(0,T.Z)((0,T.Z)({},u),{},{ref:j,icon:tt}))},rt=s.forwardRef(at),Pn=rt,st={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},it=st,lt=function(u,j){return s.createElement(oe.Z,(0,T.Z)((0,T.Z)({},u),{},{ref:j,icon:it}))},ut=s.forwardRef(lt),ot=ut,dt=n(87547),ct=n(13860),In=n.n(ct),mt=n(20905),ft=n.n(mt),ht=n(556),vt=n(4958),pt=n(48592),gt=n(5891),yt=n(11215),gn=n.n(yt),yn=(0,gt.Z)(gn(),{});yn.registerLanguage=function(W,u){return gn().register(u)},yn.alias=function(W,u){return gn().alias(W,u)};var se=yn,xt=n(74346),jt=n(96412),Ct=n.n(jt),Et=Ct(),At=n(36155),Bt=n.n(At),Mn=Bt(),Ft=n(4979),Dt=n.n(Ft),On=Dt(),Zt=n(6979),St=n.n(Zt),bt=St(),Pt=n(12049),It=n.n(Pt),Mt=It(),Ot=n(45950),Tt=n.n(Ot),kt=Tt(),Rt=n(15909),Nt=n.n(Rt),Lt=Nt(),Kt=n(88284),Ut=n(45098),zt=["className","children"];se.registerLanguage("jsx",Et),se.registerLanguage("javascript",Mn),se.registerLanguage("js",Mn),se.registerLanguage("typescript",On),se.registerLanguage("ts",On),se.registerLanguage("bash",bt),se.registerLanguage("css",Mt),se.registerLanguage("json",kt),se.registerLanguage("java",Lt);var wt=function(u){var j=u.content,b=(0,s.useState)(null),k=g()(b,2),c=k[0],de=k[1],R=function(J,C){navigator.clipboard.writeText(J).then(function(){de(C),S.ZP.success("\u4EE3\u7801\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"),setTimeout(function(){de(null)},2e3)},function(O){console.error("\u590D\u5236\u5931\u8D25: ",O),S.ZP.error("\u590D\u5236\u5931\u8D25")})},Q=0;return(0,e.jsx)("div",{className:"markdown-content",children:(0,e.jsx)(ht.UG,{remarkPlugins:[vt.Z],rehypePlugins:[pt.Z],components:{code:function(J){var C=J.className,O=J.children,X=ft()(J,zt),y=/language-(\w+)/.exec(C||""),D=y!==null,_=D?Q++:-1,q=Array.isArray(O)?O.join(""):String(O||"");return D?(0,e.jsxs)("div",{className:"code-block-wrapper",children:[(0,e.jsxs)("div",{className:"code-block-header",children:[(0,e.jsx)("span",{className:"code-language",children:y?y[1]:"code"}),(0,e.jsx)(v.ZP,{className:"copy-button",type:"text",size:"small",icon:c===_?(0,e.jsx)(Kt.Z,{}):(0,e.jsx)(Ut.Z,{}),onClick:function(){return R(q,_)},children:c===_?"\u5DF2\u590D\u5236":"\u590D\u5236"})]}),(0,e.jsx)(se,B()(B()({style:xt.Z,language:y?y[1]:"",PreTag:"div"},X),{},{children:q.replace(/\n$/,"")}))]}):(0,e.jsx)("code",B()(B()({className:C},X),{},{children:O}))}},children:j})})},Tn=wt,Te=he.Z.Text,Wt=he.Z.Paragraph,Vt=Zn.Z.Panel,$t=s.memo(function(W){var u=W.message,j=W.models,b=function(){if(u.model){var y=j.find(function(D){return D.key===u.model});if(y)return"".concat(y.icon," ").concat(y.name)}return null},k=function(y){return In()(y).format("YYYY-MM-DD HH:mm:ss")},c=u.role==="user",de=!c&&u.content==="",R=!!(u.thinking||u.reasoning_process),Q=function(){return u.reasoning_process||u.thinking||""},Fe=!c&&u.content===""&&R,J=!c&&u.error===!0,C=(0,e.jsx)(Ae.Z,{style:{fontSize:24,color:"#1890ff"},spin:!0}),O=function(y){var D=0,_=[/^#{1,6}\s.+$/m,/(`{1,3})[\s\S]*?\1/,/\[.+?\]\(.+?\)/,/!\[.+?\]\(.+?\)/,/^(\s*[-*+]\s+)(?!\[[x ]\]).*$/m,/^\s*\d+\.\s+.+$/m,/^\s*([-*+])\s+\[[x ]\].+$/m,/^\|.+\|.+\|$/m,/^>.+$/m,/^-{3,}$/m,/\*\*.+?\*\*/,/\*.+?\*/,/~~.+?~~/,/^```[\s\S]+?```$/m];if(_.forEach(function(De){De.test(y)&&D++}),D>=2)return!0;var q=/```[\s\S]+?```/;return!!q.test(y)};return(0,e.jsx)("div",{className:"message-item ".concat(c?"user-message":"ai-message"),children:(0,e.jsxs)("div",{className:"message-container",style:{justifyContent:c?"flex-end":"flex-start"},children:[!c&&(0,e.jsx)(Sn.Z,{className:"message-avatar",icon:(0,e.jsx)(Pe.Z,{}),style:{backgroundColor:"#52c41a"}}),(0,e.jsxs)("div",{className:"message-bubble",style:{marginLeft:c?"auto":"8px",marginRight:c?"8px":"auto",background:c?"linear-gradient(145deg, #5e9cea, #4881d6)":"#f5f5f5",color:c?"white":"rgba(0, 0, 0, 0.85)",borderRadius:c?"18px 18px 4px 18px":"18px 18px 18px 4px",maxWidth:"80%"},children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"6px"},children:[(0,e.jsxs)(Te,{strong:!0,style:{color:c?"white":"rgba(0, 0, 0, 0.85)"},children:[c?"\u7528\u6237":"\u52A9\u624B",!c&&b()&&(0,e.jsxs)(Te,{style:{marginLeft:8,fontSize:12,color:"rgba(0, 0, 0, 0.45)"},children:["(",b(),")"]})]}),(0,e.jsx)(Te,{className:"message-time",style:{color:c?"rgba(255, 255, 255, 0.85)":"rgba(0, 0, 0, 0.45)",marginLeft:"12px",fontSize:"11px"},children:k(u.timestamp)})]}),de&&!R?(0,e.jsxs)("div",{className:"thinking-animation",children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"12px 0"},children:[(0,e.jsx)(bn.Z,{indicator:C}),(0,e.jsx)(Te,{style:{marginLeft:12,color:"rgba(0, 0, 0, 0.65)"},children:"AI\u6B63\u5728\u601D\u8003\u4E2D"})]}),(0,e.jsxs)("div",{className:"typing-animation",children:[(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"}),(0,e.jsx)("span",{className:"dot"})]})]}):Fe?(0,e.jsxs)("div",{className:"thinking-process",children:[(0,e.jsxs)("div",{className:"thinking-process-header",children:[(0,e.jsx)(Pn,{className:"bulb-icon"}),(0,e.jsx)(Te,{className:"thinking-title",children:"\u601D\u8003\u8FC7\u7A0B\uFF1A"}),(0,e.jsx)(bn.Z,{indicator:(0,e.jsx)(Ae.Z,{style:{fontSize:14,marginLeft:"8px"},spin:!0})})]}),(0,e.jsx)("div",{className:"message-thinking",children:Q()})]}):J?(0,e.jsx)(et.Z,{message:"\u8BF7\u6C42\u9519\u8BEF",description:(0,e.jsxs)("div",{className:"error-message",children:[(0,e.jsxs)("div",{className:"error-title",children:[(0,e.jsx)(ot,{style:{color:"#ff4d4f",marginRight:"8px"}}),"\u670D\u52A1\u5668\u8FD4\u56DE\u9519\u8BEF:"]}),(0,e.jsx)("div",{className:"error-content",children:u.errorMessage||u.content.replace("[\u9519\u8BEF] \u8BF7\u6C42\u5931\u8D25\uFF1A","")}),(0,e.jsx)("div",{className:"error-hint",children:"\u5E38\u89C1\u9519\u8BEF\u539F\u56E0: API\u5BC6\u94A5\u4E0D\u6B63\u786E\u3001\u670D\u52A1\u5668\u8FDE\u63A5\u95EE\u9898\u3001\u6A21\u578B\u4E0D\u53EF\u7528\u6216\u8BF7\u6C42\u53C2\u6570\u9519\u8BEF"})]}),type:"error",showIcon:!1,className:"error-alert",style:{borderRadius:"8px"}}):(0,e.jsx)("div",{className:"message-content",style:{color:c?"white":"rgba(0, 0, 0, 0.85)"},children:!c&&O(u.content)?(0,e.jsx)(Tn,{content:u.content}):(0,e.jsx)(Wt,{style:{color:c?"white":"rgba(0, 0, 0, 0.85)"},children:u.content})}),u.content&&R&&!c&&(0,e.jsx)(Zn.Z,{ghost:!0,className:"thinking-collapse",expandIcon:function(y){var D=y.isActive;return(0,e.jsx)(Pn,{style:{color:D?"#faad14":"rgba(0, 0, 0, 0.45)",fontSize:16}})},children:(0,e.jsx)(Vt,{header:(0,e.jsx)(Te,{type:"secondary",children:"\u601D\u8003\u8FC7\u7A0B"}),children:(0,e.jsx)("div",{className:"message-thinking",children:O(Q())?(0,e.jsx)(Tn,{content:Q()}):Q()})},"thinking")})]}),c&&(0,e.jsx)(Sn.Z,{className:"message-avatar",icon:(0,e.jsx)(dt.Z,{}),style:{backgroundColor:"#1890ff"}})]})})}),_t=$t,Ht=n(80825),Jt=fe.Z.Header,Yt=fe.Z.Content,Gt=he.Z.Title,_e=he.Z.Text,Qt=Y.Z.TextArea,Xt=[{key:"deepseek-chat",name:"DeepSeek V3",provider:"DeepSeek",icon:"\u{1F50D}",modelType:"deepseek-chat",apiEndpoint:"https://api.deepseek.com",openaiCompatible:!0},{key:"deepseek-reasoner",name:"DeepSeek R1",provider:"DeepSeek",icon:"\u{1F4AC}",modelType:"deepseek-reasoner",apiEndpoint:"https://api.deepseek.com",openaiCompatible:!0},{key:"deepseek-ai/DeepSeek-V3",name:"\u7845\u57FA\u6D41\u52A8 DeepSeek V3",provider:"Siliconflow",icon:"\u{1F441}\uFE0F",modelType:"deepseek-ai/DeepSeek-V3",apiEndpoint:"https://api.siliconflow.cn",openaiCompatible:!0},{key:"deepseek-ai/DeepSeek-R1",name:"\u7845\u57FA\u6D41\u52A8 DeepSeek R1",provider:"Siliconflow",icon:"\u2728",modelType:"deepseek-ai/DeepSeek-R1",apiEndpoint:"https://api.siliconflow.cn",openaiCompatible:!0},{key:"qwen-turbo",name:"\u901A\u4E49\u5343\u95EETurbo",provider:"Alibaba",icon:"\u26A1",modelType:"qwen-turbo",openaiCompatible:!0,apiEndpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/"},{key:"qwen-plus",name:"\u901A\u4E49\u5343\u95EEPlus",provider:"Alibaba",icon:"\u2795",modelType:"qwen-plus",openaiCompatible:!0,apiEndpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/"},{key:"qwen-max",name:"\u901A\u4E49\u5343\u95EEMax",provider:"Alibaba",icon:"\u{1F50D}",modelType:"qwen-max",openaiCompatible:!0,apiEndpoint:"https://dashscope.aliyuncs.com/compatible-mode/v1/"}],qt=function(){var u=(0,s.useState)([]),j=g()(u,2),b=j[0],k=j[1],c=(0,s.useState)(""),de=g()(c,2),R=de[0],Q=de[1],Fe=(0,s.useState)(!1),J=g()(Fe,2),C=J[0],O=J[1],X=(0,s.useState)("deepseek-chat"),y=g()(X,2),D=y[0],_=y[1],q=(0,s.useState)(Xt),De=g()(q,2),ee=De[0],ie=De[1],en=(0,s.useState)(!1),nn=g()(en,2),tn=nn[0],Ze=nn[1],an=(0,s.useState)([]),rn=g()(an,2),N=rn[0],ge=rn[1],ce=(0,s.useState)(null),sn=g()(ce,2),L=sn[0],f=sn[1],K=(0,s.useRef)(null),ye=(0,s.useRef)(null),ke=(0,s.useRef)(null),U=(0,s.useRef)(null),xe=function(){var i;(i=ye.current)===null||i===void 0||i.scrollIntoView({behavior:"smooth"})};(0,s.useEffect)(function(){xe()},[b]),(0,s.useEffect)(function(){var o=localStorage.getItem("ai-agent-conversations");if(o)try{var i=JSON.parse(o);ge(i);var d=localStorage.getItem("ai-agent-current-conversation");if(d){f(d);var p=i.find(function(ne){return ne.id===d});p&&(k(p.messages),_(p.model))}}catch(ne){console.error("Failed to parse saved conversations",ne)}var le=localStorage.getItem("ai-agent-models");if(le)try{ie(JSON.parse(le))}catch(ne){console.error("Failed to parse saved models",ne)}if(!L){var Ce=localStorage.getItem("ai-agent-current-model");Ce&&_(Ce)}},[]),(0,s.useEffect)(function(){if(L&&b.length>0){var o=N.map(function(i){return i.id===L?B()(B()({},i),{},{messages:b,model:D,updatedAt:Date.now()}):i});ge(o),localStorage.setItem("ai-agent-conversations",JSON.stringify(o))}},[b,D,L]),(0,s.useEffect)(function(){localStorage.setItem("ai-agent-conversations",JSON.stringify(N))},[N]),(0,s.useEffect)(function(){L&&localStorage.setItem("ai-agent-current-conversation",L)},[L]),(0,s.useEffect)(function(){localStorage.setItem("ai-agent-models",JSON.stringify(ee))},[ee]),(0,s.useEffect)(function(){localStorage.setItem("ai-agent-current-model",D)},[D]);var ln=function(){var i=Date.now().toString(),d={id:i,title:"\u65B0\u5BF9\u8BDD ".concat(N.length+1),messages:[],model:D,createdAt:Date.now(),updatedAt:Date.now()};ge([].concat(w()(N),[d])),f(i),k([])},He=function(i){var d=N.find(function(p){return p.id===i});d&&(f(i),k(d.messages),_(d.model))},xn=function(){var o=me()(z()().mark(function i(){var d,p,le,Ce,ne,Ee,Re;return z()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!(!R.trim()||C)){Z.next=2;break}return Z.abrupt("return");case 2:if(d=ee.find(function(V){return V.key===D}),d){Z.next=6;break}return S.ZP.error("\u6240\u9009\u6A21\u578B\u4E0D\u5B58\u5728"),Z.abrupt("return");case 6:if(d.accessKey){Z.next=10;break}return S.ZP.error("\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u914D\u7F6EAPI\u5BC6\u94A5"),Ze(!0),Z.abrupt("return");case 10:return(!L||N.length===0)&&ln(),p={id:Date.now().toString(),role:"user",content:R,timestamp:Date.now()},le={id:(Date.now()+1).toString(),role:"assistant",content:"",timestamp:Date.now()+1,model:D},Ce=[].concat(w()(b),[p,le]),k(Ce),Q(""),O(!0),b.length===0&&(ne=R.length>20?"".concat(R.substring(0,20),"..."):R,Ee=N.map(function(V){return V.id===L?B()(B()({},V),{},{title:ne,messages:Ce}):V}),ge(Ee)),Re=new Ht.Z(d,b),K.current=Re,Z.prev=20,Z.next=23,Re.sendMessage(R,!1,{onMessage:function(ue){k(function(H){var I=w()(H),E=I[I.length-1];return E&&E.role==="assistant"&&(E.content+=ue),I}),setTimeout(function(){ye.current&&ye.current.scrollIntoView({behavior:"smooth"})},0)},onReasoningProcess:function(ue){k(function(H){var I=w()(H),E=I[I.length-1];return E&&E.role==="assistant"&&(E.thinking=(E.thinking||"")+ue,E.reasoning_process=(E.reasoning_process||"")+ue,I[I.length-1]=B()({},E)),w()(I)}),setTimeout(function(){ye.current&&ye.current.scrollIntoView({behavior:"smooth"})},0)},onError:function(ue){k(function(H){var I=w()(H),E=I[I.length-1];return E&&E.role==="assistant"&&(E.content||(E.content="[\u9519\u8BEF] \u8BF7\u6C42\u5931\u8D25\uFF1A".concat(ue),E.error=!0,E.errorMessage=String(ue))),I}),O(!1)},onComplete:function(){O(!1),K.current=null,ke.current&&ke.current.focus()}});case 23:Z.next=31;break;case 25:Z.prev=25,Z.t0=Z.catch(20),console.error("\u53D1\u9001\u6D88\u606F\u5931\u8D25",Z.t0),S.ZP.error("\u53D1\u9001\u6D88\u606F\u5931\u8D25: ".concat(Z.t0.message)),O(!1),K.current=null;case 31:case"end":return Z.stop()}},i,null,[[20,25]])}));return function(){return o.apply(this,arguments)}}(),jn=function(){K.current&&(K.current.cancel(),K.current=null,O(!1),S.ZP.info("\u5DF2\u53D6\u6D88\u8BF7\u6C42"))},Cn=function(i){i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),xn())},un=function(){if(L){var i=N.map(function(d){return d.id===L?B()(B()({},d),{},{messages:[]}):d});ge(i)}k([])},on=function(i){var d=N.filter(function(p){return p.id!==i});ge(d),i===L&&(d.length>0?He(d[0].id):(f(null),k([])))},dn=function(i){ie(function(d){return[].concat(w()(d),[i])}),S.ZP.success("\u6210\u529F\u6DFB\u52A0\u6A21\u578B: ".concat(i.name))},En=function(i){ie(function(d){return d.map(function(p){return p.key===i.key?i:p})}),S.ZP.success("\u6210\u529F\u66F4\u65B0\u6A21\u578B: ".concat(i.name))},cn=function(i){if(ie(function(p){return p.filter(function(le){return le.key!==i})}),i===D&&ee.length>1){var d=ee.find(function(p){return p.key!==i});d&&_(d.key)}S.ZP.success("\u5DF2\u5220\u9664\u6A21\u578B")},je=(0,e.jsx)(Ue.Z,{children:N.length===0?(0,e.jsx)(Ue.Z.Item,{disabled:!0,children:"\u6682\u65E0\u5BF9\u8BDD\u5386\u53F2"},"empty"):N.sort(function(o,i){return i.createdAt-o.createdAt}).map(function(o){return(0,e.jsx)(Ue.Z.Item,{onClick:function(){return He(o.id)},style:{padding:"10px 16px"},children:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,e.jsxs)("div",{style:{flex:1,overflow:"hidden",marginRight:"8px"},children:[(0,e.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:o.title}),(0,e.jsxs)("div",{style:{fontSize:"11px",color:"rgba(0, 0, 0, 0.45)",marginTop:"4px"},children:["\u521B\u5EFA\u4E8E: ",In()(o.createdAt).format("YYYY-MM-DD HH:mm")]})]}),(0,e.jsx)(v.ZP,{type:"text",danger:!0,size:"small",icon:(0,e.jsx)(G.Z,{}),style:{flexShrink:0,lineHeight:1},onClick:function(d){d.stopPropagation(),on(o.id)}})]})},o.id)})});return(0,e.jsxs)(fe.Z,{className:"ai-agent-container",children:[(0,e.jsxs)(Jt,{className:"ai-agent-header",children:[(0,e.jsxs)("div",{className:"header-left",children:[(0,e.jsx)(Pe.Z,{className:"header-icon"}),(0,e.jsx)(Gt,{level:4,className:"header-title",children:"AI\u667A\u80FD\u4F53"})]}),(0,e.jsx)("div",{className:"header-right",children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)(v.ZP,{type:"primary",icon:(0,e.jsx)(we.Z,{}),onClick:ln,children:"\u65B0\u5EFA\u5BF9\u8BDD"}),(0,e.jsx)(ze.Z,{overlay:je,placement:"bottomRight",trigger:["click"],children:(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(Qe.Z,{}),type:"text",children:"\u5BF9\u8BDD\u5386\u53F2"})}),(0,e.jsx)(ae.Z,{value:D,onChange:_,style:{width:180},dropdownMatchSelectWidth:!1,disabled:C,optionLabelProp:"label",optionFilterProp:"label",showSearch:!0,options:ee.map(function(o){return{value:o.key,label:"".concat(o.icon," ").concat(o.name),children:(0,e.jsxs)(M.Z,{children:[(0,e.jsx)("span",{children:o.icon}),(0,e.jsx)("span",{children:o.name}),(0,e.jsxs)(_e,{type:"secondary",style:{fontSize:"12px"},children:["(",o.provider,")"]})]})}})}),(0,e.jsx)(Ye.Z,{title:"\u6A21\u578B\u8BBE\u7F6E",children:(0,e.jsx)(v.ZP,{icon:(0,e.jsx)(Ie.Z,{}),onClick:function(){return Ze(!0)},type:"text",disabled:C})})]})})]}),(0,e.jsxs)(Yt,{className:"ai-agent-content",children:[(0,e.jsxs)("div",{className:"messages-container",ref:U,children:[b.length===0?(0,e.jsxs)("div",{className:"empty-state",children:[(0,e.jsx)(Pe.Z,{className:"empty-icon"}),(0,e.jsx)(_e,{className:"empty-title",children:"\u5F00\u59CB\u4E0EAI\u667A\u80FD\u4F53\u5BF9\u8BDD"}),(0,e.jsx)(_e,{className:"empty-subtitle",children:"\u60A8\u53EF\u4EE5\u8BE2\u95EE\u4EFB\u4F55\u95EE\u9898\uFF0CAI\u5C06\u4F1A\u5C3D\u529B\u56DE\u7B54"}),(0,e.jsx)(_e,{className:"empty-notice",type:"secondary",style:{marginTop:"10px"},children:"\u672CAI\u667A\u80FD\u4F53\u57FA\u4E8EOpenAI\u5E93\u5B9E\u73B0\uFF0C\u652F\u6301\u5404\u79CD\u5927\u8BED\u8A00\u6A21\u578B\uFF0C\u63D0\u4F9B\u6D41\u7545\u7A33\u5B9A\u7684\u4F53\u9A8C"})]}):(0,e.jsxs)("div",{className:"messages-wrapper",children:[(0,e.jsx)("div",{className:"messages-header",children:(0,e.jsx)(v.ZP,{type:"text",danger:!0,icon:(0,e.jsx)(G.Z,{}),onClick:un,disabled:C||b.length===0,children:"\u6E05\u7A7A\u5BF9\u8BDD"})}),b.map(function(o,i){return(0,e.jsx)(_t,{message:o,models:ee},"".concat(o.id,"-").concat(i,"-").concat(o.content.length))})]}),(0,e.jsx)("div",{ref:ye})]}),(0,e.jsx)("div",{className:"input-container",children:(0,e.jsxs)(Ge.Z,{className:"input-card",children:[(0,e.jsx)("div",{className:"input-options",children:C&&(0,e.jsx)(v.ZP,{danger:!0,type:"primary",icon:(0,e.jsx)(pe,{}),onClick:jn,children:"\u505C\u6B62\u751F\u6210"})}),(0,e.jsxs)("div",{className:"textarea-container",children:[(0,e.jsx)(Qt,{ref:ke,value:R,onChange:function(i){return Q(i.target.value)},onKeyDown:Cn,placeholder:"\u8F93\u5165\u60A8\u7684\u95EE\u9898\uFF0C\u6309\u56DE\u8F66\u53D1\u9001\uFF0CShift+\u56DE\u8F66\u6362\u884C...",autoSize:{minRows:1,maxRows:6},disabled:C}),(0,e.jsx)(v.ZP,{type:"primary",icon:C?(0,e.jsx)(Ae.Z,{}):(0,e.jsx)(Ve.Z,{}),onClick:xn,disabled:!R.trim()||C,className:"send-button",style:{flexShrink:0,borderRadius:"50%",width:"40px",height:"40px",minWidth:"40px",display:"flex",alignItems:"center",justifyContent:"center",padding:0}})]}),(0,e.jsx)(_e,{type:"secondary",className:"input-hint",children:"\u63D0\u793A: \u4F7F\u7528 \u56DE\u8F66\u952E \u5FEB\u6377\u53D1\u9001\u6D88\u606F\uFF0CShift+\u56DE\u8F66 \u6362\u884C"})]})})]}),(0,e.jsx)(qn,{visible:tn,onClose:function(){return Ze(!1)},models:ee,onAddModel:dn,onUpdateModel:En,onDeleteModel:cn})]})},ea=qt},80825:function(Bn,Se,n){var be=n(95688),z=n.n(be),Ne=n(63894),me=n.n(Ne),Le=n(76069),w=n.n(Le),Je=n(95111),B=n.n(Je),Ke=n(7790),g=n.n(Ke),s=n(43352),fe=n.n(s),he=n(61710),Y=n.n(he),S=n(52138),Ue=function(){function v(M){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];B()(this,v),fe()(this,"modelConfig",void 0),fe()(this,"messages",void 0),fe()(this,"client",null),fe()(this,"abortController",null),this.modelConfig=M,this.messages=ze,this.initClient()}return g()(v,[{key:"initClient",value:function(){this.modelConfig.accessKey&&(this.client=new S.ZP({apiKey:this.modelConfig.accessKey,baseURL:this.modelConfig.apiEndpoint,dangerouslyAllowBrowser:!0}))}},{key:"sendMessage",value:function(){var M=w()(z()().mark(function ae(Ye,Ge,G){var Pe,we,Qe,Ie,T,Xe,Me,oe,We,ve,pe,Ae,Ve,re;return z()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.abortController&&this.abortController.abort(),this.abortController=new AbortController,l.prev=2,this.client){l.next=7;break}if(this.initClient(),this.client){l.next=7;break}throw new Error("OpenAI\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5API\u5BC6\u94A5");case 7:return Pe=this.messages.filter(function(F){return F.role==="user"||F.role==="assistant"||F.role==="system"}).map(function(F){return{role:F.role,content:F.content}}),we=this.modelConfig.modelType||this.modelConfig.key,l.next=11,this.client.chat.completions.create({model:we,messages:[].concat(me()(Pe),[{role:"user",content:Ye}]),stream:!0,temperature:.7,tools:Ge?[{type:"function",function:{name:"search",description:"Search the web for information",parameters:{type:"object",properties:{query:{type:"string",description:"The search query"}},required:["query"]}}}]:void 0},{signal:this.abortController.signal});case 11:Qe=l.sent,Ie=!1,T=!1,l.prev=14,Me=Y()(Qe);case 16:return l.next=18,Me.next();case 18:if(!(Ie=!(oe=l.sent).done)){l.next=33;break}if(We=oe.value,Ae=((ve=We.choices[0])===null||ve===void 0||(ve=ve.delta)===null||ve===void 0?void 0:ve.content)||"",Ve=((pe=We.choices[0])===null||pe===void 0||(pe=pe.delta)===null||pe===void 0?void 0:pe.reasoning_content)||"",!Ae){l.next=26;break}return G.onMessage(Ae),l.next=26,new Promise(function(F){return setTimeout(F,5)});case 26:if(!(Ve&&G.onReasoningProcess)){l.next=30;break}return G.onReasoningProcess(Ve),l.next=30,new Promise(function(F){return setTimeout(F,5)});case 30:Ie=!1,l.next=16;break;case 33:l.next=39;break;case 35:l.prev=35,l.t0=l.catch(14),T=!0,Xe=l.t0;case 39:if(l.prev=39,l.prev=40,!(Ie&&Me.return!=null)){l.next=44;break}return l.next=44,Me.return();case 44:if(l.prev=44,!T){l.next=47;break}throw Xe;case 47:return l.finish(44);case 48:return l.finish(39);case 49:G.onComplete(),l.next=55;break;case 52:if(l.prev=52,l.t1=l.catch(2),l.t1.name!=="AbortError"){console.error("AI\u8BF7\u6C42\u9519\u8BEF:",l.t1),re="";try{l.t1.response&&l.t1.response.data?re=JSON.stringify(l.t1.response.data,null,2):l.t1.message?re=l.t1.message:typeof l.t1=="string"?re=l.t1:re=JSON.stringify(l.t1,null,2)}catch(F){re="\u672A\u80FD\u89E3\u6790\u9519\u8BEF\u8BE6\u60C5"}G.onError(re||"\u8BF7\u6C42\u5931\u8D25")}case 55:return l.prev=55,this.abortController=null,l.finish(55);case 58:case"end":return l.stop()}},ae,this,[[2,52,55,58],[14,35,39,49],[40,,44,48]])}));function ze(ae,Ye,Ge){return M.apply(this,arguments)}return ze}()},{key:"cancel",value:function(){this.abortController&&(this.abortController.abort(),this.abortController=null)}}]),v}();Se.Z=Ue}}]);
