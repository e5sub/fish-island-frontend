!(function(){"use strict";var bi=Object.defineProperty,xi=Object.defineProperties;var Ai=Object.getOwnPropertyDescriptors;var Sn=Object.getOwnPropertySymbols,Pi=Object.getPrototypeOf,Aa=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,Ci=Reflect.get;var Bs=(E,S)=>(S=Symbol[E])?S:Symbol.for("Symbol."+E);var xa=(E,S,_)=>S in E?bi(E,S,{enumerable:!0,configurable:!0,writable:!0,value:_}):E[S]=_,i=(E,S)=>{for(var _ in S||(S={}))Aa.call(S,_)&&xa(E,_,S[_]);if(Sn)for(var _ of Sn(S))Pa.call(S,_)&&xa(E,_,S[_]);return E},l=(E,S)=>xi(E,Ai(S));var ee=(E,S)=>{var _={};for(var I in E)Aa.call(E,I)&&S.indexOf(I)<0&&(_[I]=E[I]);if(E!=null&&Sn)for(var I of Sn(E))S.indexOf(I)<0&&Pa.call(E,I)&&(_[I]=E[I]);return _};var Rn=(E,S,_)=>Ci(Pi(E),_,S);var p=(E,S,_)=>new Promise((I,O)=>{var H=$=>{try{B(_.next($))}catch(M){O(M)}},Z=$=>{try{B(_.throw($))}catch(M){O(M)}},B=$=>$.done?I($.value):Promise.resolve($.value).then(H,Z);B((_=_.apply(E,S)).next())}),te=function(E,S){this[0]=E,this[1]=S},Fe=(E,S,_)=>{var I=(Z,B,$,M)=>{try{var le=_[Z](B),ce=(B=le.value)instanceof te,Pe=le.done;Promise.resolve(ce?B[0]:B).then(re=>ce?I(Z==="return"?Z:"next",B[1]?{done:re.done,value:re.value}:re,$,M):$({value:re,done:Pe})).catch(re=>I("throw",re,$,M))}catch(re){M(re)}},O=Z=>H[Z]=B=>new Promise(($,M)=>I(Z,B,$,M)),H={};return _=_.apply(E,S),H[Bs("asyncIterator")]=()=>H,O("next"),O("throw"),O("return"),H};var oe=(E,S,_)=>(S=E[Bs("asyncIterator")])?S.call(E):(E=E[Bs("iterator")](),S={},_=(I,O)=>(O=E[I])&&(S[I]=H=>new Promise((Z,B,$)=>(H=O.call(E,H),$=H.done,Promise.resolve(H.value).then(M=>Z({value:M,done:$}),B)))),_("next"),_("return"),S);(self.webpackChunkreact_frontend_init=self.webpackChunkreact_frontend_init||[]).push([[6797],{88284:function(E,S,_){var I=_(1413),O=_(67294),H=_(32857),Z=_(91146),B=function(le,ce){return O.createElement(Z.Z,(0,I.Z)((0,I.Z)({},le),{},{ref:ce,icon:H.Z}))},$=O.forwardRef(B);S.Z=$},85175:function(E,S,_){var I=_(1413),O=_(67294),H=_(48820),Z=_(91146),B=function(le,ce){return O.createElement(Z.Z,(0,I.Z)((0,I.Z)({},le),{},{ref:ce,icon:H.Z}))},$=O.forwardRef(B);S.Z=$},13923:function(E,S,_){_.d(S,{Z:function(){return le}});var I=_(1413),O=_(67294),H={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},Z=H,B=_(91146),$=function(Pe,re){return O.createElement(B.Z,(0,I.Z)((0,I.Z)({},Pe),{},{ref:re,icon:Z}))},M=O.forwardRef($),le=M},50228:function(E,S,_){_.d(S,{Z:function(){return le}});var I=_(1413),O=_(67294),H={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"},Z=H,B=_(91146),$=function(Pe,re){return O.createElement(B.Z,(0,I.Z)((0,I.Z)({},Pe),{},{ref:re,icon:Z}))},M=O.forwardRef($),le=M},26058:function(E,S,_){_.d(S,{Z:function(){return ge}});var I=_(74902),O=_(67294),H=_(93967),Z=_.n(H),B=_(98423),$=_(53124),M=_(82401),le=_(50344),ce=_(39654);function Pe(K,de,ue){return typeof ue=="boolean"?ue:K.length?!0:(0,le.Z)(de).some(ae=>ae.type===ce.Z)}var re=_(24793),En=function(K,de){var ue={};for(var v in K)Object.prototype.hasOwnProperty.call(K,v)&&de.indexOf(v)<0&&(ue[v]=K[v]);if(K!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ae=0,v=Object.getOwnPropertySymbols(K);ae<v.length;ae++)de.indexOf(v[ae])<0&&Object.prototype.propertyIsEnumerable.call(K,v[ae])&&(ue[v[ae]]=K[v[ae]]);return ue};function Me({suffixCls:K,tagName:de,displayName:ue}){return v=>O.forwardRef((Ie,ke)=>O.createElement(v,Object.assign({ref:ke,suffixCls:K,tagName:de},Ie)))}const mt=O.forwardRef((K,de)=>{const{prefixCls:ue,suffixCls:v,className:ae,tagName:Ie}=K,ke=En(K,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:pt}=O.useContext($.E_),Le=pt("layout",ue),[Ce,qe,$e]=(0,re.ZP)(Le),Ye=v?`${Le}-${v}`:Le;return Ce(O.createElement(Ie,Object.assign({className:Z()(ue||Ye,ae,qe,$e),ref:de},ke)))}),Ds=O.forwardRef((K,de)=>{const{direction:ue}=O.useContext($.E_),[v,ae]=O.useState([]),{prefixCls:Ie,className:ke,rootClassName:pt,children:Le,hasSider:Ce,tagName:qe,style:$e}=K,Ye=En(K,["prefixCls","className","rootClassName","children","hasSider","tagName","style"]),In=(0,B.Z)(Ye,["suffixCls"]),{getPrefixCls:$n,className:Tn,style:Dt}=(0,$.dj)("layout"),et=$n("layout",Ie),_t=Pe(v,Le,Ce),[jt,Ut,Wt]=(0,re.ZP)(et),Ht=Z()(et,{[`${et}-has-sider`]:_t,[`${et}-rtl`]:ue==="rtl"},Tn,ke,pt,Ut,Wt),Jt=O.useMemo(()=>({siderHook:{addSider:gt=>{ae(yt=>[].concat((0,I.Z)(yt),[gt]))},removeSider:gt=>{ae(yt=>yt.filter(Nn=>Nn!==gt))}}}),[]);return jt(O.createElement(M.V.Provider,{value:Jt},O.createElement(qe,Object.assign({ref:de,className:Ht,style:Object.assign(Object.assign({},Dt),$e)},In),Le)))}),js=Me({tagName:"div",displayName:"Layout"})(Ds),vn=Me({suffixCls:"header",tagName:"header",displayName:"Header"})(mt),Us=Me({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(mt),Bt=Me({suffixCls:"content",tagName:"main",displayName:"Content"})(mt);var On=js;const Oe=On;Oe.Header=vn,Oe.Footer=Us,Oe.Content=Bt,Oe.Sider=ce.Z,Oe._InternalSiderContext=ce.D;var ge=Oe},52138:function(E,S,_){_.d(S,{ZP:function(){return yi}});const I="RFC3986",O={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:s=>String(s)},H="RFC1738",Z="RFC3986",B=Object.prototype.hasOwnProperty,$=Array.isArray,M=(()=>{const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})();function le(s){for(;s.length>1;){const e=s.pop();if(!e)continue;const t=e.obj[e.prop];if($(t)){const n=[];for(let r=0;r<t.length;++r)typeof t[r]!="undefined"&&n.push(t[r]);e.obj[e.prop]=n}}}function ce(s,e){const t=e&&e.plainObjects?Object.create(null):{};for(let n=0;n<s.length;++n)typeof s[n]!="undefined"&&(t[n]=s[n]);return t}function Pe(s,e,t={}){if(!e)return s;if(typeof e!="object"){if($(s))s.push(e);else if(s&&typeof s=="object")(t&&(t.plainObjects||t.allowPrototypes)||!B.call(Object.prototype,e))&&(s[e]=!0);else return[s,e];return s}if(!s||typeof s!="object")return[s].concat(e);let n=s;return $(s)&&!$(e)&&(n=ce(s,t)),$(s)&&$(e)?(e.forEach(function(r,a){if(B.call(s,a)){const o=s[a];o&&typeof o=="object"&&r&&typeof r=="object"?s[a]=Pe(o,r,t):s.push(r)}else s[a]=r}),s):Object.keys(e).reduce(function(r,a){const o=e[a];return B.call(r,a)?r[a]=Pe(r[a],o,t):r[a]=o,r},n)}function re(s,e){return Object.keys(e).reduce(function(t,n){return t[n]=e[n],t},s)}function En(s,e,t){const n=s.replace(/\+/g," ");if(t==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(r){return n}}const Me=1024,mt=(s,e,t,n,r)=>{if(s.length===0)return s;let a=s;if(typeof s=="symbol"?a=Symbol.prototype.toString.call(s):typeof s!="string"&&(a=String(s)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let o="";for(let c=0;c<a.length;c+=Me){const f=a.length>=Me?a.slice(c,c+Me):a,d=[];for(let h=0;h<f.length;++h){let u=f.charCodeAt(h);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||r===H&&(u===40||u===41)){d[d.length]=f.charAt(h);continue}if(u<128){d[d.length]=M[u];continue}if(u<2048){d[d.length]=M[192|u>>6]+M[128|u&63];continue}if(u<55296||u>=57344){d[d.length]=M[224|u>>12]+M[128|u>>6&63]+M[128|u&63];continue}h+=1,u=65536+((u&1023)<<10|f.charCodeAt(h)&1023),d[d.length]=M[240|u>>18]+M[128|u>>12&63]+M[128|u>>6&63]+M[128|u&63]}o+=d.join("")}return o};function Ds(s){const e=[{obj:{o:s},prop:"o"}],t=[];for(let n=0;n<e.length;++n){const r=e[n],a=r.obj[r.prop],o=Object.keys(a);for(let c=0;c<o.length;++c){const f=o[c],d=a[f];typeof d=="object"&&d!==null&&t.indexOf(d)===-1&&(e.push({obj:a,prop:f}),t.push(d))}}return le(e),s}function js(s){return Object.prototype.toString.call(s)==="[object RegExp]"}function vn(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function Us(s,e){return[].concat(s,e)}function Bt(s,e){if($(s)){const t=[];for(let n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)}const On=Object.prototype.hasOwnProperty,Oe={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,e){return String(s)+"["+e+"]"},repeat(s){return String(s)}},ge=Array.isArray,K=Array.prototype.push,de=function(s,e){K.apply(s,ge(e)?e:[e])},ue=Date.prototype.toISOString,v={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:mt,encodeValuesOnly:!1,format:I,formatter:O[I],indices:!1,serializeDate(s){return ue.call(s)},skipNulls:!1,strictNullHandling:!1};function ae(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const Ie={};function ke(s,e,t,n,r,a,o,c,f,d,h,u,m,x,g,U,L,w){let C=s,D=w,X=0,Y=!1;for(;(D=D.get(Ie))!==void 0&&!Y;){const N=D.get(s);if(X+=1,typeof N!="undefined"){if(N===X)throw new RangeError("Cyclic object value");Y=!0}typeof D.get(Ie)=="undefined"&&(X=0)}if(typeof d=="function"?C=d(e,C):C instanceof Date?C=m==null?void 0:m(C):t==="comma"&&ge(C)&&(C=Bt(C,function(N){return N instanceof Date?m==null?void 0:m(N):N})),C===null){if(a)return f&&!U?f(e,v.encoder,L,"key",x):e;C=""}if(ae(C)||vn(C)){if(f){const N=U?e:f(e,v.encoder,L,"key",x);return[(g==null?void 0:g(N))+"="+(g==null?void 0:g(f(C,v.encoder,L,"value",x)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(C)))]}const Q=[];if(typeof C=="undefined")return Q;let W;if(t==="comma"&&ge(C))U&&f&&(C=Bt(C,f)),W=[{value:C.length>0?C.join(",")||null:void 0}];else if(ge(d))W=d;else{const N=Object.keys(C);W=h?N.sort(h):N}const F=c?String(e).replace(/\./g,"%2E"):String(e),T=n&&ge(C)&&C.length===1?F+"[]":F;if(r&&ge(C)&&C.length===0)return T+"[]";for(let N=0;N<W.length;++N){const j=W[N],b=typeof j=="object"&&typeof j.value!="undefined"?j.value:C[j];if(o&&b===null)continue;const _e=u&&c?j.replace(/\./g,"%2E"):j,Qe=ge(C)?typeof t=="function"?t(T,_e):T:T+(u?"."+_e:"["+_e+"]");w.set(s,X);const Ae=new WeakMap;Ae.set(Ie,w),de(Q,ke(b,Qe,t,n,r,a,o,c,t==="comma"&&U&&ge(C)?null:f,d,h,u,m,x,g,U,L,Ae))}return Q}function pt(s=v){if(typeof s.allowEmptyArrays!="undefined"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys!="undefined"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder!="undefined"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=s.charset||v.charset;if(typeof s.charset!="undefined"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=I;if(typeof s.format!="undefined"){if(!On.call(O,s.format))throw new TypeError("Unknown format option provided.");t=s.format}const n=O[t];let r=v.filter;(typeof s.filter=="function"||ge(s.filter))&&(r=s.filter);let a;if(s.arrayFormat&&s.arrayFormat in Oe?a=s.arrayFormat:"indices"in s?a=s.indices?"indices":"repeat":a=v.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof s.allowDots=="undefined"?s.encodeDotInKeys?!0:v.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:v.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:v.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:v.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter=="undefined"?v.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:v.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:v.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:v.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:v.encodeValuesOnly,filter:r,format:t,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:v.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:v.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:v.strictNullHandling}}function Le(s,e={}){let t=s;const n=pt(e);let r,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):ge(n.filter)&&(a=n.filter,r=a);const o=[];if(typeof t!="object"||t===null)return"";const c=Oe[n.arrayFormat],f=c==="comma"&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const d=new WeakMap;for(let m=0;m<r.length;++m){const x=r[m];n.skipNulls&&t[x]===null||de(o,ke(t[x],x,c,f,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}const h=o.join(n.delimiter);let u=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?u+="utf8=%26%2310003%3B&":u+="utf8=%E2%9C%93&"),h.length>0?u+h:""}const Ce="4.104.0";let qe=!1,$e,Ye,In=null,$n=null,Tn=null,Dt,et=null,_t,jt,Ut,Wt,Ht,Jt;function gt(s,e={auto:!1}){if(qe)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if($e)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${$e}'\``);qe=e.auto,$e=s.kind,Ye=s.fetch,In=s.Request,$n=s.Response,Tn=s.Headers,Dt=s.FormData,et=s.Blob,_t=s.File,jt=s.ReadableStream,Ut=s.getMultipartRequestOptions,Wt=s.getDefaultAgent,Ht=s.fileFromPath,Jt=s.isFsReadStream}class yt{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Nn({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import \u2026 from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,r,a;try{t=fetch,n=Request,r=Response,a=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:a,FormData:typeof FormData!="undefined"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob!="undefined"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File!="undefined"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream!="undefined"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:(o,c)=>p(this,null,function*(){return l(i({},c),{body:new yt(o)})}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const Ws=()=>{$e||gt(Nn(),{auto:!0})};Ws();class A extends Error{}class ne extends A{constructor(e,t,n,r){super(`${ne.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r==null?void 0:r["x-request-id"],this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new Vt({message:n,cause:jn(t)});const a=t==null?void 0:t.error;return e===400?new Hs(e,a,n,r):e===401?new Js(e,a,n,r):e===403?new Vs(e,a,n,r):e===404?new Xs(e,a,n,r):e===409?new Zs(e,a,n,r):e===422?new Ks(e,a,n,r):e===429?new Gs(e,a,n,r):e>=500?new zs(e,a,n,r):new ne(e,a,n,r)}}class ye extends ne{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Vt extends ne{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Fn extends Vt{constructor({message:e}={}){super({message:e!=null?e:"Request timed out."})}}class Hs extends ne{}class Js extends ne{}class Vs extends ne{}class Xs extends ne{}class Zs extends ne{}class Ks extends ne{}class Gs extends ne{}class zs extends ne{}class Qs extends A{constructor(){super("Could not parse response content as the length limit was reached")}}class qs extends A{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Mn=_(48764).lW,Xt=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Ze=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},he;class Zt{constructor(){he.set(this,void 0),this.buffer=new Uint8Array,Xt(this,he,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let a;for(;(a=Ca(this.buffer,Ze(this,he,"f")))!=null;){if(a.carriage&&Ze(this,he,"f")==null){Xt(this,he,a.index,"f");continue}if(Ze(this,he,"f")!=null&&(a.index!==Ze(this,he,"f")+1||a.carriage)){r.push(this.decodeText(this.buffer.slice(0,Ze(this,he,"f")-1))),this.buffer=this.buffer.slice(Ze(this,he,"f")),Xt(this,he,null,"f");continue}const o=Ze(this,he,"f")!==null?a.preceding-1:a.preceding,c=this.decodeText(this.buffer.slice(0,o));r.push(c),this.buffer=this.buffer.slice(a.index),Xt(this,he,null,"f")}return r}decodeText(e){var t;if(e==null)return"";if(typeof e=="string")return e;if(typeof Mn!="undefined"){if(e instanceof Mn)return e.toString();if(e instanceof Uint8Array)return Mn.from(e).toString();throw new A(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder!="undefined"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return(t=this.textDecoder)!=null||(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new A(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new A("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}he=new WeakMap,Zt.NEWLINE_CHARS=new Set([`
`,"\r"]),Zt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Ca(s,e){for(let r=e!=null?e:0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function Sa(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}function Ys(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{next(){return p(this,null,function*(){try{const n=yield e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}})},return(){return p(this,null,function*(){const n=e.cancel();return e.releaseLock(),yield n,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}class Se{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;function r(){return Fe(this,null,function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{try{for(var o=oe(Ra(e,t)),c,f,d;c=!(f=yield new te(o.next())).done;c=!1){const h=f.value;if(!a){if(h.data.startsWith("[DONE]")){a=!0;continue}if(h.event===null||h.event.startsWith("response.")||h.event.startsWith("transcript.")){let u;try{u=JSON.parse(h.data)}catch(m){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),m}if(u&&u.error)throw new ne(void 0,u.error,void 0,ur(e.headers));yield u}else{let u;try{u=JSON.parse(h.data)}catch(m){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),m}if(h.event=="error")throw new ne(void 0,u.error,u.message,void 0);yield{event:h.event,data:u}}}}}catch(f){d=[f]}finally{try{c&&(f=o.return)&&(yield new te(f.call(o)))}finally{if(d)throw d[0]}}a=!0}catch(h){if(h instanceof Error&&h.name==="AbortError")return;throw h}finally{a||t.abort()}})}return new Se(r,t)}static fromReadableStream(e,t){let n=!1;function r(){return Fe(this,null,function*(){const o=new Zt,c=Ys(e);try{for(var f=oe(c),d,h,u;d=!(h=yield new te(f.next())).done;d=!1){const m=h.value;for(const x of o.decode(m))yield x}}catch(h){u=[h]}finally{try{d&&(h=f.return)&&(yield new te(h.call(f)))}finally{if(u)throw u[0]}}for(const m of o.flush())yield m})}function a(){return Fe(this,null,function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let o=!1;try{try{for(var c=oe(r()),f,d,h;f=!(d=yield new te(c.next())).done;f=!1){const u=d.value;o||u&&(yield JSON.parse(u))}}catch(d){h=[d]}finally{try{f&&(d=c.return)&&(yield new te(d.call(c)))}finally{if(h)throw h[0]}}o=!0}catch(u){if(u instanceof Error&&u.name==="AbortError")return;throw u}finally{o||t.abort()}})}return new Se(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=a=>({next:()=>{if(a.length===0){const o=n.next();e.push(o),t.push(o)}return a.shift()}});return[new Se(()=>r(e),this.controller),new Se(()=>r(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new jt({start(){return p(this,null,function*(){t=e[Symbol.asyncIterator]()})},pull(a){return p(this,null,function*(){try{const{value:o,done:c}=yield t.next();if(c)return a.close();const f=n.encode(JSON.stringify(o)+`
`);a.enqueue(f)}catch(o){a.error(o)}})},cancel(){return p(this,null,function*(){var a;yield(a=t.return)==null?void 0:a.call(t)})}})}}function Ra(s,e){return Fe(this,null,function*(){if(!s.body)throw e.abort(),new A("Attempted to iterate over a response with no body");const t=new va,n=new Zt,r=Ys(s.body);try{for(var a=oe(Ea(r)),o,c,f;o=!(c=yield new te(a.next())).done;o=!1){const d=c.value;for(const h of n.decode(d)){const u=t.decode(h);u&&(yield u)}}}catch(c){f=[c]}finally{try{o&&(c=a.return)&&(yield new te(c.call(a)))}finally{if(f)throw f[0]}}for(const d of n.flush()){const h=t.decode(d);h&&(yield h)}})}function Ea(s){return Fe(this,null,function*(){let e=new Uint8Array;try{for(var t=oe(s),n,r,a;n=!(r=yield new te(t.next())).done;n=!1){const o=r.value;if(o==null)continue;const c=o instanceof ArrayBuffer?new Uint8Array(o):typeof o=="string"?new TextEncoder().encode(o):o;let f=new Uint8Array(e.length+c.length);f.set(e),f.set(c,e.length),e=f;let d;for(;(d=Sa(e))!==-1;)yield e.slice(0,d),e=e.slice(d)}}catch(r){a=[r]}finally{try{n&&(r=t.return)&&(yield new te(r.call(t)))}finally{if(a)throw a[0]}}e.length>0&&(yield e)})}class va{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Oa(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function Oa(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}var er=_(48764).lW;const tr=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",nr=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Kt(s),Kt=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",sr=s=>nr(s)||tr(s)||Jt(s);function rr(s,e,t){return p(this,null,function*(){var r,a,o;if(s=yield s,nr(s))return s;if(tr(s)){const c=yield s.blob();e||(e=(r=new URL(s.url).pathname.split(/[\\/]/).pop())!=null?r:"unknown_file");const f=Kt(c)?[yield c.arrayBuffer()]:[c];return new _t(f,e,t)}const n=yield Ia(s);if(e||(e=(a=Ta(s))!=null?a:"unknown_file"),!(t!=null&&t.type)){const c=(o=n[0])==null?void 0:o.type;typeof c=="string"&&(t=l(i({},t),{type:c}))}return new _t(n,e,t)})}function Ia(s){return p(this,null,function*(){var o;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(Kt(s))e.push(yield s.arrayBuffer());else if(Na(s))try{for(var t=oe(s),n,r,a;n=!(r=yield t.next()).done;n=!1){const c=r.value;e.push(c)}}catch(r){a=[r]}finally{try{n&&(r=t.return)&&(yield r.call(t))}finally{if(a)throw a[0]}}else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(o=s==null?void 0:s.constructor)==null?void 0:o.name}; props: ${$a(s)}`);return e})}function $a(s){return`[${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}function Ta(s){var e;return kn(s.name)||kn(s.filename)||((e=kn(s.path))==null?void 0:e.split(/[\\/]/).pop())}const kn=s=>{if(typeof s=="string")return s;if(typeof er!="undefined"&&s instanceof er)return String(s)},Na=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",ar=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",Si=s=>p(this,null,function*(){if(!Ln(s.body))return s;const e=yield ir(s.body);return getMultipartRequestOptions(e,s)}),Ke=s=>p(this,null,function*(){const e=yield ir(s.body);return Ut(e,s)}),ir=s=>p(this,null,function*(){const e=new Dt;return yield Promise.all(Object.entries(s||{}).map(([t,n])=>Bn(e,t,n))),e}),Ln=s=>{if(sr(s))return!0;if(Array.isArray(s))return s.some(Ln);if(s&&typeof s=="object"){for(const e in s)if(Ln(s[e]))return!0}return!1},Bn=(s,e,t)=>p(this,null,function*(){if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(sr(t)){const n=yield rr(t);s.append(e,n)}else if(Array.isArray(t))yield Promise.all(t.map(n=>Bn(s,e+"[]",n)));else if(typeof t=="object")yield Promise.all(Object.entries(t).map(([n,r])=>Bn(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}});var tt=_(48764).lW,Be=_(54742),Fa=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Ma=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Gt;Ws();function or(s){return p(this,null,function*(){var o;const{response:e}=s;if(s.options.stream)return De("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):Se.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const t=e.headers.get("content-type"),n=(o=t==null?void 0:t.split(";")[0])==null?void 0:o.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const c=yield e.json();return De("response",e.status,e.url,e.headers,c),lr(c,e)}const a=yield e.text();return De("response",e.status,e.url,e.headers,a),a})}function lr(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class zt extends Promise{constructor(e,t=or){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new zt(this.responsePromise,t=>p(this,null,function*(){return lr(e(yield this.parseResponse(t),t),t.response)}))}asResponse(){return this.responsePromise.then(e=>e.response)}withResponse(){return p(this,null,function*(){const[e,t]=yield Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}})}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class ka{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=Dn("maxRetries",t),this.timeout=Dn("timeout",n),this.httpAgent=r,this.fetch=a!=null?a:Ye}authHeaders(e){return{}}defaultHeaders(e){return i(i({Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent()},Ua()),this.authHeaders(e))}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Ka()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(r=>p(this,null,function*(){const a=r&&Kt(r==null?void 0:r.body)?new DataView(yield r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return l(i({method:e,path:t},r),{body:a})})))}getAPIList(e,t,n){return this.requestAPIList(t,i({method:"get",path:e},n))}calculateContentLength(e){if(typeof e=="string"){if(typeof tt!="undefined")return tt.byteLength(e,"utf8").toString();if(typeof TextEncoder!="undefined")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var U,L,w,C,D,X;const n=i({},e),{method:r,path:a,query:o,headers:c={}}=n,f=ArrayBuffer.isView(n.body)||n.__binaryRequest&&typeof n.body=="string"?n.body:ar(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,d=this.calculateContentLength(f),h=this.buildURL(a,o);"timeout"in n&&Dn("timeout",n.timeout),n.timeout=(U=n.timeout)!=null?U:this.timeout;const u=(w=(L=n.httpAgent)!=null?L:this.httpAgent)!=null?w:Wt(h),m=n.timeout+1e3;typeof((C=u==null?void 0:u.options)==null?void 0:C.timeout)=="number"&&m>((D=u.options.timeout)!=null?D:0)&&(u.options.timeout=m),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=e.idempotencyKey);const x=this.buildHeaders({options:n,headers:c,contentLength:d,retryCount:t});return{req:l(i(l(i({method:r},f&&{body:f}),{headers:x}),u&&{agent:u}),{signal:(X=n.signal)!=null?X:null}),url:h,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const o=this.defaultHeaders(e);return pr(a,o),pr(a,t),ar(e.body)&&$e!=="node"&&delete a["content-type"],bt(o,"x-stainless-retry-count")===void 0&&bt(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),bt(o,"x-stainless-timeout")===void 0&&bt(t,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,t),a}prepareOptions(e){return p(this,null,function*(){})}prepareRequest(r,a){return p(this,arguments,function*(e,{url:t,options:n}){})}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):i({},e):{}}makeStatusError(e,t,n,r){return ne.generate(e,t,n,r)}request(e,t=null){return new zt(this.makeRequest(e,t))}makeRequest(e,t){return p(this,null,function*(){var u,m,x;const n=yield e,r=(u=n.maxRetries)!=null?u:this.maxRetries;t==null&&(t=r),yield this.prepareOptions(n);const{req:a,url:o,timeout:c}=this.buildRequest(n,{retryCount:r-t});if(yield this.prepareRequest(a,{url:o,options:n}),De("request",o,n,a.headers),(m=n.signal)!=null&&m.aborted)throw new ye;const f=new AbortController,d=yield this.fetchWithTimeout(o,a,c,f).catch(jn);if(d instanceof Error){if((x=n.signal)!=null&&x.aborted)throw new ye;if(t)return this.retryRequest(n,t);throw d.name==="AbortError"?new Fn:new Vt({cause:d})}const h=ur(d.headers);if(!d.ok){if(t&&this.shouldRetry(d)){const D=`retrying, ${t} attempts remaining`;return De(`response (error; ${D})`,d.status,o,h),this.retryRequest(n,t,h)}const g=yield d.text().catch(D=>jn(D).message),U=Wa(g),L=U?void 0:g;throw De(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,d.status,o,h,L),this.makeStatusError(d.status,U,L,h)}return{response:d,options:n,controller:f}})}requestAPIList(e,t){const n=this.makeRequest(t,null);return new La(this,n,e)}buildURL(e,t){const n=Ja(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return hr(r)||(t=i(i({},r),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n!="undefined").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new A(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}fetchWithTimeout(e,t,n,r){return p(this,null,function*(){const d=t||{},{signal:a}=d,o=ee(d,["signal"]);a&&a.addEventListener("abort",()=>r.abort());const c=setTimeout(()=>r.abort(),n),f=i({signal:r.signal},o);return f.method&&(f.method=f.method.toUpperCase()),this.fetch.call(void 0,e,f).finally(()=>{clearTimeout(c)})})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}retryRequest(e,t,n){return p(this,null,function*(){var c;let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const f=parseFloat(a);Number.isNaN(f)||(r=f)}const o=n==null?void 0:n["retry-after"];if(o&&!r){const f=parseFloat(o);Number.isNaN(f)?r=Date.parse(o)-Date.now():r=f*1e3}if(!(r&&0<=r&&r<60*1e3)){const f=(c=e.maxRetries)!=null?c:this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,f)}return yield wt(r),this.makeRequest(e,t-1)})}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,o=Math.min(.5*Math.pow(2,a),8),c=1-Math.random()*.25;return o*c*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ce}`}}class cr{constructor(e,t,n,r){Gt.set(this,void 0),Fa(this,Gt,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}getNextPage(){return p(this,null,function*(){const e=this.nextPageInfo();if(!e)throw new A("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t=i({},this.options);if("params"in e&&typeof t.query=="object")t.query=i(i({},t.query),e.params);else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[r,a]of n)e.url.searchParams.set(r,a);t.query=void 0,t.path=e.url.toString()}return yield Ma(this,Gt,"f").requestAPIList(this.constructor,t)})}iterPages(){return Fe(this,null,function*(){let e=this;for(yield e;e.hasNextPage();)e=yield new te(e.getNextPage()),yield e})}[(Gt=new WeakMap,Symbol.asyncIterator)](){return Fe(this,null,function*(){try{for(var e=oe(this.iterPages()),t,n,r;t=!(n=yield new te(e.next())).done;t=!1){const a=n.value;for(const o of a.getPaginatedItems())yield o}}catch(n){r=[n]}finally{try{t&&(n=e.return)&&(yield new te(n.call(e)))}finally{if(r)throw r[0]}}})}}class La extends zt{constructor(e,t,n){super(t,r=>p(this,null,function*(){return new n(e,r.response,yield or(r),r.options)}))}[Symbol.asyncIterator](){return Fe(this,null,function*(){const e=yield new te(this);try{for(var t=oe(e),n,r,a;n=!(r=yield new te(t.next())).done;n=!1){const o=r.value;yield o}}catch(r){a=[r]}finally{try{n&&(r=t.return)&&(yield new te(r.call(t)))}finally{if(a)throw a[0]}}})}}const ur=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),Ba={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},J=s=>typeof s=="object"&&s!==null&&!hr(s)&&Object.keys(s).every(e=>mr(Ba,e)),Da=()=>{var e,t;if(typeof Deno!="undefined"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":dr(Deno.build.os),"X-Stainless-Arch":fr(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)==null?void 0:e.deno)!=null?t:"unknown"};if(typeof EdgeRuntime!="undefined")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":Be.version};if(Object.prototype.toString.call(typeof Be!="undefined"?Be:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":dr(Be.platform),"X-Stainless-Arch":fr(Be.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":Be.version};const s=ja();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ce,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ja(){if(typeof navigator=="undefined"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,a=n[2]||0,o=n[3]||0;return{browser:e,version:`${r}.${a}.${o}`}}}return null}const fr=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",dr=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let Qt;const Ua=()=>Qt!=null?Qt:Qt=Da(),Wa=s=>{try{return JSON.parse(s)}catch(e){return}},Ha=/^[a-z][a-z0-9+.-]*:/i,Ja=s=>Ha.test(s),wt=s=>new Promise(e=>setTimeout(e,s)),Dn=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new A(`${s} must be an integer`);if(e<0)throw new A(`${s} must be a positive integer`);return e},jn=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null)try{return new Error(JSON.stringify(s))}catch(e){}return new Error(s)},Ri=s=>{if(s==null)throw new OpenAIError(`Expected a value to be given but received ${s} instead.`);return s},qt=s=>{var e,t,n,r,a;if(typeof Be!="undefined")return(t=(e={NODE_ENV:"production",PUBLIC_PATH:"/"}[s])==null?void 0:e.trim())!=null?t:void 0;if(typeof Deno!="undefined")return(a=(r=(n=Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,s))==null?void 0:a.trim()},Va=s=>{if(typeof s=="number")return Math.round(s);if(typeof s=="string")return parseInt(s,10);throw new OpenAIError(`Could not coerce ${s} (type: ${typeof s}) into a number`)},Xa=s=>{if(typeof s=="number")return s;if(typeof s=="string")return parseFloat(s);throw new OpenAIError(`Could not coerce ${s} (type: ${typeof s}) into a number`)},Za=s=>typeof s=="boolean"?s:typeof s=="string"?s==="true":!!s,Ei=s=>{if(s!==void 0)return Va(s)},vi=s=>{if(s!==void 0)return Xa(s)},Oi=s=>{if(s!==void 0)return Za(s)};function hr(s){if(!s)return!0;for(const e in s)return!1;return!0}function mr(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function pr(s,e){for(const t in e){if(!mr(e,t))continue;const n=t.toLowerCase();if(!n)continue;const r=e[t];r===null?delete s[n]:r!==void 0&&(s[n]=r)}}const _r=new Set(["authorization","api-key"]);function De(s,...e){if(typeof Be!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.DEBUG==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const a=l(i({},n),{headers:i({},n.headers)});for(const o in n.headers)_r.has(o.toLowerCase())&&(a.headers[o]="REDACTED");return a}let r=null;for(const a in n)_r.has(a.toLowerCase())&&(r!=null||(r=i({},n)),r[a]="REDACTED");return r!=null?r:n});console.log(`OpenAI:DEBUG:${s}`,...t)}}const Ka=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),Ga=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof navigator!="undefined",za=s=>typeof(s==null?void 0:s.get)=="function",Ii=(s,e)=>{const t=bt(s,e);if(t===void 0)throw new Error(`Could not find ${e} header`);return t},bt=(s,e)=>{var n;const t=e.toLowerCase();if(za(s)){const r=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,o,c)=>o+c.toUpperCase());for(const a of[e,t,e.toUpperCase(),r]){const o=s.get(a);if(o)return o}}for(const[r,a]of Object.entries(s))if(r.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a},$i=s=>{if(!s)return"";if(typeof tt!="undefined")return tt.from(s).toString("base64");if(typeof btoa!="undefined")return btoa(s);throw new OpenAIError("Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined")},Qa=s=>{if(typeof tt!="undefined"){const e=tt.from(s,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(s),t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return Array.from(new Float32Array(n.buffer))}};function Un(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}class P{constructor(e){this._client=e}}class gr extends P{create(e,t){var n;return this._client.post("/completions",l(i({body:e},t),{stream:(n=e.stream)!=null?n:!1}))}}class yr extends P{list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,qa,i({query:t},n))}}class Yt extends cr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}nextPageParams(){return null}nextPageInfo(){return null}}class G extends cr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class en extends P{constructor(){super(...arguments),this.messages=new yr(this._client)}create(e,t){var n;return this._client.post("/chat/completions",l(i({body:e},t),{stream:(n=e.stream)!=null?n:!1}))}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,i({body:t},n))}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/chat/completions",tn,i({query:e},t))}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}class tn extends G{}class qa extends G{}en.ChatCompletionsPage=tn,en.Messages=yr;class nn extends P{constructor(){super(...arguments),this.completions=new en(this._client)}}nn.Completions=en,nn.ChatCompletionsPage=tn;class wr extends P{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&De("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",i({body:l(i({},e),{encoding_format:r})},t));return n?a:(De("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(o=>(o&&o.data&&o.data.forEach(c=>{const f=c.embedding;c.embedding=Qa(f)}),o)))}}class Wn extends P{create(e,t){return this._client.post("/files",Ke(i({body:e},t)))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/files",Hn,i({query:e},t))}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,l(i({},t),{headers:i({Accept:"application/binary"},t==null?void 0:t.headers),__binaryResponse:!0}))}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}waitForProcessing(r){return p(this,arguments,function*(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),o=Date.now();let c=yield this.retrieve(e);for(;!c.status||!a.has(c.status);)if(yield wt(t),c=yield this.retrieve(e),Date.now()-o>n)throw new Fn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return c})}}class Hn extends G{}Wn.FileObjectsPage=Hn;class br extends P{createVariation(e,t){return this._client.post("/images/variations",Ke(i({body:e},t)))}edit(e,t){return this._client.post("/images/edits",Ke(i({body:e},t)))}generate(e,t){return this._client.post("/images/generations",i({body:e},t))}}class xr extends P{create(e,t){return this._client.post("/audio/speech",l(i({body:e},t),{headers:i({Accept:"application/octet-stream"},t==null?void 0:t.headers),__binaryResponse:!0}))}}class Ar extends P{create(e,t){var n;return this._client.post("/audio/transcriptions",Ke(l(i({body:e},t),{stream:(n=e.stream)!=null?n:!1,__metadata:{model:e.model}})))}}class Pr extends P{create(e,t){return this._client.post("/audio/translations",Ke(l(i({body:e},t),{__metadata:{model:e.model}})))}}class xt extends P{constructor(){super(...arguments),this.transcriptions=new Ar(this._client),this.translations=new Pr(this._client),this.speech=new xr(this._client)}}xt.Transcriptions=Ar,xt.Translations=Pr,xt.Speech=xr;class Cr extends P{create(e,t){return this._client.post("/moderations",i({body:e},t))}}class Jn extends P{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Vn,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Vn extends Yt{}Jn.ModelsPage=Vn;class Sr extends P{}class Rr extends P{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",i({body:e},t))}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",i({body:e},t))}}class Xn extends P{constructor(){super(...arguments),this.graders=new Rr(this._client)}}Xn.Graders=Rr;class Zn extends P{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,Kn,i({body:t,method:"post"},n))}retrieve(e,t={},n){return J(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,i({query:t},n))}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class Kn extends Yt{}Zn.PermissionCreateResponsesPage=Kn;class sn extends P{constructor(){super(...arguments),this.permissions=new Zn(this._client)}}sn.Permissions=Zn,sn.PermissionCreateResponsesPage=Kn;class Gn extends P{list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,zn,i({query:t},n))}}class zn extends G{}Gn.FineTuningJobCheckpointsPage=zn;class nt extends P{constructor(){super(...arguments),this.checkpoints=new Gn(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",i({body:e},t))}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Qn,i({query:e},t))}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return J(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,qn,i({query:t},n))}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class Qn extends G{}class qn extends G{}nt.FineTuningJobsPage=Qn,nt.FineTuningJobEventsPage=qn,nt.Checkpoints=Gn,nt.FineTuningJobCheckpointsPage=zn;class je extends P{constructor(){super(...arguments),this.methods=new Sr(this._client),this.jobs=new nt(this._client),this.checkpoints=new sn(this._client),this.alpha=new Xn(this._client)}}je.Methods=Sr,je.Jobs=nt,je.FineTuningJobsPage=Qn,je.FineTuningJobEventsPage=qn,je.Checkpoints=sn,je.Alpha=Xn;class Er extends P{}class Yn extends P{constructor(){super(...arguments),this.graderModels=new Er(this._client)}}Yn.GraderModels=Er;const Ya=s=>p(this,null,function*(){const e=yield Promise.allSettled(s),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const r of e)r.status==="fulfilled"&&n.push(r.value);return n});class rn extends P{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,l(i({body:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,l(i({body:n},r),{headers:i({"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers)}))}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,an,l(i({query:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}createAndPoll(e,t,n){return p(this,null,function*(){const r=yield this.create(e,t,n);return yield this.poll(e,r.id,n)})}poll(e,t,n){return p(this,null,function*(){const r=l(i({},n==null?void 0:n.headers),{"X-Stainless-Poll-Helper":"true"});for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=yield this.retrieve(e,t,l(i({},n),{headers:r})).withResponse(),o=a.data;switch(o.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const f=a.response.headers.get("openai-poll-after-ms");if(f){const d=parseInt(f);isNaN(d)||(c=d)}}yield wt(c);break;case"failed":case"completed":return o}}})}upload(e,t,n){return p(this,null,function*(){const r=yield this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)})}uploadAndPoll(e,t,n){return p(this,null,function*(){const r=yield this.upload(e,t,n);return yield this.poll(e,r.id,n)})}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,es,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}}class an extends G{}class es extends Yt{}rn.VectorStoreFilesPage=an,rn.FileContentResponsesPage=es;class vr extends P{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,l(i({body:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}createAndPoll(e,t,n){return p(this,null,function*(){const r=yield this.create(e,t);return yield this.poll(e,r.id,n)})}listFiles(e,t,n={},r){return J(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,an,l(i({query:n},r),{headers:i({"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers)}))}poll(e,t,n){return p(this,null,function*(){const r=l(i({},n==null?void 0:n.headers),{"X-Stainless-Poll-Helper":"true"});for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:o}=yield this.retrieve(e,t,l(i({},n),{headers:r})).withResponse();switch(a.status){case"in_progress":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const f=o.headers.get("openai-poll-after-ms");if(f){const d=parseInt(f);isNaN(d)||(c=d)}}yield wt(c);break;case"failed":case"cancelled":case"completed":return a}}})}uploadAndPoll(a,o,c){return p(this,arguments,function*(e,{files:t,fileIds:n=[]},r){var U;if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const f=(U=r==null?void 0:r.maxConcurrency)!=null?U:5,d=Math.min(f,t.length),h=this._client,u=t.values(),m=[...n];function x(L){return p(this,null,function*(){for(let w of L){const C=yield h.files.create({file:w,purpose:"assistants"},r);m.push(C.id)}})}const g=Array(d).fill(u).map(x);return yield Ya(g),yield this.createAndPoll(e,{file_ids:m})})}}class Ue extends P{constructor(){super(...arguments),this.files=new rn(this._client),this.fileBatches=new vr(this._client)}create(e,t){return this._client.post("/vector_stores",l(i({body:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,l(i({},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}update(e,t,n){return this._client.post(`/vector_stores/${e}`,l(i({body:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/vector_stores",ts,l(i({query:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}del(e,t){return this._client.delete(`/vector_stores/${e}`,l(i({},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,ns,l(i({body:t,method:"post"},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}}class ts extends G{}class ns extends Yt{}Ue.VectorStoresPage=ts,Ue.VectorStoreSearchResponsesPage=ns,Ue.Files=rn,Ue.VectorStoreFilesPage=an,Ue.FileContentResponsesPage=es,Ue.FileBatches=vr;class ss extends P{create(e,t){return this._client.post("/assistants",l(i({body:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}retrieve(e,t){return this._client.get(`/assistants/${e}`,l(i({},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}update(e,t,n){return this._client.post(`/assistants/${e}`,l(i({body:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/assistants",rs,l(i({query:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}del(e,t){return this._client.delete(`/assistants/${e}`,l(i({},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}}class rs extends G{}ss.AssistantsPage=rs;function Or(s){return typeof s.parse=="function"}class Ti{constructor(e){this.function=e.function,this.parse=e.parse,this.parameters=e.parameters,this.description=e.description,this.name=e.name}}class Ni{constructor(e){this.type="function",this.function=e}}const st=s=>(s==null?void 0:s.role)==="assistant",Ir=s=>(s==null?void 0:s.role)==="function",$r=s=>(s==null?void 0:s.role)==="tool";function Fi(s){return s!=null}var we=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},V=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},as,on,ln,At,Pt,cn,Ct,Te,St,un,fn,rt,Tr;class is{constructor(){as.add(this),this.controller=new AbortController,on.set(this,void 0),ln.set(this,()=>{}),At.set(this,()=>{}),Pt.set(this,void 0),cn.set(this,()=>{}),Ct.set(this,()=>{}),Te.set(this,{}),St.set(this,!1),un.set(this,!1),fn.set(this,!1),rt.set(this,!1),we(this,on,new Promise((e,t)=>{we(this,ln,e,"f"),we(this,At,t,"f")}),"f"),we(this,Pt,new Promise((e,t)=>{we(this,cn,e,"f"),we(this,Ct,t,"f")}),"f"),V(this,on,"f").catch(()=>{}),V(this,Pt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},V(this,as,"m",Tr).bind(this))},0)}_connected(){this.ended||(V(this,ln,"f").call(this),this._emit("connect"))}get ended(){return V(this,St,"f")}get errored(){return V(this,un,"f")}get aborted(){return V(this,fn,"f")}abort(){this.controller.abort()}on(e,t){return(V(this,Te,"f")[e]||(V(this,Te,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=V(this,Te,"f")[e];if(!n)return this;const r=n.findIndex(a=>a.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(V(this,Te,"f")[e]||(V(this,Te,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{we(this,rt,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}done(){return p(this,null,function*(){we(this,rt,!0,"f"),yield V(this,Pt,"f")})}_emit(e,...t){if(V(this,St,"f"))return;e==="end"&&(we(this,St,!0,"f"),V(this,cn,"f").call(this));const n=V(this,Te,"f")[e];if(n&&(V(this,Te,"f")[e]=n.filter(r=>!r.once),n.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!V(this,rt,"f")&&!(n!=null&&n.length)&&Promise.reject(r),V(this,At,"f").call(this,r),V(this,Ct,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!V(this,rt,"f")&&!(n!=null&&n.length)&&Promise.reject(r),V(this,At,"f").call(this,r),V(this,Ct,"f").call(this,r),this._emit("end")}}_emitFinal(){}}on=new WeakMap,ln=new WeakMap,At=new WeakMap,Pt=new WeakMap,cn=new WeakMap,Ct=new WeakMap,Te=new WeakMap,St=new WeakMap,un=new WeakMap,fn=new WeakMap,rt=new WeakMap,as=new WeakSet,Tr=function(e){if(we(this,un,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ye),e instanceof ye)return we(this,fn,!0,"f"),this._emit("abort",e);if(e instanceof A)return this._emit("error",e);if(e instanceof Error){const t=new A(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new A(String(e)))};function Mi(s,e){const t=i({},s);return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function ki(s,e){const t=i({},s);return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function os(s){return(s==null?void 0:s.$brand)==="auto-parseable-response-format"}function Li(s,{parser:e,callback:t}){const n=i({},s);return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:t,enumerable:!1}}),n}function Rt(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function ei(s,e){return!e||!Nr(e)?l(i({},s),{choices:s.choices.map(t=>l(i({},t),{message:i(l(i({},t.message),{parsed:null}),t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0)}))}):ls(s,e)}function ls(s,e){const t=s.choices.map(n=>{var r,a;if(n.finish_reason==="length")throw new Qs;if(n.finish_reason==="content_filter")throw new qs;return l(i({},n),{message:l(i(i({},n.message),n.message.tool_calls?{tool_calls:(a=(r=n.message.tool_calls)==null?void 0:r.map(o=>ni(e,o)))!=null?a:void 0}:void 0),{parsed:n.message.content&&!n.message.refusal?ti(e,n.message.content):null})})});return l(i({},s),{choices:t})}function ti(s,e){var t,n;return((t=s.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=s.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(e):JSON.parse(e):null}function ni(s,e){var n;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return((a=r.function)==null?void 0:a.name)===e.function.name});return l(i({},e),{function:l(i({},e.function),{parsed_arguments:Rt(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null})})}function si(s,e){var n;if(!s)return!1;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return((a=r.function)==null?void 0:a.name)===e.function.name});return Rt(t)||(t==null?void 0:t.function.strict)||!1}function Nr(s){var e,t;return os(s.response_format)?!0:(t=(e=s.tools)==null?void 0:e.some(n=>Rt(n)||n.type==="function"&&n.function.strict===!0))!=null?t:!1}function ri(s){for(const e of s!=null?s:[]){if(e.type!=="function")throw new A(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new A(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var fe=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ie,cs,dn,us,fs,ds,Fr,hs;const Mr=10;class kr extends is{constructor(){super(...arguments),ie.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Ir(e)||$r(e))&&e.content)this._emit("functionCallResult",e.content);else if(st(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(st(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}finalChatCompletion(){return p(this,null,function*(){yield this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new A("stream ended without producing a ChatCompletion");return e})}finalContent(){return p(this,null,function*(){return yield this.done(),fe(this,ie,"m",cs).call(this)})}finalMessage(){return p(this,null,function*(){return yield this.done(),fe(this,ie,"m",dn).call(this)})}finalFunctionCall(){return p(this,null,function*(){return yield this.done(),fe(this,ie,"m",us).call(this)})}finalFunctionCallResult(){return p(this,null,function*(){return yield this.done(),fe(this,ie,"m",fs).call(this)})}totalUsage(){return p(this,null,function*(){return yield this.done(),fe(this,ie,"m",ds).call(this)})}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=fe(this,ie,"m",dn).call(this);t&&this._emit("finalMessage",t);const n=fe(this,ie,"m",cs).call(this);n&&this._emit("finalContent",n);const r=fe(this,ie,"m",us).call(this);r&&this._emit("finalFunctionCall",r);const a=fe(this,ie,"m",fs).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",fe(this,ie,"m",ds).call(this))}_createChatCompletion(e,t,n){return p(this,null,function*(){const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),fe(this,ie,"m",Fr).call(this,t);const a=yield e.chat.completions.create(l(i({},t),{stream:!1}),l(i({},n),{signal:this.controller.signal}));return this._connected(),this._addChatCompletion(ls(a,t))})}_runChatCompletion(e,t,n){return p(this,null,function*(){for(const r of t.messages)this._addMessage(r,!1);return yield this._createChatCompletion(e,t,n)})}_runFunctions(e,t,n){return p(this,null,function*(){var x;const r="function",m=t,{function_call:a="auto",stream:o}=m,c=ee(m,["function_call","stream"]),f=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:d=Mr}=n||{},h={};for(const g of t.functions)h[g.name||g.function.name]=g;const u=t.functions.map(g=>({name:g.name||g.function.name,parameters:g.parameters,description:g.description}));for(const g of t.messages)this._addMessage(g,!1);for(let g=0;g<d;++g){const L=(x=(yield this._createChatCompletion(e,l(i({},c),{function_call:a,functions:u,messages:[...this.messages]}),n)).choices[0])==null?void 0:x.message;if(!L)throw new A("missing message in ChatCompletion response");if(!L.function_call)return;const{name:w,arguments:C}=L.function_call,D=h[w];if(D){if(f&&f!==w){const W=`Invalid function_call: ${JSON.stringify(w)}. ${JSON.stringify(f)} requested. Please try again`;this._addMessage({role:r,name:w,content:W});continue}}else{const W=`Invalid function_call: ${JSON.stringify(w)}. Available options are: ${u.map(F=>JSON.stringify(F.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:w,content:W});continue}let X;try{X=Or(D)?yield D.parse(C):C}catch(W){this._addMessage({role:r,name:w,content:W instanceof Error?W.message:String(W)});continue}const Y=yield D.function(X,this),Q=fe(this,ie,"m",hs).call(this,Y);if(this._addMessage({role:r,name:w,content:Q}),f)return}})}_runTools(e,t,n){return p(this,null,function*(){var g,U,L;const r="tool",x=t,{tool_choice:a="auto",stream:o}=x,c=ee(x,["tool_choice","stream"]),f=typeof a!="string"&&((g=a==null?void 0:a.function)==null?void 0:g.name),{maxChatCompletions:d=Mr}=n||{},h=t.tools.map(w=>{if(Rt(w)){if(!w.$callback)throw new A("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),u={};for(const w of h)w.type==="function"&&(u[w.function.name||w.function.function.name]=w.function);const m="tools"in t?h.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(const w of t.messages)this._addMessage(w,!1);for(let w=0;w<d;++w){const D=(U=(yield this._createChatCompletion(e,l(i({},c),{tool_choice:a,tools:m,messages:[...this.messages]}),n)).choices[0])==null?void 0:U.message;if(!D)throw new A("missing message in ChatCompletion response");if(!((L=D.tool_calls)!=null&&L.length))return;for(const X of D.tool_calls){if(X.type!=="function")continue;const Y=X.id,{name:Q,arguments:W}=X.function,F=u[Q];if(F){if(f&&f!==Q){const b=`Invalid tool_call: ${JSON.stringify(Q)}. ${JSON.stringify(f)} requested. Please try again`;this._addMessage({role:r,tool_call_id:Y,content:b});continue}}else{const b=`Invalid tool_call: ${JSON.stringify(Q)}. Available options are: ${Object.keys(u).map(_e=>JSON.stringify(_e)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:Y,content:b});continue}let T;try{T=Or(F)?yield F.parse(W):W}catch(b){const _e=b instanceof Error?b.message:String(b);this._addMessage({role:r,tool_call_id:Y,content:_e});continue}const N=yield F.function(T,this),j=fe(this,ie,"m",hs).call(this,N);if(this._addMessage({role:r,tool_call_id:Y,content:j}),f)return}}})}}ie=new WeakSet,cs=function(){var e;return(e=fe(this,ie,"m",dn).call(this).content)!=null?e:null},dn=function(){var n,r;let e=this.messages.length;for(;e-- >0;){const a=this.messages[e];if(st(a)){const t=a,{function_call:o}=t,c=ee(t,["function_call"]),f=l(i({},c),{content:(n=a.content)!=null?n:null,refusal:(r=a.refusal)!=null?r:null});return o&&(f.function_call=o),f}}throw new A("stream ended without producing a ChatCompletionMessage with role=assistant")},us=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(st(r)&&(r!=null&&r.function_call))return r.function_call;if(st(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},fs=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Ir(t)&&t.content!=null||$r(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},ds=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Fr=function(e){if(e.n!=null&&e.n>1)throw new A("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},hs=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Et extends kr{static runFunctions(e,t,n){const r=new Et,a=l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"runFunctions"})});return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new Et,a=l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"runTools"})});return r._run(()=>r._runTools(e,t,a)),r}_addMessage(e,t=!0){super._addMessage(e,t),st(e)&&e.content&&this._emit("content",e.content)}}const Lr=1,Br=2,Dr=4,jr=8,Ur=16,Wr=32,Hr=64,Jr=128,Vr=256,Xr=Jr|Vr,Zr=Ur|Wr|Xr|Hr,Kr=Lr|Br|Zr,Gr=Dr|jr,ai=Kr|Gr,q={STR:Lr,NUM:Br,ARR:Dr,OBJ:jr,NULL:Ur,BOOL:Wr,NAN:Hr,INFINITY:Jr,MINUS_INFINITY:Vr,INF:Xr,SPECIAL:Zr,ATOM:Kr,COLLECTION:Gr,ALL:ai};class ii extends Error{}class oi extends Error{}function li(s,e=q.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return ci(s.trim(),e)}const ci=(s,e)=>{const t=s.length;let n=0;const r=m=>{throw new ii(`${m} at position ${n}`)},a=m=>{throw new oi(`${m} at position ${n}`)},o=()=>(u(),n>=t&&r("Unexpected end of input"),s[n]==='"'?c():s[n]==="{"?f():s[n]==="["?d():s.substring(n,n+4)==="null"||q.NULL&e&&t-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||q.BOOL&e&&t-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||q.BOOL&e&&t-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||q.INFINITY&e&&t-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||q.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||q.NAN&e&&t-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):h()),c=()=>{const m=n;let x=!1;for(n++;n<t&&(s[n]!=='"'||x&&s[n-1]==="\\");)x=s[n]==="\\"?!x:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(m,++n-Number(x)))}catch(g){a(String(g))}else if(q.STR&e)try{return JSON.parse(s.substring(m,n-Number(x))+'"')}catch(g){return JSON.parse(s.substring(m,s.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},f=()=>{n++,u();const m={};try{for(;s[n]!=="}";){if(u(),n>=t&&q.OBJ&e)return m;const x=c();u(),n++;try{const g=o();Object.defineProperty(m,x,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(q.OBJ&e)return m;throw g}u(),s[n]===","&&n++}}catch(x){if(q.OBJ&e)return m;r("Expected '}' at end of object")}return n++,m},d=()=>{n++;const m=[];try{for(;s[n]!=="]";)m.push(o()),u(),s[n]===","&&n++}catch(x){if(q.ARR&e)return m;r("Expected ']' at end of array")}return n++,m},h=()=>{if(n===0){s==="-"&&q.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s)}catch(x){if(q.NUM&e)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch(g){}a(String(x))}}const m=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==t&&!(q.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(s.substring(m,n))}catch(x){s.substring(m,n)==="-"&&q.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s.substring(m,s.lastIndexOf("e")))}catch(g){a(String(g))}}},u=()=>{for(;n<t&&` 
\r	`.includes(s[n]);)n++};return o()},zr=s=>li(s,q.ALL^q.NUM);var at=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},k=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},z,Ne,it,We,ms,hn,ps,_s,gs,mn,ys,Qr;class ot extends kr{constructor(e){super(),z.add(this),Ne.set(this,void 0),it.set(this,void 0),We.set(this,void 0),at(this,Ne,e,"f"),at(this,it,[],"f")}get currentChatCompletionSnapshot(){return k(this,We,"f")}static fromReadableStream(e){const t=new ot(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const r=new ot(t);return r._run(()=>r._runChatCompletion(e,l(i({},t),{stream:!0}),l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"stream"})}))),r}_createChatCompletion(e,t,n){return p(this,null,function*(){var h;Rn(ot.prototype,this,"_createChatCompletion");const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),k(this,z,"m",ms).call(this);const a=yield e.chat.completions.create(l(i({},t),{stream:!0}),l(i({},n),{signal:this.controller.signal}));this._connected();try{for(var o=oe(a),c,f,d;c=!(f=yield o.next()).done;c=!1){const u=f.value;k(this,z,"m",ps).call(this,u)}}catch(f){d=[f]}finally{try{c&&(f=o.return)&&(yield f.call(o))}finally{if(d)throw d[0]}}if((h=a.controller.signal)!=null&&h.aborted)throw new ye;return this._addChatCompletion(k(this,z,"m",mn).call(this))})}_fromReadableStream(e,t){return p(this,null,function*(){var h;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),k(this,z,"m",ms).call(this),this._connected();const r=Se.fromReadableStream(e,this.controller);let a;try{for(var o=oe(r),c,f,d;c=!(f=yield o.next()).done;c=!1){const u=f.value;a&&a!==u.id&&this._addChatCompletion(k(this,z,"m",mn).call(this)),k(this,z,"m",ps).call(this,u),a=u.id}}catch(f){d=[f]}finally{try{c&&(f=o.return)&&(yield f.call(o))}finally{if(d)throw d[0]}}if((h=r.controller.signal)!=null&&h.aborted)throw new ye;return this._addChatCompletion(k(this,z,"m",mn).call(this))})}[(Ne=new WeakMap,it=new WeakMap,We=new WeakMap,z=new WeakSet,ms=function(){this.ended||at(this,We,void 0,"f")},hn=function(t){let n=k(this,it,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},k(this,it,"f")[t.index]=n,n)},ps=function(t){var r,a,o,c,f,d,h,u,m,x,g,U,L,w,C,D,X,Y,Q,W;if(this.ended)return;const n=k(this,z,"m",Qr).call(this,t);this._emit("chunk",t,n);for(const F of t.choices){const T=n.choices[F.index];F.delta.content!=null&&((r=T.message)==null?void 0:r.role)==="assistant"&&((a=T.message)!=null&&a.content)&&(this._emit("content",F.delta.content,T.message.content),this._emit("content.delta",{delta:F.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),F.delta.refusal!=null&&((o=T.message)==null?void 0:o.role)==="assistant"&&((c=T.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:F.delta.refusal,snapshot:T.message.refusal}),((f=F.logprobs)==null?void 0:f.content)!=null&&((d=T.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(h=F.logprobs)==null?void 0:h.content,snapshot:(m=(u=T.logprobs)==null?void 0:u.content)!=null?m:[]}),((x=F.logprobs)==null?void 0:x.refusal)!=null&&((g=T.message)==null?void 0:g.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(U=F.logprobs)==null?void 0:U.refusal,snapshot:(w=(L=T.logprobs)==null?void 0:L.refusal)!=null?w:[]});const N=k(this,z,"m",hn).call(this,T);T.finish_reason&&(k(this,z,"m",gs).call(this,T),N.current_tool_call_index!=null&&k(this,z,"m",_s).call(this,T,N.current_tool_call_index));for(const j of(C=F.delta.tool_calls)!=null?C:[])N.current_tool_call_index!==j.index&&(k(this,z,"m",gs).call(this,T),N.current_tool_call_index!=null&&k(this,z,"m",_s).call(this,T,N.current_tool_call_index)),N.current_tool_call_index=j.index;for(const j of(D=F.delta.tool_calls)!=null?D:[]){const b=(X=T.message.tool_calls)==null?void 0:X[j.index];b!=null&&b.type&&((b==null?void 0:b.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(Y=b.function)==null?void 0:Y.name,index:j.index,arguments:b.function.arguments,parsed_arguments:b.function.parsed_arguments,arguments_delta:(W=(Q=j.function)==null?void 0:Q.arguments)!=null?W:""}):(b==null||b.type,void 0))}}},_s=function(t,n){var o,c,f;if(k(this,z,"m",hn).call(this,t).done_tool_calls.has(n))return;const a=(o=t.message.tool_calls)==null?void 0:o[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const d=(f=(c=k(this,Ne,"f"))==null?void 0:c.tools)==null?void 0:f.find(h=>h.type==="function"&&h.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:Rt(d)?d.$parseRaw(a.function.arguments):d!=null&&d.function.strict?JSON.parse(a.function.arguments):null})}else a.type},gs=function(t){var r,a;const n=k(this,z,"m",hn).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const o=k(this,z,"m",ys).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},mn=function(){if(this.ended)throw new A("stream has ended, this shouldn't happen");const t=k(this,We,"f");if(!t)throw new A("request ended without sending any chunks");return at(this,We,void 0,"f"),at(this,it,[],"f"),ui(t,k(this,Ne,"f"))},ys=function(){var n;const t=(n=k(this,Ne,"f"))==null?void 0:n.response_format;return os(t)?t:null},Qr=function(t){var m,x,U,L,w,C;var n,r,a,o;let c=k(this,We,"f");const h=t,{choices:f}=h,d=ee(h,["choices"]);c?Object.assign(c,d):c=at(this,We,l(i({},d),{choices:[]}),"f");for(const Y of t.choices){const Q=Y,{delta:W,finish_reason:F,index:T,logprobs:N=null}=Q,j=ee(Q,["delta","finish_reason","index","logprobs"]);let b=c.choices[T];if(b||(b=c.choices[T]=i({finish_reason:F,index:T,message:{},logprobs:N},j)),N)if(!b.logprobs)b.logprobs=Object.assign({},N);else{const u=N,{content:Ve,refusal:Xe}=u,Lt=ee(u,["content","refusal"]);Object.assign(b.logprobs,Lt),Ve&&((m=(n=b.logprobs).content)!=null||(n.content=[]),b.logprobs.content.push(...Ve)),Xe&&((x=(r=b.logprobs).refusal)!=null||(r.refusal=[]),b.logprobs.refusal.push(...Xe))}if(F&&(b.finish_reason=F,k(this,Ne,"f")&&Nr(k(this,Ne,"f")))){if(F==="length")throw new Qs;if(F==="content_filter")throw new qs}if(Object.assign(b,j),!W)continue;const g=W,{content:_e,refusal:Qe,function_call:Ae,role:Mt,tool_calls:kt}=g,Cn=ee(g,["content","refusal","function_call","role","tool_calls"]);if(Object.assign(b.message,Cn),Qe&&(b.message.refusal=(b.message.refusal||"")+Qe),Mt&&(b.message.role=Mt),Ae&&(b.message.function_call?(Ae.name&&(b.message.function_call.name=Ae.name),Ae.arguments&&((U=(a=b.message.function_call).arguments)!=null||(a.arguments=""),b.message.function_call.arguments+=Ae.arguments)):b.message.function_call=Ae),_e&&(b.message.content=(b.message.content||"")+_e,!b.message.refusal&&k(this,z,"m",ys).call(this)&&(b.message.parsed=zr(b.message.content))),kt){b.message.tool_calls||(b.message.tool_calls=[]);for(const D of kt){const X=D,{index:Ve,id:Xe,type:Lt,function:Ee}=X,wi=ee(X,["index","id","type","function"]);const ve=(L=(o=b.message.tool_calls)[Ve])!=null?L:o[Ve]={};Object.assign(ve,wi),Xe&&(ve.id=Xe),Lt&&(ve.type=Lt),Ee&&((C=ve.function)!=null||(ve.function={name:(w=Ee.name)!=null?w:"",arguments:""})),Ee!=null&&Ee.name&&(ve.function.name=Ee.name),Ee!=null&&Ee.arguments&&(ve.function.arguments+=Ee.arguments,si(k(this,Ne,"f"),ve)&&(ve.function.parsed_arguments=zr(ve.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:()=>p(this,null,function*(){return e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0})}),return:()=>p(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}toReadableStream(){return new Se(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function ui(s,e){const d=s,{id:t,choices:n,created:r,model:a,system_fingerprint:o}=d,c=ee(d,["id","choices","created","model","system_fingerprint"]),f=i(l(i({},c),{id:t,choices:n.map(U=>{var L=U,{message:h,finish_reason:u,index:m,logprobs:x}=L,g=ee(L,["message","finish_reason","index","logprobs"]);var W,F,T;if(!u)throw new A(`missing finish_reason for choice ${m}`);const Q=h,{content:w=null,function_call:C,tool_calls:D}=Q,X=ee(Q,["content","function_call","tool_calls"]),Y=h.role;if(!Y)throw new A(`missing role for choice ${m}`);if(C){const{arguments:N,name:j}=C;if(N==null)throw new A(`missing function_call.arguments for choice ${m}`);if(!j)throw new A(`missing function_call.name for choice ${m}`);return l(i({},g),{message:{content:w,function_call:{arguments:N,name:j},role:Y,refusal:(W=h.refusal)!=null?W:null},finish_reason:u,index:m,logprobs:x})}return D?l(i({},g),{index:m,finish_reason:u,logprobs:x,message:l(i({},X),{role:Y,content:w,refusal:(F=h.refusal)!=null?F:null,tool_calls:D.map((N,j)=>{const Ve=N,{function:b,type:_e,id:Qe}=Ve,Ae=ee(Ve,["function","type","id"]),Xe=b||{},{arguments:Mt,name:kt}=Xe,Cn=ee(Xe,["arguments","name"]);if(Qe==null)throw new A(`missing choices[${m}].tool_calls[${j}].id
${pn(s)}`);if(_e==null)throw new A(`missing choices[${m}].tool_calls[${j}].type
${pn(s)}`);if(kt==null)throw new A(`missing choices[${m}].tool_calls[${j}].function.name
${pn(s)}`);if(Mt==null)throw new A(`missing choices[${m}].tool_calls[${j}].function.arguments
${pn(s)}`);return l(i({},Ae),{id:Qe,type:_e,function:l(i({},Cn),{name:kt,arguments:Mt})})})})}):l(i({},g),{message:l(i({},X),{content:w,role:Y,refusal:(T=h.refusal)!=null?T:null}),finish_reason:u,index:m,logprobs:x})}),created:r,model:a,object:"chat.completion"}),o?{system_fingerprint:o}:{});return ei(f,e)}function pn(s){return JSON.stringify(s)}function Bi(s){}function Di(s){}class lt extends ot{static fromReadableStream(e){const t=new lt(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const r=new lt(null),a=l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"runFunctions"})});return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new lt(t),a=l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"runTools"})});return r._run(()=>r._runTools(e,t,a)),r}}class qr extends P{parse(e,t){return ri(e.tools),this._client.chat.completions.create(e,l(i({},t),{headers:l(i({},t==null?void 0:t.headers),{"X-Stainless-Helper-Method":"beta.chat.completions.parse"})}))._thenUnwrap(n=>ls(n,e))}runFunctions(e,t){return e.stream?lt.runFunctions(this._client,e,t):Et.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?lt.runTools(this._client,e,t):Et.runTools(this._client,e,t)}stream(e,t){return ot.createChatCompletion(this._client,e,t)}}class ws extends P{constructor(){super(...arguments),this.completions=new qr(this._client)}}(function(s){s.Completions=qr})(ws||(ws={}));class Yr extends P{create(e,t){return this._client.post("/realtime/sessions",l(i({body:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}}class ea extends P{create(e,t){return this._client.post("/realtime/transcription_sessions",l(i({body:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}}class _n extends P{constructor(){super(...arguments),this.sessions=new Yr(this._client),this.transcriptionSessions=new ea(this._client)}}_n.Sessions=Yr,_n.TranscriptionSessions=ea;var y=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},me=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},se,bs,Re,gn,be,Ge,ct,ze,yn,pe,wn,bn,vt,Ot,It,ta,na,sa,ra,aa,ia,oa;class xe extends is{constructor(){super(...arguments),se.add(this),bs.set(this,[]),Re.set(this,{}),gn.set(this,{}),be.set(this,void 0),Ge.set(this,void 0),ct.set(this,void 0),ze.set(this,void 0),yn.set(this,void 0),pe.set(this,void 0),wn.set(this,void 0),bn.set(this,void 0),vt.set(this,void 0)}[(bs=new WeakMap,Re=new WeakMap,gn=new WeakMap,be=new WeakMap,Ge=new WeakMap,ct=new WeakMap,ze=new WeakMap,yn=new WeakMap,pe=new WeakMap,wn=new WeakMap,bn=new WeakMap,vt=new WeakMap,se=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:()=>p(this,null,function*(){return e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0})}),return:()=>p(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}static fromReadableStream(e){const t=new xe;return t._run(()=>t._fromReadableStream(e)),t}_fromReadableStream(e,t){return p(this,null,function*(){var d;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=Se.fromReadableStream(e,this.controller);try{for(var a=oe(r),o,c,f;o=!(c=yield a.next()).done;o=!1){const h=c.value;y(this,se,"m",Ot).call(this,h)}}catch(c){f=[c]}finally{try{o&&(c=a.return)&&(yield c.call(a))}finally{if(f)throw f[0]}}if((d=r.controller.signal)!=null&&d.aborted)throw new ye;return this._addRun(y(this,se,"m",It).call(this))})}toReadableStream(){return new Se(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,a){const o=new xe;return o._run(()=>o._runToolAssistantStream(e,t,n,r,l(i({},a),{headers:l(i({},a==null?void 0:a.headers),{"X-Stainless-Helper-Method":"stream"})}))),o}_createToolAssistantStream(e,t,n,r,a){return p(this,null,function*(){var x;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const c=l(i({},r),{stream:!0}),f=yield e.submitToolOutputs(t,n,c,l(i({},a),{signal:this.controller.signal}));this._connected();try{for(var d=oe(f),h,u,m;h=!(u=yield d.next()).done;h=!1){const g=u.value;y(this,se,"m",Ot).call(this,g)}}catch(u){m=[u]}finally{try{h&&(u=d.return)&&(yield u.call(d))}finally{if(m)throw m[0]}}if((x=f.controller.signal)!=null&&x.aborted)throw new ye;return this._addRun(y(this,se,"m",It).call(this))})}static createThreadAssistantStream(e,t,n){const r=new xe;return r._run(()=>r._threadAssistantStream(e,t,l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"stream"})}))),r}static createAssistantStream(e,t,n,r){const a=new xe;return a._run(()=>a._runAssistantStream(e,t,n,l(i({},r),{headers:l(i({},r==null?void 0:r.headers),{"X-Stainless-Helper-Method":"stream"})}))),a}currentEvent(){return y(this,wn,"f")}currentRun(){return y(this,bn,"f")}currentMessageSnapshot(){return y(this,be,"f")}currentRunStepSnapshot(){return y(this,vt,"f")}finalRunSteps(){return p(this,null,function*(){return yield this.done(),Object.values(y(this,Re,"f"))})}finalMessages(){return p(this,null,function*(){return yield this.done(),Object.values(y(this,gn,"f"))})}finalRun(){return p(this,null,function*(){if(yield this.done(),!y(this,Ge,"f"))throw Error("Final run was not received.");return y(this,Ge,"f")})}_createThreadAssistantStream(e,t,n){return p(this,null,function*(){var u;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a=l(i({},t),{stream:!0}),o=yield e.createAndRun(a,l(i({},n),{signal:this.controller.signal}));this._connected();try{for(var c=oe(o),f,d,h;f=!(d=yield c.next()).done;f=!1){const m=d.value;y(this,se,"m",Ot).call(this,m)}}catch(d){h=[d]}finally{try{f&&(d=c.return)&&(yield d.call(c))}finally{if(h)throw h[0]}}if((u=o.controller.signal)!=null&&u.aborted)throw new ye;return this._addRun(y(this,se,"m",It).call(this))})}_createAssistantStream(e,t,n,r){return p(this,null,function*(){var m;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o=l(i({},n),{stream:!0}),c=yield e.create(t,o,l(i({},r),{signal:this.controller.signal}));this._connected();try{for(var f=oe(c),d,h,u;d=!(h=yield f.next()).done;d=!1){const x=h.value;y(this,se,"m",Ot).call(this,x)}}catch(h){u=[h]}finally{try{d&&(h=f.return)&&(yield h.call(f))}finally{if(u)throw u[0]}}if((m=c.controller.signal)!=null&&m.aborted)throw new ye;return this._addRun(y(this,se,"m",It).call(this))})}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let a=e[n];if(a==null){e[n]=r;continue}if(n==="index"||n==="type"){e[n]=r;continue}if(typeof a=="string"&&typeof r=="string")a+=r;else if(typeof a=="number"&&typeof r=="number")a+=r;else if(Un(a)&&Un(r))a=this.accumulateDelta(a,r);else if(Array.isArray(a)&&Array.isArray(r)){if(a.every(o=>typeof o=="string"||typeof o=="number")){a.push(...r);continue}for(const o of r){if(!Un(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const c=o.index;if(c==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const f=a[c];f==null?a.push(o):a[c]=this.accumulateDelta(f,o)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}_threadAssistantStream(e,t,n){return p(this,null,function*(){return yield this._createThreadAssistantStream(t,e,n)})}_runAssistantStream(e,t,n,r){return p(this,null,function*(){return yield this._createAssistantStream(t,e,n,r)})}_runToolAssistantStream(e,t,n,r,a){return p(this,null,function*(){return yield this._createToolAssistantStream(n,e,t,r,a)})}}Ot=function(e){if(!this.ended)switch(me(this,wn,e,"f"),y(this,se,"m",sa).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":y(this,se,"m",oa).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":y(this,se,"m",na).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":y(this,se,"m",ta).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier");default:}},It=function(){if(this.ended)throw new A("stream has ended, this shouldn't happen");if(!y(this,Ge,"f"))throw Error("Final run has not been received");return y(this,Ge,"f")},ta=function(e){const[t,n]=y(this,se,"m",aa).call(this,e,y(this,be,"f"));me(this,be,t,"f"),y(this,gn,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,o=t.content[r.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=y(this,ct,"f")){if(y(this,ze,"f"))switch(y(this,ze,"f").type){case"text":this._emit("textDone",y(this,ze,"f").text,y(this,be,"f"));break;case"image_file":this._emit("imageFileDone",y(this,ze,"f").image_file,y(this,be,"f"));break}me(this,ct,r.index,"f")}me(this,ze,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(y(this,ct,"f")!==void 0){const r=e.data.content[y(this,ct,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,y(this,be,"f"));break;case"text":this._emit("textDone",r.text,y(this,be,"f"));break}}y(this,be,"f")&&this._emit("messageDone",e.data),me(this,be,void 0,"f")}},na=function(e){const t=y(this,se,"m",ra).call(this,e);switch(me(this,vt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==y(this,yn,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(y(this,pe,"f")&&this._emit("toolCallDone",y(this,pe,"f")),me(this,yn,a.index,"f"),me(this,pe,t.step_details.tool_calls[a.index],"f"),y(this,pe,"f")&&this._emit("toolCallCreated",y(this,pe,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":me(this,vt,void 0,"f"),e.data.step_details.type=="tool_calls"&&y(this,pe,"f")&&(this._emit("toolCallDone",y(this,pe,"f")),me(this,pe,void 0,"f")),this._emit("runStepDone",e.data,t);break;case"thread.run.step.in_progress":break}},sa=function(e){y(this,bs,"f").push(e),this._emit("event",e)},ra=function(e){switch(e.event){case"thread.run.step.created":return y(this,Re,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=y(this,Re,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=xe.accumulateDelta(t,n.delta);y(this,Re,"f")[e.data.id]=r}return y(this,Re,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":y(this,Re,"f")[e.data.id]=e.data;break}if(y(this,Re,"f")[e.data.id])return y(this,Re,"f")[e.data.id];throw new Error("No snapshot available")},aa=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=y(this,se,"m",ia).call(this,a,o)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},ia=function(e,t){return xe.accumulateDelta(t,e)},oa=function(e){switch(me(this,bn,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":me(this,Ge,e.data,"f"),y(this,pe,"f")&&(this._emit("toolCallDone",y(this,pe,"f")),me(this,pe,void 0,"f"));break;case"thread.run.cancelling":break}};function ji(s){}class xs extends P{create(e,t,n){return this._client.post(`/threads/${e}/messages`,l(i({body:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,l(i({body:n},r),{headers:i({"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers)}))}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,As,l(i({query:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}}class As extends G{}xs.MessagesPage=As;class Ps extends P{retrieve(e,t,n,r={},a){return J(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,l(i({query:r},a),{headers:i({"OpenAI-Beta":"assistants=v2"},a==null?void 0:a.headers)}))}list(e,t,n={},r){return J(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Cs,l(i({query:n},r),{headers:i({"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers)}))}}class Cs extends G{}Ps.RunStepsPage=Cs;class $t extends P{constructor(){super(...arguments),this.steps=new Ps(this._client)}create(e,t,n){var c;const o=t,{include:r}=o,a=ee(o,["include"]);return this._client.post(`/threads/${e}/runs`,l(i({query:{include:r},body:a},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers),stream:(c=t.stream)!=null?c:!1}))}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,l(i({body:n},r),{headers:i({"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers)}))}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Ss,l(i({query:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,l(i({},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}createAndPoll(e,t,n){return p(this,null,function*(){const r=yield this.create(e,t,n);return yield this.poll(e,r.id,n)})}createAndStream(e,t,n){return xe.createAssistantStream(e,this._client.beta.threads.runs,t,n)}poll(e,t,n){return p(this,null,function*(){const r=l(i({},n==null?void 0:n.headers),{"X-Stainless-Poll-Helper":"true"});for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:o}=yield this.retrieve(e,t,l(i({},n),{headers:i(i({},n==null?void 0:n.headers),r)})).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(n!=null&&n.pollIntervalMs)c=n.pollIntervalMs;else{const f=o.headers.get("openai-poll-after-ms");if(f){const d=parseInt(f);isNaN(d)||(c=d)}}yield wt(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}})}stream(e,t,n){return xe.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){var a;return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,l(i({body:n},r),{headers:i({"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers),stream:(a=n.stream)!=null?a:!1}))}submitToolOutputsAndPoll(e,t,n,r){return p(this,null,function*(){const a=yield this.submitToolOutputs(e,t,n,r);return yield this.poll(e,a.id,r)})}submitToolOutputsStream(e,t,n,r){return xe.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}class Ss extends G{}$t.RunsPage=Ss,$t.Steps=Ps,$t.RunStepsPage=Cs;class ut extends P{constructor(){super(...arguments),this.runs=new $t(this._client),this.messages=new xs(this._client)}create(e={},t){return J(e)?this.create({},e):this._client.post("/threads",l(i({body:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}retrieve(e,t){return this._client.get(`/threads/${e}`,l(i({},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}update(e,t,n){return this._client.post(`/threads/${e}`,l(i({body:t},n),{headers:i({"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers)}))}del(e,t){return this._client.delete(`/threads/${e}`,l(i({},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers)}))}createAndRun(e,t){var n;return this._client.post("/threads/runs",l(i({body:e},t),{headers:i({"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers),stream:(n=e.stream)!=null?n:!1}))}createAndRunPoll(e,t){return p(this,null,function*(){const n=yield this.createAndRun(e,t);return yield this.runs.poll(n.thread_id,n.id,t)})}createAndRunStream(e,t){return xe.createThreadAssistantStream(e,this._client.beta.threads,t)}}ut.Runs=$t,ut.RunsPage=Ss,ut.Messages=xs,ut.MessagesPage=As;class ft extends P{constructor(){super(...arguments),this.realtime=new _n(this._client),this.chat=new ws(this._client),this.assistants=new ss(this._client),this.threads=new ut(this._client)}}ft.Realtime=_n,ft.Assistants=ss,ft.AssistantsPage=rs,ft.Threads=ut;class Rs extends P{create(e,t){return this._client.post("/batches",i({body:e},t))}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/batches",Es,i({query:e},t))}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Es extends G{}Rs.BatchesPage=Es;class la extends P{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Ke(i({body:t},n)))}}class vs extends P{constructor(){super(...arguments),this.parts=new la(this._client)}create(e,t){return this._client.post("/uploads",i({body:e},t))}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,i({body:t},n))}}vs.Parts=la;function fi(s,e){return!e||!hi(e)?l(i({},s),{output_parsed:null,output:s.output.map(t=>t.type==="function_call"?l(i({},t),{parsed_arguments:null}):t.type==="message"?l(i({},t),{content:t.content.map(n=>l(i({},n),{parsed:null}))}):t)}):ca(s,e)}function ca(s,e){const t=s.output.map(r=>{if(r.type==="function_call")return l(i({},r),{parsed_arguments:mi(e,r)});if(r.type==="message"){const a=r.content.map(o=>o.type==="output_text"?l(i({},o),{parsed:di(e,o.text)}):o);return l(i({},r),{content:a})}return r}),n=Object.assign({},s,{output:t});return Object.getOwnPropertyDescriptor(s,"output_text")||da(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const r of n.output)if(r.type==="message"){for(const a of r.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function di(s,e){var t,n,r,a;return((n=(t=s.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((r=s.text)==null?void 0:r.format)?((a=s.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function hi(s){var e;return!!os((e=s.text)==null?void 0:e.format)}function Ui(s,{parser:e,callback:t}){const n=i({},s);return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:t,enumerable:!1}}),n}function ua(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function fa(s,e){return s.find(t=>t.type==="function"&&t.name===e)}function mi(s,e){var n;const t=fa((n=s.tools)!=null?n:[],e.name);return l(i(i({},e),e),{parsed_arguments:ua(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null})}function Wi(s,e){var n;if(!s)return!1;const t=fa((n=s.tools)!=null?n:[],e.name);return ua(t)||(t==null?void 0:t.strict)||!1}function Hi(s){for(const e of s!=null?s:[]){if(e.type!=="function")throw new OpenAIError(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new OpenAIError(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}function da(s){const e=[];for(const t of s.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);s.output_text=e.join("")}class ha extends P{list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,_i,i({query:t},n))}}var dt=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},He=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ht,xn,Je,An,ma,pa,_a,ga;class Os extends is{constructor(e){super(),ht.add(this),xn.set(this,void 0),Je.set(this,void 0),An.set(this,void 0),dt(this,xn,e,"f")}static createResponse(e,t,n){const r=new Os(t);return r._run(()=>r._createOrRetrieveResponse(e,t,l(i({},n),{headers:l(i({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"stream"})}))),r}_createOrRetrieveResponse(e,t,n){return p(this,null,function*(){var c,m;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),He(this,ht,"m",ma).call(this);let a,o=null;"response_id"in t?(a=yield e.responses.retrieve(t.response_id,{stream:!0},l(i({},n),{signal:this.controller.signal,stream:!0})),o=(c=t.starting_after)!=null?c:null):a=yield e.responses.create(l(i({},t),{stream:!0}),l(i({},n),{signal:this.controller.signal})),this._connected();try{for(var f=oe(a),d,h,u;d=!(h=yield f.next()).done;d=!1){const x=h.value;He(this,ht,"m",pa).call(this,x,o)}}catch(h){u=[h]}finally{try{d&&(h=f.return)&&(yield h.call(f))}finally{if(u)throw u[0]}}if((m=a.controller.signal)!=null&&m.aborted)throw new ye;return He(this,ht,"m",_a).call(this)})}[(xn=new WeakMap,Je=new WeakMap,An=new WeakMap,ht=new WeakSet,ma=function(){this.ended||dt(this,Je,void 0,"f")},pa=function(t,n){if(this.ended)return;const r=(o,c)=>{(n==null||c.sequence_number>n)&&this._emit(o,c)},a=He(this,ht,"m",ga).call(this,t);switch(r("event",t),t.type){case"response.output_text.delta":{const o=a.output[t.output_index];if(!o)throw new A(`missing output at index ${t.output_index}`);if(o.type==="message"){const c=o.content[t.content_index];if(!c)throw new A(`missing content at index ${t.content_index}`);if(c.type!=="output_text")throw new A(`expected content to be 'output_text', got ${c.type}`);r("response.output_text.delta",l(i({},t),{snapshot:c.text}))}break}case"response.function_call_arguments.delta":{const o=a.output[t.output_index];if(!o)throw new A(`missing output at index ${t.output_index}`);o.type==="function_call"&&r("response.function_call_arguments.delta",l(i({},t),{snapshot:o.arguments}));break}default:r(t.type,t);break}},_a=function(){if(this.ended)throw new A("stream has ended, this shouldn't happen");const t=He(this,Je,"f");if(!t)throw new A("request ended without sending any events");dt(this,Je,void 0,"f");const n=pi(t,He(this,xn,"f"));return dt(this,An,n,"f"),n},ga=function(t){let n=He(this,Je,"f");if(!n){if(t.type!=="response.created")throw new A(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=dt(this,Je,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const r=n.output[t.output_index];if(!r)throw new A(`missing output at index ${t.output_index}`);r.type==="message"&&r.content.push(t.part);break}case"response.output_text.delta":{const r=n.output[t.output_index];if(!r)throw new A(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new A(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new A(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const r=n.output[t.output_index];if(!r)throw new A(`missing output at index ${t.output_index}`);r.type==="function_call"&&(r.arguments+=t.delta);break}case"response.completed":{dt(this,Je,t.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:()=>p(this,null,function*(){return e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0})}),return:()=>p(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}finalResponse(){return p(this,null,function*(){yield this.done();const e=He(this,An,"f");if(!e)throw new A("stream ended without producing a ChatCompletion");return e})}}function pi(s,e){return fi(s,e)}class Is extends P{constructor(){super(...arguments),this.inputItems=new ha(this._client)}create(e,t){var n;return this._client.post("/responses",l(i({body:e},t),{stream:(n=e.stream)!=null?n:!1}))._thenUnwrap(r=>("object"in r&&r.object==="response"&&da(r),r))}retrieve(e,t={},n){var r;return this._client.get(`/responses/${e}`,l(i({query:t},n),{stream:(r=t==null?void 0:t.stream)!=null?r:!1}))}del(e,t){return this._client.delete(`/responses/${e}`,l(i({},t),{headers:i({Accept:"*/*"},t==null?void 0:t.headers)}))}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>ca(n,e))}stream(e,t){return Os.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,l(i({},t),{headers:i({Accept:"*/*"},t==null?void 0:t.headers)}))}}class _i extends G{}Is.InputItems=ha;class $s extends P{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return J(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,Ts,i({query:n},r))}}class Ts extends G{}$s.OutputItemListResponsesPage=Ts;class Tt extends P{constructor(){super(...arguments),this.outputItems=new $s(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,i({body:t},n))}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,Ns,i({query:t},n))}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class Ns extends G{}Tt.RunListResponsesPage=Ns,Tt.OutputItems=$s,Tt.OutputItemListResponsesPage=Ts;class Nt extends P{constructor(){super(...arguments),this.runs=new Tt(this._client)}create(e,t){return this._client.post("/evals",i({body:e},t))}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,i({body:t},n))}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/evals",Fs,i({query:e},t))}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class Fs extends G{}Nt.EvalListResponsesPage=Fs,Nt.Runs=Tt,Nt.RunListResponsesPage=Ns;class ya extends P{retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}/content`,l(i({},n),{headers:i({Accept:"application/binary"},n==null?void 0:n.headers),__binaryResponse:!0}))}}class Pn extends P{constructor(){super(...arguments),this.content=new ya(this._client)}create(e,t,n){return this._client.post(`/containers/${e}/files`,Ke(i({body:t},n)))}retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}`,n)}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,Ms,i({query:t},n))}del(e,t,n){return this._client.delete(`/containers/${e}/files/${t}`,l(i({},n),{headers:i({Accept:"*/*"},n==null?void 0:n.headers)}))}}class Ms extends G{}Pn.FileListResponsesPage=Ms,Pn.Content=ya;class Ft extends P{constructor(){super(...arguments),this.files=new Pn(this._client)}create(e,t){return this._client.post("/containers",i({body:e},t))}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/containers",ks,i({query:e},t))}del(e,t){return this._client.delete(`/containers/${e}`,l(i({},t),{headers:i({Accept:"*/*"},t==null?void 0:t.headers)}))}}class ks extends G{}Ft.ContainerListResponsesPage=ks,Ft.Files=Pn,Ft.FileListResponsesPage=Ms;var wa;class R extends ka{constructor(f={}){var d=f,{baseURL:e=qt("OPENAI_BASE_URL"),apiKey:t=qt("OPENAI_API_KEY"),organization:n=(o=>(o=qt("OPENAI_ORG_ID"))!=null?o:null)(),project:r=(c=>(c=qt("OPENAI_PROJECT_ID"))!=null?c:null)()}=d,a=ee(d,["baseURL","apiKey","organization","project"]);var u;if(t===void 0)throw new A("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const h=l(i({apiKey:t,organization:n,project:r},a),{baseURL:e||"https://api.openai.com/v1"});if(!h.dangerouslyAllowBrowser&&Ga())throw new A(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:h.baseURL,timeout:(u=h.timeout)!=null?u:6e5,httpAgent:h.httpAgent,maxRetries:h.maxRetries,fetch:h.fetch}),this.completions=new gr(this),this.chat=new nn(this),this.embeddings=new wr(this),this.files=new Wn(this),this.images=new br(this),this.audio=new xt(this),this.moderations=new Cr(this),this.models=new Jn(this),this.fineTuning=new je(this),this.graders=new Yn(this),this.vectorStores=new Ue(this),this.beta=new ft(this),this.batches=new Rs(this),this.uploads=new vs(this),this.responses=new Is(this),this.evals=new Nt(this),this.containers=new Ft(this),this._options=h,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return i(l(i({},super.defaultHeaders(e)),{"OpenAI-Organization":this.organization,"OpenAI-Project":this.project}),this._options.defaultHeaders)}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Le(e,{arrayFormat:"brackets"})}}wa=R,R.OpenAI=wa,R.DEFAULT_TIMEOUT=6e5,R.OpenAIError=A,R.APIError=ne,R.APIConnectionError=Vt,R.APIConnectionTimeoutError=Fn,R.APIUserAbortError=ye,R.NotFoundError=Xs,R.ConflictError=Zs,R.RateLimitError=Gs,R.BadRequestError=Hs,R.AuthenticationError=Js,R.InternalServerError=zs,R.PermissionDeniedError=Vs,R.UnprocessableEntityError=Ks,R.toFile=rr,R.fileFromPath=Ht,R.Completions=gr,R.Chat=nn,R.ChatCompletionsPage=tn,R.Embeddings=wr,R.Files=Wn,R.FileObjectsPage=Hn,R.Images=br,R.Audio=xt,R.Moderations=Cr,R.Models=Jn,R.ModelsPage=Vn,R.FineTuning=je,R.Graders=Yn,R.VectorStores=Ue,R.VectorStoresPage=ts,R.VectorStoreSearchResponsesPage=ns,R.Beta=ft,R.Batches=Rs,R.BatchesPage=Es,R.Uploads=vs,R.Responses=Is,R.Evals=Nt,R.EvalListResponsesPage=Fs,R.Containers=Ft,R.ContainerListResponsesPage=ks;class Ls extends null{constructor(d={}){var h=d,{baseURL:e=Core.readEnv("OPENAI_BASE_URL"),apiKey:t=Core.readEnv("AZURE_OPENAI_API_KEY"),apiVersion:n=Core.readEnv("OPENAI_API_VERSION"),endpoint:r,deployment:a,azureADTokenProvider:o,dangerouslyAllowBrowser:c}=h,f=ee(h,["baseURL","apiKey","apiVersion","endpoint","deployment","azureADTokenProvider","dangerouslyAllowBrowser"]);if(!n)throw new Errors.OpenAIError("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if(typeof o=="function"&&(c=!0),!o&&!t)throw new Errors.OpenAIError("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(o&&t)throw new Errors.OpenAIError("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(t!=null||(t=ba),f.defaultQuery=l(i({},f.defaultQuery),{"api-version":n}),e){if(r)throw new Errors.OpenAIError("baseURL and endpoint are mutually exclusive")}else{if(r||(r={NODE_ENV:"production",PUBLIC_PATH:"/"}.AZURE_OPENAI_ENDPOINT),!r)throw new Errors.OpenAIError("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${r}/openai`}super(i(i({apiKey:t,baseURL:e},f),c!==void 0?{dangerouslyAllowBrowser:c}:{})),this.apiVersion="",this._azureADTokenProvider=o,this.apiVersion=n,this.deploymentName=a}buildRequest(e,t={}){var n;if(gi.has(e.path)&&e.method==="post"&&e.body!==void 0){if(!Core.isObj(e.body))throw new Error("Expected request body to be an object");const r=this.deploymentName||e.body.model||((n=e.__metadata)==null?void 0:n.model);r!==void 0&&!this.baseURL.includes("/deployments")&&(e.path=`/deployments/${r}${e.path}`)}return super.buildRequest(e,t)}_getAzureADToken(){return p(this,null,function*(){if(typeof this._azureADTokenProvider=="function"){const e=yield this._azureADTokenProvider();if(!e||typeof e!="string")throw new Errors.OpenAIError(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}})}authHeaders(e){return{}}prepareOptions(e){return p(this,null,function*(){var n,r;if((n=e.headers)!=null&&n["api-key"])return Rn(Ls.prototype,this,"prepareOptions").call(this,e);const t=yield this._getAzureADToken();if((r=e.headers)!=null||(e.headers={}),t)e.headers.Authorization=`Bearer ${t}`;else if(this.apiKey!==ba)e.headers["api-key"]=this.apiKey;else throw new Errors.OpenAIError("Unable to handle auth");return Rn(Ls.prototype,this,"prepareOptions").call(this,e)})}}const gi=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations","/images/edits"]),ba="<Missing Key>";var yi=R}}]);
}());