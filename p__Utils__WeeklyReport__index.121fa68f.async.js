"use strict";(self.webpackChunkreact_frontend_init=self.webpackChunkreact_frontend_init||[]).push([[1903],{81778:function(Tt,he,n){var Se=n(57566),C=n.n(Se),be=n(64581),J=n.n(be),Ze=n(52487),Z=n.n(Ze),Fe=n(84169),V=n.n(Fe),ce=n(29957),m=n.n(ce),i=n(75204),M=n.n(i),R=n(75600),O=n.n(R),w=n(52138),h=function(){function d(q){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];V()(this,d),M()(this,"modelConfig",void 0),M()(this,"messages",void 0),M()(this,"client",null),M()(this,"abortController",null),this.modelConfig=q,this.messages=o,this.initClient()}return m()(d,[{key:"initClient",value:function(){this.modelConfig.accessKey&&(this.client=new w.ZP({apiKey:this.modelConfig.accessKey,baseURL:this.modelConfig.apiEndpoint,dangerouslyAllowBrowser:!0}))}},{key:"sendMessage",value:function(){var q=Z()(C()().mark(function U(K,ve,_){var ye,Ne,Te,$,me,ee,te,H,ne,ue,L,Ie,re,N;return C()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.abortController&&this.abortController.abort(),this.abortController=new AbortController,s.prev=2,this.client){s.next=7;break}if(this.initClient(),this.client){s.next=7;break}throw new Error("OpenAI\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5API\u5BC6\u94A5");case 7:return ye=this.messages.filter(function(B){return B.role==="user"||B.role==="assistant"||B.role==="system"}).map(function(B){return{role:B.role,content:B.content}}),Ne=this.modelConfig.modelType||this.modelConfig.key,s.next=11,this.client.chat.completions.create({model:Ne,messages:[].concat(J()(ye),[{role:"user",content:K}]),stream:!0,temperature:.7,tools:ve?[{type:"function",function:{name:"search",description:"Search the web for information",parameters:{type:"object",properties:{query:{type:"string",description:"The search query"}},required:["query"]}}}]:void 0},{signal:this.abortController.signal});case 11:Te=s.sent,$=!1,me=!1,s.prev=14,te=O()(Te);case 16:return s.next=18,te.next();case 18:if(!($=!(H=s.sent).done)){s.next=33;break}if(ne=H.value,Ie=((ue=ne.choices[0])===null||ue===void 0||(ue=ue.delta)===null||ue===void 0?void 0:ue.content)||"",re=((L=ne.choices[0])===null||L===void 0||(L=L.delta)===null||L===void 0?void 0:L.reasoning_content)||"",!Ie){s.next=26;break}return _.onMessage(Ie),s.next=26,new Promise(function(B){return setTimeout(B,5)});case 26:if(!(re&&_.onReasoningProcess)){s.next=30;break}return _.onReasoningProcess(re),s.next=30,new Promise(function(B){return setTimeout(B,5)});case 30:$=!1,s.next=16;break;case 33:s.next=39;break;case 35:s.prev=35,s.t0=s.catch(14),me=!0,ee=s.t0;case 39:if(s.prev=39,s.prev=40,!($&&te.return!=null)){s.next=44;break}return s.next=44,te.return();case 44:if(s.prev=44,!me){s.next=47;break}throw ee;case 47:return s.finish(44);case 48:return s.finish(39);case 49:_.onComplete(),s.next=55;break;case 52:if(s.prev=52,s.t1=s.catch(2),s.t1.name!=="AbortError"){console.error("AI\u8BF7\u6C42\u9519\u8BEF:",s.t1),N="";try{s.t1.response&&s.t1.response.data?N=JSON.stringify(s.t1.response.data,null,2):s.t1.message?N=s.t1.message:typeof s.t1=="string"?N=s.t1:N=JSON.stringify(s.t1,null,2)}catch(B){N="\u672A\u80FD\u89E3\u6790\u9519\u8BEF\u8BE6\u60C5"}_.onError(N||"\u8BF7\u6C42\u5931\u8D25")}case 55:return s.prev=55,this.abortController=null,s.finish(55);case 58:case"end":return s.stop()}},U,this,[[2,52,55,58],[14,35,39,49],[40,,44,48]])}));function o(U,K,ve){return q.apply(this,arguments)}return o}()},{key:"cancel",value:function(){this.abortController&&(this.abortController.abort(),this.abortController=null)}}]),d}();he.Z=h},13545:function(Tt,he,n){n.r(he),n.d(he,{default:function(){return jn}});var Se=n(57566),C=n.n(Se),be=n(64581),J=n.n(be),Ze=n(84136),Z=n.n(Ze),Fe=n(52487),V=n.n(Fe),ce=n(90785),m=n.n(ce),i=n(67294),M=n(26058),R=n(71471),O=n(55102),w=n(34041),h=n(47019),d=n(68872),q=n(32983),o=n(83622),U=n(2487),K=n(66309),ve=n(4393),_=n(78957),ye=n(42392),Ne=n(71230),Te=n(15746),$=n(55742),me=n(11941),ee=n(17788),te=n(58455),H=n(26412),ne=n(96074),ue=n(74330),L=n(51042),Ie=n(55287),re=n(47389),N=n(88284),at=n(71965),s=n(82061),B=n(50228),en=n(13923),tn=n(43425),nn=n(97302),un=n(19669),rn=n(85175),sn=n(27484),S=n.n(sn),Kn=n(33852),ot=n(72224),an=n(59542),on=n.n(an),It=n(24029),ze=n(38925),ln=n(96068),Pt=n(77123),dn=n(82257),e=n(85893),cn=w.Z.Option,kt=O.Z.TextArea,Hn=R.Z.Title,Je=R.Z.Text,Mt=R.Z.Paragraph,lt=me.Z.TabPane,Ot=function(){try{var P=localStorage.getItem("ai-agent-models");if(P)return JSON.parse(P)}catch(j){console.error("\u89E3\u6790AI\u6A21\u578B\u914D\u7F6E\u5931\u8D25:",j)}return[]},Rt=function(P){var j=Ot(),E=j.find(function(g){return g.key===P});return!!(E&&E.accessKey)},wt=[{title:"\u793A\u4F8B1: \u57FA\u7840\u4F18\u5316",content:"\u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u5DE5\u4F5C\u5468\u62A5\u52A9\u624B\uFF0C\u8BF7\u5E2E\u6211\u4F18\u5316\u4EE5\u4E0B\u5468\u62A5\u5185\u5BB9\uFF0C\u4F7F\u5176\u66F4\u52A0\u4E13\u4E1A\u548C\u6709\u6761\u7406\u3002\u4FDD\u6301\u539F\u6709\u7684\u6570\u636E\u51C6\u786E\u6027\uFF0C\u4F46\u53EF\u4EE5\u4F18\u5316\u8868\u8FF0\u65B9\u5F0F\u548C\u7ED3\u6784\u3002"},{title:"\u793A\u4F8B2: \u8BE6\u7EC6\u4F18\u5316",content:`\u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u5DE5\u4F5C\u5468\u62A5\u52A9\u624B\uFF0C\u8BF7\u6839\u636E\u4EE5\u4E0B\u5185\u5BB9\u751F\u6210\u4E00\u4EFD\u4E13\u4E1A\u7684\u5468\u62A5\uFF1A
1. \u9488\u5BF9\u672C\u5468\u5DE5\u4F5C\u5185\u5BB9\uFF0C\u8BF7\u63D0\u70BC\u91CD\u70B9\uFF0C\u6309\u91CD\u8981\u6027\u6392\u5E8F\uFF0C\u5E76\u4F7F\u7528\u4E13\u4E1A\u672F\u8BED\u6539\u5199
2. \u5728\u5DE5\u4F5C\u4EAE\u70B9\u90E8\u5206\uFF0C\u5F3A\u8C03\u6210\u679C\u548C\u5F71\u54CD\uFF0C\u4F7F\u7528\u6570\u636E\u652F\u6301\uFF08\u5982\u6709\uFF09
3. \u5BF9\u4E8E\u4E0B\u5468\u8BA1\u5212\uFF0C\u8BF7\u786E\u4FDD\u6761\u7406\u6E05\u6670\uFF0C\u6709\u660E\u786E\u7684\u65F6\u95F4\u8282\u70B9
4. \u95EE\u9898\u4E0E\u5EFA\u8BAE\u90E8\u5206\uFF0C\u5E94\u63D0\u4F9B\u5177\u4F53\u3001\u53EF\u884C\u7684\u89E3\u51B3\u65B9\u6848`}],Wt=[{title:"\u6807\u51C6\u5468\u62A5\u6A21\u677F",content:`
### \u672C\u5468\u5DE5\u4F5C\u603B\u7ED3
-
### \u5DE5\u4F5C\u4EAE\u70B9
- 
### \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212
- 
### \u95EE\u9898\u4E0E\u5EFA\u8BAE
- `}],Yt={fontFamily:"monospace",fontSize:"14px"},mn=function(P){var j=P.visible,E=P.onClose,g=P.settings,se=P.onSave,ft=h.Z.useForm(),Ve=m()(ft,1),z=Ve[0],Ue=h.Z.useForm(),ht=m()(Ue,1),G=ht[0],Ft=(0,i.useState)([]),ke=m()(Ft,2),ge=ke[0],$e=ke[1],vt=(0,i.useState)("model"),Me=m()(vt,2),Ee=Me[0],Ge=Me[1],yt=(0,i.useState)(!1),Oe=m()(yt,2),Re=Oe[0],Qe=Oe[1],jt=(0,i.useState)(!1),Xe=m()(jt,2),xe=Xe[0],F=Xe[1],gt=(0,i.useState)(null),we=m()(gt,2),Q=we[0],qe=we[1],Et=(0,i.useState)([]),We=m()(Et,2),ie=We[0],pe=We[1];(0,i.useEffect)(function(){var a=Ot();$e(a),g.modelKey&&Qe(Rt(g.modelKey))},[g.modelKey,j]),(0,i.useEffect)(function(){j&&(z.setFieldsValue({modelKey:g.modelKey,prompt:g.prompt,template:g.template}),pe(g.variables||[]))},[j,z,g]);var et=function(){d.ZP.info("\u6B63\u5728\u8DF3\u8F6C\u5230AI\u667A\u80FD\u4F53\u8BBE\u7F6E\u9875\u9762..."),dn.history.push("/utils/ai-agent"),E()},tt=function(p){Qe(Rt(p))},v=function(p){p?(qe(p),G.setFieldsValue(p)):(qe(null),G.resetFields()),F(!0)},Ce=function(){var a=V()(C()().mark(function p(){var x,X;return C()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.prev=0,y.next=3,G.validateFields();case 3:if(x=y.sent,!Q){y.next=9;break}X=ie.map(function(fe){return fe.key===Q.key?x:fe}),pe(X),y.next=13;break;case 9:if(!ie.some(function(fe){return fe.key===x.key})){y.next=12;break}return d.ZP.error("\u53D8\u91CF ".concat(x.key," \u5DF2\u5B58\u5728")),y.abrupt("return");case 12:pe([].concat(J()(ie),[x]));case 13:F(!1),d.ZP.success("".concat(Q?"\u66F4\u65B0":"\u6DFB\u52A0","\u53D8\u91CF\u6210\u529F")),y.next=20;break;case 17:y.prev=17,y.t0=y.catch(0),console.error("\u53D8\u91CF\u8868\u5355\u9A8C\u8BC1\u5931\u8D25:",y.t0);case 20:case"end":return y.stop()}},p,null,[[0,17]])}));return function(){return a.apply(this,arguments)}}(),xt=function(p){var x=ie.filter(function(X){return X.key!==p});pe(x),d.ZP.success("\u5220\u9664\u53D8\u91CF\u6210\u529F")},nt=function(){var a=V()(C()().mark(function p(){var x;return C()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,T.next=3,z.validateFields();case 3:x=T.sent,se({modelKey:x.modelKey,prompt:x.prompt,template:x.template,variables:ie}),d.ZP.success("AI\u6A21\u677F\u8BBE\u7F6E\u5DF2\u4FDD\u5B58"),E(),T.next=12;break;case 9:T.prev=9,T.t0=T.catch(0),console.error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25:",T.t0);case 12:case"end":return T.stop()}},p,null,[[0,9]])}));return function(){return a.apply(this,arguments)}}(),Ye=function(p){z.setFieldsValue({prompt:p}),d.ZP.success("\u5DF2\u5E94\u7528\u793A\u4F8B\u63D0\u793A\u8BCD")},ut=function(p){z.setFieldsValue({template:p}),d.ZP.success("\u5DF2\u5E94\u7528\u793A\u4F8B\u6A21\u677F")},Ct=[{title:"\u53D8\u91CF\u540D",dataIndex:"key",key:"key",render:function(p){return"{".concat(p,"}")}},{title:"\u63CF\u8FF0",dataIndex:"description",key:"description"},{title:"\u9ED8\u8BA4\u503C",dataIndex:"value",key:"value",render:function(p){return p||"(\u7A7A)"}},{title:"\u64CD\u4F5C",key:"action",render:function(p,x){return(0,e.jsxs)(_.Z,{size:"small",children:[(0,e.jsx)(o.ZP,{type:"text",icon:(0,e.jsx)(re.Z,{}),onClick:function(){return v(x)}}),(0,e.jsx)(o.ZP,{type:"text",danger:!0,icon:(0,e.jsx)(s.Z,{}),onClick:function(){return xt(x.key)}})]})}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(te.Z,{title:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(B.Z,{style:{marginRight:8}}),(0,e.jsx)("span",{children:"\u5468\u62A5AI\u6A21\u677F\u8BBE\u7F6E"})]}),width:700,placement:"right",onClose:E,open:j,footer:(0,e.jsx)("div",{style:{textAlign:"right"},children:(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(o.ZP,{onClick:E,children:"\u53D6\u6D88"}),(0,e.jsx)(o.ZP,{type:"primary",onClick:nt,children:"\u4FDD\u5B58\u8BBE\u7F6E"})]})}),children:(0,e.jsxs)(me.Z,{activeKey:Ee,onChange:Ge,children:[(0,e.jsx)(lt,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(B.Z,{}),"AI\u6A21\u578B"]}),children:(0,e.jsxs)(h.Z,{form:z,layout:"vertical",initialValues:{modelKey:g.modelKey,prompt:g.prompt,template:g.template},children:[(0,e.jsx)(h.Z.Item,{name:"modelKey",label:"\u9009\u62E9AI\u6A21\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9AI\u6A21\u578B"}],tooltip:"\u9009\u62E9\u7528\u4E8E\u751F\u6210\u5468\u62A5\u7684AI\u6A21\u578B\uFF0C\u786E\u4FDD\u5DF2\u8BBE\u7F6EAPI\u5BC6\u94A5",children:(0,e.jsx)(w.Z,{placeholder:"\u8BF7\u9009\u62E9AI\u6A21\u578B",onChange:tt,optionLabelProp:"label",dropdownMatchSelectWidth:!1,style:{width:"100%"},children:ge.map(function(a){return(0,e.jsx)(cn,{value:a.key,label:"".concat(a.icon," ").concat(a.name),children:(0,e.jsxs)(_.Z,{children:[(0,e.jsx)("span",{children:a.icon}),(0,e.jsx)("span",{children:a.name}),(0,e.jsxs)(Je,{type:"secondary",style:{fontSize:"12px"},children:["(",a.provider,")"]})]})},a.key)})})}),!Re&&(0,e.jsx)(ze.Z,{message:"\u6A21\u578B\u914D\u7F6E\u4E0D\u5B8C\u6574",description:(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:"\u6240\u9009\u6A21\u578B\u5C1A\u672A\u914D\u7F6EAPI\u5BC6\u94A5\uFF0C\u8BF7\u524D\u5F80AI\u667A\u80FD\u4F53\u8BBE\u7F6E\u5BC6\u94A5\u3002"}),(0,e.jsx)(o.ZP,{type:"primary",onClick:et,children:"\u524D\u5F80\u8BBE\u7F6E"})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),ge.length===0&&(0,e.jsx)(ze.Z,{message:"\u672A\u627E\u5230AI\u6A21\u578B",description:(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:"\u7CFB\u7EDF\u4E2D\u672A\u914D\u7F6E\u4EFB\u4F55AI\u6A21\u578B\uFF0C\u8BF7\u524D\u5F80AI\u667A\u80FD\u4F53\u6DFB\u52A0\u548C\u914D\u7F6E\u6A21\u578B\u3002"}),(0,e.jsx)(o.ZP,{type:"primary",onClick:et,children:"\u524D\u5F80\u8BBE\u7F6E"})]}),type:"error",showIcon:!0})]})},"model"),(0,e.jsx)(lt,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Pt.Z,{}),"AI\u63D0\u793A\u8BCD"]}),children:(0,e.jsxs)(h.Z,{form:z,layout:"vertical",initialValues:{modelKey:g.modelKey,prompt:g.prompt,template:g.template},children:[(0,e.jsx)(ze.Z,{message:"\u63D0\u793A\u8BCD\u8BF4\u660E",description:"\u8BBE\u7F6E\u7ED9AI\u7684\u63D0\u793A\u8BCD\uFF0C\u544A\u8BC9AI\u5982\u4F55\u5904\u7406\u5468\u62A5\u6A21\u677F\u3002\u63D0\u793A\u8BCD\u5E94\u8BE5\u6E05\u6670\u8BF4\u660EAI\u9700\u8981\u505A\u4EC0\u4E48\u3002",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,e.jsx)(h.Z.Item,{name:"prompt",label:"AI\u63D0\u793A\u8BCD",rules:[{required:!0,message:"\u8BF7\u8F93\u5165AI\u63D0\u793A\u8BCD"}],tooltip:"\u8BBE\u7F6E\u751F\u6210\u5468\u62A5\u65F6\u7ED9AI\u7684\u6307\u4EE4",children:(0,e.jsx)(kt,{rows:10,placeholder:"\u8BF7\u8F93\u5165AI\u63D0\u793A\u8BCD\uFF0C\u544A\u8BC9AI\u5982\u4F55\u5904\u7406\u5468\u62A5\u6A21\u677F",style:Yt,autoSize:{minRows:10,maxRows:20}})}),(0,e.jsxs)("div",{style:{marginBottom:16},children:[(0,e.jsx)(ne.Z,{orientation:"left",children:"\u63D0\u793A\u8BCD\u793A\u4F8B"}),wt.map(function(a,p){return(0,e.jsxs)(ve.Z,{size:"small",style:{marginBottom:p<wt.length-1?16:0},extra:(0,e.jsx)(o.ZP,{type:"link",size:"small",onClick:function(){return Ye(a.content)},children:"\u5E94\u7528\u6B64\u793A\u4F8B"}),children:[(0,e.jsx)(Je,{strong:!0,children:a.title}),(0,e.jsx)(Mt,{style:{color:"#666",whiteSpace:"pre-wrap"},children:a.content})]},p)})]})]})},"prompt"),(0,e.jsx)(lt,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Pt.Z,{}),"\u5468\u62A5\u6A21\u677F"]}),children:(0,e.jsxs)(h.Z,{form:z,layout:"vertical",initialValues:{modelKey:g.modelKey,prompt:g.prompt,template:g.template},children:[(0,e.jsx)(ze.Z,{message:"\u6A21\u677F\u8BF4\u660E",description:"\u60A8\u53EF\u4EE5\u8BBE\u7F6E\u5468\u62A5\u7684\u57FA\u672C\u6A21\u677F\uFF0C\u4F7F\u7528 {\u53D8\u91CF\u540D} \u4F5C\u4E3A\u5360\u4F4D\u7B26\uFF0C\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u66FF\u6362\u4E3A\u5BF9\u5E94\u5185\u5BB9\u3002",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,e.jsx)(h.Z.Item,{name:"template",label:"\u5468\u62A5\u6A21\u677F",tooltip:"\u8BBE\u7F6E\u5468\u62A5\u7684\u57FA\u672C\u6A21\u677F\u7ED3\u6784\uFF0C\u4F7F\u7528 {\u53D8\u91CF\u540D} \u4F5C\u4E3A\u5360\u4F4D\u7B26",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5468\u62A5\u6A21\u677F"}],children:(0,e.jsx)(kt,{rows:10,placeholder:"\u8BF7\u8F93\u5165\u5468\u62A5\u6A21\u677F\uFF0C\u4F7F\u7528 {\u53D8\u91CF\u540D} \u683C\u5F0F\u5F15\u7528\u53D8\u91CF",style:Yt,autoSize:{minRows:10,maxRows:20}})}),(0,e.jsxs)("div",{style:{marginBottom:16},children:[(0,e.jsx)(ne.Z,{orientation:"left",children:"\u6A21\u677F\u793A\u4F8B"}),Wt.map(function(a,p){return(0,e.jsxs)(ve.Z,{size:"small",style:{marginBottom:p<Wt.length-1?16:0},extra:(0,e.jsx)(o.ZP,{type:"link",size:"small",onClick:function(){return ut(a.content)},children:"\u5E94\u7528\u6B64\u6A21\u677F"}),children:[(0,e.jsx)(Je,{strong:!0,children:a.title}),(0,e.jsx)(Mt,{style:{color:"#666",whiteSpace:"pre-wrap"},children:a.content})]},p)})]}),(0,e.jsx)(ne.Z,{orientation:"left",children:"\u53D8\u91CF\u7BA1\u7406"}),(0,e.jsxs)("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[(0,e.jsxs)(Je,{type:"secondary",children:["\u5728\u6A21\u677F\u4E2D\u4F7F\u7528 ","{\u53D8\u91CF\u540D}"," \u683C\u5F0F\u5F15\u7528\u53D8\u91CF\uFF0C\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u66FF\u6362\u4E3A\u5BF9\u5E94\u5185\u5BB9"]}),(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(L.Z,{}),onClick:function(){return v()},children:"\u6DFB\u52A0\u53D8\u91CF"})]}),(0,e.jsx)(ln.Z,{dataSource:ie,columns:Ct,rowKey:"key",pagination:!1,size:"small"})]})},"template")]})}),(0,e.jsx)(ee.Z,{title:"".concat(Q?"\u7F16\u8F91":"\u6DFB\u52A0","\u53D8\u91CF"),open:xe,onCancel:function(){return F(!1)},onOk:Ce,children:(0,e.jsxs)(h.Z,{form:G,layout:"vertical",children:[(0,e.jsx)(h.Z.Item,{name:"key",label:"\u53D8\u91CF\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"\u53D8\u91CF\u540D\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF0C\u4E14\u5FC5\u987B\u4EE5\u5B57\u6BCD\u5F00\u5934"}],tooltip:"\u53D8\u91CF\u540D\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF0C\u4E14\u5FC5\u987B\u4EE5\u5B57\u6BCD\u5F00\u5934",children:(0,e.jsx)(O.Z,{placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D\uFF0C\u5982 userName",disabled:!!Q})}),(0,e.jsx)(h.Z.Item,{name:"description",label:"\u63CF\u8FF0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u63CF\u8FF0"}],children:(0,e.jsx)(O.Z,{placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u63CF\u8FF0\uFF0C\u5982 \u7528\u6237\u59D3\u540D"})}),(0,e.jsx)(h.Z.Item,{name:"value",label:"\u9ED8\u8BA4\u503C",children:(0,e.jsx)(O.Z,{placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u9ED8\u8BA4\u503C\uFF08\u53EF\u9009\uFF09"})})]})})]})},pn=mn,fn=n(81778);S().extend(on());var Nn=M.Z.Header,zn=M.Z.Content,Jn=R.Z.Title,hn=R.Z.Text,Fn=O.Z.TextArea,dt=w.Z.Option,vn=O.Z.Search,W={high:{color:"red",emoji:"\u{1F525}",text:"\u9AD8"},medium:{color:"orange",emoji:"\u26A1",text:"\u4E2D"},low:{color:"blue",emoji:"\u{1F331}",text:"\u4F4E"}},je={pending:{text:"\u5F85\u5B8C\u6210",color:"processing",icon:"\u26A1\uFE0F"},completed:{text:"\u5DF2\u5B8C\u6210",color:"success",icon:"\u2705"}},yn=function(){var P=(0,i.useState)(!1),j=m()(P,2),E=j[0],g=j[1];return(0,i.useEffect)(function(){var se=function(){g(window.innerWidth<=768)};return se(),window.addEventListener("resize",se),function(){return window.removeEventListener("resize",se)}},[]),E},Lt="weekly-ai-template",ct="weekly-report-history",mt="\u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u5DE5\u4F5C\u5468\u62A5\u52A9\u624B\uFF0C\u8BF7\u6839\u636E\u6211\u63D0\u4F9B\u7684\u5DE5\u4F5C\u5185\u5BB9\u548C\u5468\u62A5\u6A21\u677F\u5E2E\u6211\u751F\u6210\u5468\u62A5\u5185\u5BB9\uFF0C\u5185\u5BB9\u8981\u4E13\u4E1A\u548C\u6709\u6761\u7406\u3002\u4FDD\u6301\u539F\u6709\u7684\u6570\u636E\u51C6\u786E\u6027\uFF0C\u4F46\u53EF\u4EE5\u4F18\u5316\u8868\u8FF0\u65B9\u5F0F\u548C\u7ED3\u6784\u3002",pt=`
## \u672C\u5468\u5DE5\u4F5C\u603B\u7ED3
-
## \u5DE5\u4F5C\u4EAE\u70B9
- 
## \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212
- 
## \u95EE\u9898\u4E0E\u5EFA\u8BAE
- 
`;function jn(){var Pe=(0,i.useState)([]),P=m()(Pe,2),j=P[0],E=P[1],g=(0,i.useState)(!0),se=m()(g,2),ft=se[0],Ve=se[1],z=(0,i.useState)(!1),Ue=m()(z,2),ht=Ue[0],G=Ue[1],Ft=(0,i.useState)(!1),ke=m()(Ft,2),ge=ke[0],$e=ke[1],vt=(0,i.useState)(""),Me=m()(vt,2),Ee=Me[0],Ge=Me[1],yt=(0,i.useState)(S()()),Oe=m()(yt,2),Re=Oe[0],Qe=Oe[1],jt=h.Z.useForm(),Xe=m()(jt,1),xe=Xe[0],F=yn(),gt=(0,i.useState)("all"),we=m()(gt,2),Q=we[0],qe=we[1],Et=(0,i.useState)(!1),We=m()(Et,2),ie=We[0],pe=We[1],et=(0,i.useState)(null),tt=m()(et,2),v=tt[0],Ce=tt[1],xt=(0,i.useState)(""),nt=m()(xt,2),Ye=nt[0],ut=nt[1],Ct=(0,i.useState)(!1),a=m()(Ct,2),p=a[0],x=a[1],X=(0,i.useState)({modelKey:"",prompt:mt,template:pt,variables:[{key:"userName",description:"\u7528\u6237\u59D3\u540D",value:"\u6211"},{key:"startDate",description:"\u5F00\u59CB\u65E5\u671F",value:""},{key:"endDate",description:"\u7ED3\u675F\u65E5\u671F",value:""},{key:"currentWeek",description:"\u5F53\u524D\u5468\u65E5\u671F\u8303\u56F4",value:""},{key:"thisWeekTasks",description:"\u672C\u5468\u5DE5\u4F5C\u5185\u5BB9",value:""}]}),T=m()(X,2),y=T[0],fe=T[1],gn=(0,i.useState)(!1),Kt=m()(gn,2),ae=Kt[0],Le=Kt[1],En=(0,i.useState)(!1),Ht=m()(En,2),xn=Ht[0],De=Ht[1],Cn=(0,i.useState)(""),Nt=m()(Cn,2),oe=Nt[0],Dt=Nt[1],Dn=(0,i.useState)([]),zt=m()(Dn,2),rt=zt[0],At=zt[1],An=(0,i.useState)(!1),Jt=m()(An,2),_n=Jt[0],_t=Jt[1],Ke=(0,i.useRef)(null);(0,i.useEffect)(function(){var r=localStorage.getItem(Lt);if(r)try{var t=JSON.parse(r);t.variables||(t.variables=[{key:"userName",description:"\u7528\u6237\u59D3\u540D",value:"\u6211"},{key:"startDate",description:"\u5F00\u59CB\u65E5\u671F",value:""},{key:"endDate",description:"\u7ED3\u675F\u65E5\u671F",value:""},{key:"currentWeek",description:"\u5F53\u524D\u5468\u65E5\u671F\u8303\u56F4",value:""},{key:"thisWeekTasks",description:"\u672C\u5468\u5DE5\u4F5C\u5185\u5BB9",value:""}]),fe(t)}catch(u){console.error("\u89E3\u6790AI\u6A21\u677F\u8BBE\u7F6E\u5931\u8D25:",u)}},[]),(0,i.useEffect)(function(){var r=localStorage.getItem(ct);if(r)try{var t=JSON.parse(r);Array.isArray(t)&&At(t)}catch(u){console.error("\u89E3\u6790\u5468\u62A5\u5386\u53F2\u8BB0\u5F55\u5931\u8D25:",u)}},[]);var Bn=function(t){fe(t),localStorage.setItem(Lt,JSON.stringify(t))},Bt=function(){x(!0)},Sn=function(){x(!1)},St=function(){Ke.current&&(Ke.current.cancel(),Ke.current=null),Le(!1)},bn=function(){var r=V()(C()().mark(function t(){var u,l,c,A,Y,le,Ae,de,_e,Be,bt,b,f,it,Zt;return C()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(y.modelKey){D.next=4;break}return d.ZP.error("\u8BF7\u5148\u8BBE\u7F6EAI\u6A21\u578B\u548C\u6A21\u677F"),Bt(),D.abrupt("return");case 4:if(u=In(),l=u.find(function(I){return I.key===y.modelKey}),!(!l||!l.accessKey)){D.next=10;break}return d.ZP.error("AI\u6A21\u578B\u5BC6\u94A5\u672A\u914D\u7F6E\uFF0C\u8BF7\u5148\u5B8C\u6210\u914D\u7F6E"),Bt(),D.abrupt("return");case 10:if(c=y.prompt||mt,A=y.template||pt,St(),D.prev=13,Y=Ut(),Y.length!==0){D.next=18;break}return d.ZP.warning("\u672C\u5468\u6CA1\u6709\u5DE5\u4F5C\u5185\u5BB9\uFF0C\u751F\u6210\u7684\u5468\u62A5\u53EF\u80FD\u4E0D\u591F\u8BE6\u7EC6"),D.abrupt("return");case 18:return Le(!0),De(!0),Dt(""),le=Y.map(function(I,k){return"".concat(k+1,". ").concat(I.title).concat(I.status==="completed"?"(\u5DF2\u5B8C\u6210) ":" (\u8FDB\u884C\u4E2D)",` 
 \u8BE6\u7EC6\u5185\u5BB9\uFF1A`).concat(I.description||"\u6682\u65E0",` 
 \u4F18\u5148\u7EA7\uFF1A`).concat(I.priority)}).join(`
`),le=`\u8FD9\u662F\u6211\u672C\u5468\u7684\u5DE5\u4F5C\u5185\u5BB9\uFF1A
`.concat(le),Ae=y.variables.map(function(I){var k=I.value;return Z()(Z()({},I),{},{value:k})}),de=A,Ae.forEach(function(I){var k=new RegExp("{".concat(I.key,"}"),"g");de=de.replace(k,I.value)}),_e=c,Be=`\u4EE5\u4E0B\u662F\u5468\u62A5\u6A21\u677F\uFF1A
`.concat(de),bt=`

\u7ED3\u679C\u683C\u5F0F\u548C\u6392\u7248\u6309\u7167\u6211\u7ED9\u7684\u8FDB\u884C\u3002
1\u3001\u6BB5\u843D\u4E4B\u95F4\u4E0D\u8981\u7A7A\u884C\u3002
2\u3001\u4E0D\u8981\u8F93\u51FA\u4EFB\u4F55\u89E3\u91CA\u3002
3\u3001\u4E0D\u8981\u8F93\u51FA\u4EFB\u4F55\u5907\u6CE8\u3002
`,b=[{id:Date.now().toString(),role:"system",content:_e+Be+bt,timestamp:Date.now()}],f=new fn.Z(l,b),Ke.current=f,it="",D.next=35,f.sendMessage(le,!1,{onMessage:function(k){it+=k,Dt(it)},onError:function(k){d.ZP.error(typeof k=="string"?k:"\u751F\u6210\u5468\u62A5\u65F6\u53D1\u751F\u9519\u8BEF"),console.error("AI\u751F\u6210\u5468\u62A5\u9519\u8BEF:",k),Le(!1)},onComplete:function(){Ke.current=null;var k=S()().format("YYYY-MM-DD HH:mm:ss"),Ln={id:Date.now().toString(),content:it,date:k,title:"\u5468\u62A5 ".concat(k)},qt=[Ln].concat(J()(rt)).slice(0,10);At(qt),localStorage.setItem(ct,JSON.stringify(qt)),Le(!1),d.ZP.success("\u5468\u62A5\u751F\u6210\u5B8C\u6210")}});case 35:D.next=44;break;case 37:D.prev=37,D.t0=D.catch(13),console.error("\u751F\u6210\u5468\u62A5\u5931\u8D25:",D.t0),Zt="\u751F\u6210\u5468\u62A5\u65F6\u53D1\u751F\u9519\u8BEF",D.t0 instanceof Error&&(Zt="\u751F\u6210\u5931\u8D25: ".concat(D.t0.message)),d.ZP.error(Zt),Le(!1);case 44:case"end":return D.stop()}},t,null,[[13,37]])}));return function(){return r.apply(this,arguments)}}(),Zn=function(t){if(!t||!t.content){d.ZP.error("\u5468\u62A5\u5185\u5BB9\u4E3A\u7A7A");return}Dt(t.content),De(!0),_t(!1)},Tn=function(){if(!oe){d.ZP.error("\u5468\u62A5\u5185\u5BB9\u4E3A\u7A7A\uFF0C\u65E0\u6CD5\u590D\u5236");return}if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(oe).then(function(){return d.ZP.success("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}).catch(function(l){console.error("\u590D\u5236\u5931\u8D25:",l),d.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236")});else try{var t=document.createElement("textarea");t.value=oe,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();var u=document.execCommand("copy");document.body.removeChild(t),u?d.ZP.success("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"):d.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236")}catch(l){console.error("\u590D\u5236\u5931\u8D25:",l),d.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236")}},Vn=function(){if(!oe){d.ZP.error("\u5468\u62A5\u5185\u5BB9\u4E3A\u7A7A\uFF0C\u65E0\u6CD5\u5BFC\u51FA");return}try{var t=new Blob([oe],{type:"text/plain;charset=utf-8"}),u=URL.createObjectURL(t),l=document.createElement("a");l.href=u;var c=S()().format("YYYY-MM-DD");l.download="\u5468\u62A5_".concat(c,".txt"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(u),d.ZP.success("\u5468\u62A5\u5DF2\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6")}catch(A){console.error("\u5BFC\u51FA\u5931\u8D25:",A),d.ZP.error("\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}},In=function(){try{var t=localStorage.getItem("ai-agent-models");if(t)return JSON.parse(t)}catch(u){console.error("\u89E3\u6790AI\u6A21\u578B\u914D\u7F6E\u5931\u8D25:",u)}return[]};(0,i.useEffect)(function(){var r=function(){var t=V()(C()().mark(function u(){var l,c,A,Y,le,Ae,de,_e,Be;return C()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,Ve(!0),b.next=4,(0,It.p)({type:"weekly"});case 4:if(l=b.sent,l.data){if(c=Array.isArray(JSON.parse(l.data))?JSON.parse(l.data):[],A=c.filter(function(f){return f&&typeof f.id=="number"&&typeof f.title=="string"&&typeof f.startDate=="string"&&["high","medium","low"].includes(f.priority)&&["pending","completed"].includes(f.status)}),A.length>0)E(A),localStorage.setItem("weeklyTasks",JSON.stringify(A));else if(Y=localStorage.getItem("weeklyTasks"),Y)try{le=JSON.parse(Y),Ae=Array.isArray(le)?le.filter(function(f){return f&&typeof f.id=="number"&&typeof f.title=="string"&&typeof f.startDate=="string"&&["high","medium","low"].includes(f.priority)&&["pending","completed"].includes(f.status)}):[],Ae.length>0&&E(Ae)}catch(f){console.error("\u89E3\u6790\u672C\u5730\u5B58\u50A8\u6570\u636E\u5931\u8D25:",f),E([])}}b.next=13;break;case 8:if(b.prev=8,b.t0=b.catch(0),console.error("\u52A0\u8F7D\u5DE5\u4F5C\u5931\u8D25:",b.t0),de=localStorage.getItem("weeklyTasks"),de)try{_e=JSON.parse(de),Be=Array.isArray(_e)?_e.filter(function(f){return f&&typeof f.id=="number"&&typeof f.title=="string"&&typeof f.startDate=="string"&&["high","medium","low"].includes(f.priority)&&["pending","completed"].includes(f.status)}):[],Be.length>0&&E(Be)}catch(f){console.error("\u89E3\u6790\u672C\u5730\u5B58\u50A8\u6570\u636E\u5931\u8D25:",f),E([])}case 13:return b.prev=13,Ve(!1),b.finish(13);case 16:case"end":return b.stop()}},u,null,[[0,8,13,16]])}));return function(){return t.apply(this,arguments)}}();r()},[]),(0,i.useEffect)(function(){var r=function(){var t=V()(C()().mark(function u(){return C()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,(0,It.l)({todoData:j.map(function(A){return Z()(Z()({},A),{},{type:"weekly"})})});case 3:localStorage.setItem("weeklyTasks",JSON.stringify(j)),c.next=9;break;case 6:c.prev=6,c.t0=c.catch(0),console.error("\u4FDD\u5B58\u5DE5\u4F5C\u5931\u8D25:",c.t0);case 9:case"end":return c.stop()}},u,null,[[0,6]])}));return function(){return t.apply(this,arguments)}}();j.length>0&&r()},[j]);var Vt=function(){var t=Re.startOf("week"),u=Re.endOf("week");return{start:t,end:u,formatted:"".concat(t.format("MM\u6708DD\u65E5")," - ").concat(u.format("MM\u6708DD\u65E5"))}},st=function(t){if(xe.resetFields(),t)$e(!0),xe.setFieldsValue({title:t.title,description:t.description||"",startDateTime:t.startTime?S()("".concat(t.startDate," ").concat(t.startTime),"YYYY-MM-DD HH:mm:ss"):S()(t.startDate),endDateTime:t.endDate?S()("".concat(t.endDate," ").concat(t.endTime||"23:59:59"),"YYYY-MM-DD HH:mm:ss"):void 0,priority:t.priority}),Ce(t);else{$e(!1);var u=S()();xe.setFieldsValue({startDateTime:u,endDateTime:u.add(1,"day"),priority:"medium"}),Ce(null)}G(!0)},Pn=function(t){if(ge&&v){var u=j.map(function(c){return c.id===v.id?Z()(Z()({},c),{},{title:t.title,description:t.description,startDate:t.startDateTime.format("YYYY-MM-DD"),startTime:t.startDateTime.format("HH:mm:ss"),endDate:t.endDateTime?t.endDateTime.format("YYYY-MM-DD"):void 0,endTime:t.endDateTime?t.endDateTime.format("HH:mm:ss"):void 0,priority:t.priority}):c});E(u),d.ZP.success("\u5DE5\u4F5C\u66F4\u65B0\u6210\u529F")}else{var l={id:Date.now(),title:t.title,description:t.description,startDate:t.startDateTime.format("YYYY-MM-DD"),startTime:t.startDateTime.format("HH:mm:ss"),endDate:t.endDateTime?t.endDateTime.format("YYYY-MM-DD"):void 0,endTime:t.endDateTime?t.endDateTime.format("HH:mm:ss"):void 0,priority:t.priority,status:"pending"};E([].concat(J()(j),[l])),d.ZP.success("\u5DE5\u4F5C\u6DFB\u52A0\u6210\u529F")}G(!1)},kn=function(t){if(!Ye)return t;var u=Ye.toLowerCase();return t.filter(function(l){var c,A=l.title.toLowerCase().includes(u),Y=(c=l.description)===null||c===void 0?void 0:c.toLowerCase().includes(u);return A||Y})},Mn=function(t){st(t)},Ut=function(){var t=Vt(),u=t.start,l=t.end,c=j.filter(function(A){var Y=S()(A.startDate);return Y.isAfter(u)&&Y.isBefore(l)});return Q!=="all"&&(c=c.filter(function(A){return A.status===Q})),kn(c)},$t=function(){if(Ee.trim()!==""){var t=S()(),u={id:Date.now(),title:Ee.trim(),startDate:t.format("YYYY-MM-DD"),startTime:t.format("HH:mm:ss"),priority:"medium",status:"pending"};E([].concat(J()(j),[u])),Ge("")}},Gt=function(t){E(j.map(function(u){return u.id===t?Z()(Z()({},u),{},{status:"completed"}):u}))},Qt=function(t){E(j.map(function(u){return u.id===t?Z()(Z()({},u),{},{status:"pending"}):u}))},Xt=function(t){E(j.filter(function(u){return u.id!==t}))},On=function(t){Ce(t),pe(!0)},He=function(){pe(!1),Ce(null)},Rn=function(t,u){return t.length===0?(0,e.jsx)(q.Z,{description:(0,e.jsxs)("div",{style:{textAlign:"center"},children:[(0,e.jsx)("p",{style:{marginBottom:"8px",color:"#8c8c8c"},children:u}),(0,e.jsxs)(o.ZP,{type:"primary",onClick:function(){return st()},children:[(0,e.jsx)(L.Z,{})," \u6DFB\u52A0\u5DE5\u4F5C"]})]}),image:q.Z.PRESENTED_IMAGE_SIMPLE,style:{margin:"20px 0"}}):(0,e.jsx)(U.Z,{itemLayout:"horizontal",dataSource:t,renderItem:function(c){return wn(c)}})},wn=function(t){return(0,e.jsxs)(U.Z.Item,{actions:[(0,e.jsx)(o.ZP,{type:"text",icon:(0,e.jsx)(Ie.Z,{}),onClick:function(){return On(t)},style:{padding:"4px 12px",height:"32px",width:F?"100%":"auto"},children:"\u8BE6\u60C5"},"view"),(0,e.jsx)(o.ZP,{type:"text",icon:(0,e.jsx)(re.Z,{}),onClick:function(){return Mn(t)},style:{padding:"4px 12px",height:"32px",width:F?"100%":"auto"},children:"\u7F16\u8F91"},"edit"),t.status==="pending"?(0,e.jsx)(o.ZP,{style:{backgroundColor:"#52c41a",borderColor:"#52c41a",color:"#fff",boxShadow:"0 2px 4px rgba(111, 207, 151, 0.5)",borderRadius:"6px",padding:"4px 12px",height:"32px",marginBottom:F?"8px":0,width:F?"100%":"auto"},type:"primary",icon:(0,e.jsx)(N.Z,{}),onClick:function(){return Gt(t.id)},children:"\u5B8C\u6210"},"complete"):(0,e.jsx)(o.ZP,{style:{backgroundColor:"#1890ff",borderColor:"#1890ff",color:"#fff",borderRadius:"6px",padding:"4px 12px",height:"32px",marginBottom:F?"8px":0,width:F?"100%":"auto"},type:"primary",icon:(0,e.jsx)(at.Z,{}),onClick:function(){return Qt(t.id)},children:"\u6062\u590D"},"restore"),(0,e.jsx)(o.ZP,{type:"text",danger:!0,icon:(0,e.jsx)(s.Z,{}),onClick:function(){return Xt(t.id)},style:{padding:"4px 12px",height:"32px",width:F?"100%":"auto"},children:"\u5220\u9664"},"delete")],style:{background:"#fff",marginBottom:"12px",padding:F?"12px":"16px",borderRadius:"8px",boxShadow:t.status==="completed"?"0 2px 8px rgba(0,0,0,0.02)":"0 2px 8px rgba(0,0,0,0.04)",opacity:t.status==="completed"?.85:1,transition:"all 0.3s ease",border:t.status==="completed"?"1px solid rgba(82, 196, 26, 0.1)":"1px solid transparent",flexDirection:F?"column":"row",alignItems:F?"flex-start":"center"},children:[(0,e.jsx)(U.Z.Item.Meta,{style:{flex:1,marginBottom:F?"12px":0,width:"100%"},title:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:F?"14px":"16px",fontWeight:t.status==="completed"?400:500,color:t.status==="completed"?"#8c8c8c":"#333"},children:[t.status==="completed"?(0,e.jsx)("span",{style:{color:"#52c41a",fontSize:F?"16px":"18px"},children:je.completed.icon}):(0,e.jsx)("span",{style:{fontSize:F?"16px":"18px"},children:W[t.priority].emoji}),(0,e.jsx)("span",{style:{wordBreak:"break-all"},children:t.title}),(0,e.jsxs)(K.Z,{color:W[t.priority].color,style:{borderRadius:"4px",padding:"0 8px",height:"24px",lineHeight:"22px",opacity:t.status==="completed"?.7:1,fontSize:F?"12px":"14px"},children:[W[t.priority].text,"\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:je[t.status].color,style:{borderRadius:"4px",padding:"0 8px",height:"24px",lineHeight:"22px",fontSize:F?"12px":"14px"},children:je[t.status].text})]}),(0,e.jsxs)("span",{style:{color:"#8c8c8c",fontSize:F?"12px":"14px",marginLeft:"26px"},children:["\u5F00\u59CB: ",S()(t.startDate).format("YYYY-MM-DD")," ",t.startTime||"00:00:00",t.endDate&&" | \u622A\u6B62: ".concat(S()(t.endDate).format("YYYY-MM-DD")," ").concat(t.endTime||"23:59:59")]})]}),description:t.description&&(0,e.jsx)("div",{style:{marginTop:"8px",fontSize:F?"12px":"14px",lineHeight:"1.6",color:t.status==="completed"?"#8c8c8c":"#666",wordBreak:"break-all",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:t.description})}),F&&(0,e.jsx)("div",{style:{width:"100%",height:"1px"}})]},t.id)},Wn=function(t){var u=rt.filter(function(l){return l.id!==t});At(u),localStorage.setItem(ct,JSON.stringify(u)),d.ZP.success("\u5DF2\u5220\u9664\u5386\u53F2\u5468\u62A5")},Yn=function(t){if(!t)return"";try{var u=typeof t=="string"?t:String(t);return u.replace(/^# (.*$)/gim,'<h1 style="font-size: 24px; margin-bottom: 16px; color: #1677ff;">$1</h1>').replace(/^## (.*$)/gim,'<h2 style="font-size: 20px; margin: 16px 0 8px; color: #333;">$1</h2>').replace(/^### (.*$)/gim,'<h3 style="font-size: 18px; margin: 14px 0 6px; color: #333;">$1</h3>').replace(/\n- (.*$)/gim,'<div style="margin: 4px 0;"><span style="display: inline-block; margin-right: 8px;">\u2022</span>$1</div>').replace(/\n([0-9]+)\. (.*$)/gim,'<div style="margin: 4px 0;"><span style="display: inline-block; margin-right: 8px; min-width: 16px;">$1.</span>$2</div>').replace(/\n/gim,"<br/>")}catch(l){return console.error("Markdown\u8F6C\u6362\u9519\u8BEF:",l),typeof t=="string"?t:"\u65E0\u6CD5\u663E\u793A\u5185\u5BB9"}};return(0,e.jsxs)("div",{style:{background:"#f5f5f5",padding:"24px"},children:[(0,e.jsxs)(ve.Z,{title:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[(0,e.jsx)("span",{children:"\u{1F680} AI\u5468\u62A5\u52A9\u624B"}),(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(B.Z,{}),onClick:bn,loading:ae,children:"\u751F\u6210\u5468\u62A5"}),(0,e.jsx)(o.ZP,{icon:(0,e.jsx)(en.Z,{}),onClick:function(){return _t(!0)},disabled:rt.length===0,children:"\u5386\u53F2\u5468\u62A5"}),(0,e.jsx)(o.ZP,{icon:(0,e.jsx)(tn.Z,{}),onClick:Bt,children:"AI\u8BBE\u7F6E"}),(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(L.Z,{}),onClick:function(){return st()},children:"\u6DFB\u52A0\u5DE5\u4F5C\u5185\u5BB9"})]})]}),children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,flexDirection:F?"column":"row",gap:F?"12px":"0"},children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(nn.Z,{}),(0,e.jsxs)(hn,{strong:!0,style:{marginLeft:8},children:["\u5F53\u524D\u5468: ",Vt().formatted]})]}),(0,e.jsx)(ye.default,{picker:"week",value:Re,onChange:function(t){return t&&Qe(t)},locale:ot.Z})]}),(0,e.jsxs)(Ne.Z,{gutter:16,style:{marginBottom:16},children:[(0,e.jsx)(Te.Z,{xs:24,md:12,children:(0,e.jsx)(O.Z,{placeholder:"\u8F93\u5165\u5F85\u529E\u4E8B\u9879\u6309\u56DE\u8F66\u5FEB\u901F\u6DFB\u52A0",value:Ee,onChange:function(t){return Ge(t.target.value)},onPressEnter:$t,suffix:(0,e.jsx)(o.ZP,{type:"primary",size:"small",onClick:$t,disabled:Ee.trim()==="",children:"\u6DFB\u52A0"})})}),(0,e.jsx)(Te.Z,{xs:24,md:12,children:(0,e.jsx)(vn,{placeholder:"\u641C\u7D22\u5DE5\u4F5C",allowClear:!0,enterButton:!0,value:Ye,onChange:function(t){return ut(t.target.value)},onSearch:function(t){return ut(t)},style:{width:"100%"}})})]}),(0,e.jsx)("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(un.Z,{}),(0,e.jsxs)($.ZP.Group,{value:Q,onChange:function(t){return qe(t.target.value)},optionType:"button",buttonStyle:"solid",size:"small",children:[(0,e.jsx)($.ZP.Button,{value:"all",children:"\u5168\u90E8"}),(0,e.jsx)($.ZP.Button,{value:"pending",children:"\u8FDB\u884C\u4E2D"}),(0,e.jsx)($.ZP.Button,{value:"completed",children:"\u5DF2\u5B8C\u6210"})]})]})}),(0,e.jsx)(me.Z,{defaultActiveKey:"currentWeek",items:[{key:"currentWeek",label:"\u672C\u5468\u5DE5\u4F5C",children:Rn(Ut(),"\u672C\u5468\u6682\u65E0\u5DE5\u4F5C\u5185\u5BB9")}]})]}),(0,e.jsx)(ee.Z,{title:(0,e.jsx)(e.Fragment,{children:ge?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(re.Z,{})," \u7F16\u8F91\u5DE5\u4F5C"]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L.Z,{})," \u6DFB\u52A0\u65B0\u5DE5\u4F5C"]})}),open:ht,onCancel:function(){return G(!1)},footer:null,width:700,children:(0,e.jsxs)(h.Z,{form:xe,layout:"vertical",onFinish:Pn,initialValues:{priority:"medium",startDateTime:S()(),endDateTime:S()().add(1,"day")},children:[(0,e.jsx)(h.Z.Item,{name:"title",label:"\u5DE5\u4F5C\u6807\u9898",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6807\u9898"}],children:(0,e.jsx)(O.Z,{placeholder:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6807\u9898",maxLength:50})}),(0,e.jsx)(h.Z.Item,{name:"description",label:"\u5DE5\u4F5C\u63CF\u8FF0",children:(0,e.jsx)(Fn,{placeholder:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u63CF\u8FF0\uFF08\u9009\u586B\uFF09",autoSize:{minRows:3,maxRows:6},maxLength:200})}),(0,e.jsx)(h.Z.Item,{name:"startDateTime",label:"\u5F00\u59CB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4"}],children:(0,e.jsx)(ye.default,{style:{width:"100%"},locale:ot.Z,showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",allowClear:!1})}),(0,e.jsx)(h.Z.Item,{name:"endDateTime",label:"\u622A\u6B62\u65F6\u95F4",children:(0,e.jsx)(ye.default,{style:{width:"100%"},locale:ot.Z,showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"})}),(0,e.jsx)(h.Z.Item,{name:"priority",label:"\u4F18\u5148\u7EA7",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4F18\u5148\u7EA7"}],children:(0,e.jsxs)(w.Z,{placeholder:"\u8BF7\u9009\u62E9\u4F18\u5148\u7EA7",children:[(0,e.jsx)(dt,{value:"high",children:(0,e.jsxs)(_.Z,{children:[(0,e.jsxs)("span",{children:[W.high.emoji," \u9AD8\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:W.high.color,children:"\u7D27\u6025"})]})}),(0,e.jsx)(dt,{value:"medium",children:(0,e.jsxs)(_.Z,{children:[(0,e.jsxs)("span",{children:[W.medium.emoji," \u4E2D\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:W.medium.color,children:"\u91CD\u8981"})]})}),(0,e.jsx)(dt,{value:"low",children:(0,e.jsxs)(_.Z,{children:[(0,e.jsxs)("span",{children:[W.low.emoji," \u4F4E\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:W.low.color,children:"\u666E\u901A"})]})})]})}),(0,e.jsx)(h.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,e.jsxs)(_.Z,{children:[(0,e.jsx)(o.ZP,{onClick:function(){return G(!1)},children:"\u53D6\u6D88"}),(0,e.jsx)(o.ZP,{type:"primary",htmlType:"submit",children:ge?"\u66F4\u65B0":"\u6DFB\u52A0"})]})})]})}),(0,e.jsx)(te.Z,{title:"\u5DE5\u4F5C\u8BE6\u60C5",placement:"right",onClose:He,open:ie,width:F?"100%":500,extra:(0,e.jsx)(_.Z,{children:(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(re.Z,{}),onClick:function(){He(),v&&st(v)},children:"\u7F16\u8F91"})}),children:v&&(0,e.jsxs)("div",{children:[(0,e.jsxs)(H.Z,{bordered:!0,column:1,children:[(0,e.jsx)(H.Z.Item,{label:"\u5DE5\u4F5C\u6807\u9898",labelStyle:{fontWeight:"bold"},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,e.jsx)("span",{style:{fontSize:"18px"},children:v.status==="completed"?je.completed.icon:W[v.priority].emoji}),v.title]})}),(0,e.jsx)(H.Z.Item,{label:"\u4F18\u5148\u7EA7",labelStyle:{fontWeight:"bold"},children:(0,e.jsxs)(K.Z,{color:W[v.priority].color,children:[W[v.priority].text,"\u4F18\u5148\u7EA7"]})}),(0,e.jsx)(H.Z.Item,{label:"\u5DE5\u4F5C\u72B6\u6001",labelStyle:{fontWeight:"bold"},children:(0,e.jsx)(K.Z,{color:je[v.status].color,children:je[v.status].text})}),(0,e.jsxs)(H.Z.Item,{label:"\u5F00\u59CB\u65F6\u95F4",labelStyle:{fontWeight:"bold"},children:[S()(v.startDate).format("YYYY\u5E74MM\u6708DD\u65E5")," ",v.startTime||"00:00:00"]}),v.endDate&&(0,e.jsxs)(H.Z.Item,{label:"\u622A\u6B62\u65F6\u95F4",labelStyle:{fontWeight:"bold"},children:[S()(v.endDate).format("YYYY\u5E74MM\u6708DD\u65E5")," ",v.endTime||"23:59:59"]}),v.description&&(0,e.jsx)(H.Z.Item,{label:"\u5DE5\u4F5C\u63CF\u8FF0",labelStyle:{fontWeight:"bold"},children:(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:v.description})})]}),(0,e.jsx)(ne.Z,{}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[v.status==="pending"?(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(N.Z,{}),onClick:function(){Gt(v.id),He()},children:"\u6807\u8BB0\u4E3A\u5DF2\u5B8C\u6210"}):(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(at.Z,{}),onClick:function(){Qt(v.id),He()},children:"\u6807\u8BB0\u4E3A\u8FDB\u884C\u4E2D"}),(0,e.jsx)(o.ZP,{danger:!0,icon:(0,e.jsx)(s.Z,{}),onClick:function(){Xt(v.id),He()},children:"\u5220\u9664\u5DE5\u4F5C"})]})]})}),(0,e.jsx)(pn,{visible:p,onClose:Sn,settings:{modelKey:y.modelKey,prompt:y.prompt||mt,template:y.template||pt,variables:y.variables||[]},onSave:Bn}),(0,e.jsx)(ee.Z,{title:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(B.Z,{style:{marginRight:8}}),(0,e.jsx)("span",{children:ae?"AI\u6B63\u5728\u751F\u6210\u5468\u62A5...":"AI\u751F\u6210\u7684\u5468\u62A5"})]}),open:xn,onCancel:function(){ae?ee.Z.confirm({title:"\u786E\u8BA4\u53D6\u6D88\u751F\u6210?",content:"\u5468\u62A5\u6B63\u5728\u751F\u6210\u4E2D\uFF0C\u53D6\u6D88\u5C06\u7EC8\u6B62\u751F\u6210\u8FC7\u7A0B\u3002",onOk:function(){St(),De(!1),d.ZP.info("\u5DF2\u53D6\u6D88\u751F\u6210")}}):De(!1)},footer:[(0,e.jsx)(o.ZP,{onClick:function(){ae?ee.Z.confirm({title:"\u786E\u8BA4\u53D6\u6D88\u751F\u6210?",content:"\u5468\u62A5\u6B63\u5728\u751F\u6210\u4E2D\uFF0C\u53D6\u6D88\u5C06\u7EC8\u6B62\u751F\u6210\u8FC7\u7A0B\u3002",onOk:function(){St(),De(!1),d.ZP.info("\u5DF2\u53D6\u6D88\u751F\u6210")}}):De(!1)},children:ae?"\u53D6\u6D88\u751F\u6210":"\u5173\u95ED"},"close"),(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(rn.Z,{}),onClick:Tn,disabled:!oe||ae,children:"\u590D\u5236\u5185\u5BB9"},"copy")],width:700,maskClosable:!ae,closable:!ae,children:oe?(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap",padding:"16px",borderRadius:"4px",border:"1px solid #e8e8e8",maxHeight:"60vh",overflow:"auto",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, sans-serif'},dangerouslySetInnerHTML:{__html:Yn(oe)}}):(0,e.jsxs)("div",{style:{textAlign:"center",padding:"40px 0"},children:[(0,e.jsx)(ue.Z,{size:"large"}),(0,e.jsx)("p",{style:{marginTop:16},children:"AI\u6B63\u5728\u601D\u8003\u5E76\u751F\u6210\u5468\u62A5..."}),(0,e.jsx)("p",{style:{color:"#888",fontSize:"14px"},children:"\u6839\u636E\u5DE5\u4F5C\u5185\u5BB9\u751F\u6210\u9AD8\u8D28\u91CF\u5468\u62A5\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85"})]})}),(0,e.jsx)(te.Z,{title:"\u5386\u53F2\u5468\u62A5",placement:"right",onClose:function(){return _t(!1)},open:_n,width:400,children:(0,e.jsx)(U.Z,{itemLayout:"horizontal",dataSource:rt,renderItem:function(t){return(0,e.jsx)(U.Z.Item,{actions:[(0,e.jsx)(o.ZP,{type:"link",onClick:function(){return Zn(t)},children:"\u67E5\u770B"},"view"),(0,e.jsx)(o.ZP,{type:"link",danger:!0,onClick:function(){return Wn(t.id)},children:"\u5220\u9664"},"delete")],children:(0,e.jsx)(U.Z.Item.Meta,{title:t.title,description:t.date})})}})})]})}},24029:function(Tt,he,n){n.d(he,{l:function(){return m},p:function(){return V}});var Se=n(57566),C=n.n(Se),be=n(84136),J=n.n(be),Ze=n(52487),Z=n.n(Ze),Fe=n(82257);function V(M){return ce.apply(this,arguments)}function ce(){return ce=Z()(C()().mark(function M(R){return C()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",(0,Fe.request)("/api/todo/get",J()({method:"POST"},R||{})));case 1:case"end":return w.stop()}},M)})),ce.apply(this,arguments)}function m(M,R){return i.apply(this,arguments)}function i(){return i=Z()(C()().mark(function M(R,O){return C()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",(0,Fe.request)("/api/todo/save",J()({method:"POST",headers:{"Content-Type":"application/json"},data:R},O||{})));case 1:case"end":return h.stop()}},M)})),i.apply(this,arguments)}}}]);
