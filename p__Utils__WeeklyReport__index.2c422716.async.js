"use strict";(self.webpackChunkreact_frontend_init=self.webpackChunkreact_frontend_init||[]).push([[1903],{80825:function(bt,fe,u){var Se=u(95688),D=u.n(Se),_e=u(63894),U=u.n(_e),Te=u(76069),T=u.n(Te),Fe=u(95111),$=u.n(Fe),ce=u(7790),m=u.n(ce),a=u(43352),O=u.n(a),R=u(61710),k=u.n(R),w=u(52138),f=function(){function d(q){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];$()(this,d),O()(this,"modelConfig",void 0),O()(this,"messages",void 0),O()(this,"client",null),O()(this,"abortController",null),this.modelConfig=q,this.messages=o,this.initClient()}return m()(d,[{key:"initClient",value:function(){this.modelConfig.accessKey&&(this.client=new w.ZP({apiKey:this.modelConfig.accessKey,baseURL:this.modelConfig.apiEndpoint,dangerouslyAllowBrowser:!0}))}},{key:"sendMessage",value:function(){var q=T()(D()().mark(function N(K,ye,B){var ve,ze,be,G,me,ee,te,H,ue,re,L,Ie,ne,z;return D()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(this.abortController&&this.abortController.abort(),this.abortController=new AbortController,s.prev=2,this.client){s.next=7;break}if(this.initClient(),this.client){s.next=7;break}throw new Error("OpenAI\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5API\u5BC6\u94A5");case 7:return ve=this.messages.filter(function(Z){return Z.role==="user"||Z.role==="assistant"||Z.role==="system"}).map(function(Z){return{role:Z.role,content:Z.content}}),ze=this.modelConfig.modelType||this.modelConfig.key,s.next=11,this.client.chat.completions.create({model:ze,messages:[].concat(U()(ve),[{role:"user",content:K}]),stream:!0,temperature:.7,tools:ye?[{type:"function",function:{name:"search",description:"Search the web for information",parameters:{type:"object",properties:{query:{type:"string",description:"The search query"}},required:["query"]}}}]:void 0},{signal:this.abortController.signal});case 11:be=s.sent,G=!1,me=!1,s.prev=14,te=k()(be);case 16:return s.next=18,te.next();case 18:if(!(G=!(H=s.sent).done)){s.next=33;break}if(ue=H.value,Ie=((re=ue.choices[0])===null||re===void 0||(re=re.delta)===null||re===void 0?void 0:re.content)||"",ne=((L=ue.choices[0])===null||L===void 0||(L=L.delta)===null||L===void 0?void 0:L.reasoning_content)||"",!Ie){s.next=26;break}return B.onMessage(Ie),s.next=26,new Promise(function(Z){return setTimeout(Z,5)});case 26:if(!(ne&&B.onReasoningProcess)){s.next=30;break}return B.onReasoningProcess(ne),s.next=30,new Promise(function(Z){return setTimeout(Z,5)});case 30:G=!1,s.next=16;break;case 33:s.next=39;break;case 35:s.prev=35,s.t0=s.catch(14),me=!0,ee=s.t0;case 39:if(s.prev=39,s.prev=40,!(G&&te.return!=null)){s.next=44;break}return s.next=44,te.return();case 44:if(s.prev=44,!me){s.next=47;break}throw ee;case 47:return s.finish(44);case 48:return s.finish(39);case 49:B.onComplete(),s.next=55;break;case 52:if(s.prev=52,s.t1=s.catch(2),s.t1.name!=="AbortError"){console.error("AI\u8BF7\u6C42\u9519\u8BEF:",s.t1),z="";try{s.t1.response&&s.t1.response.data?z=JSON.stringify(s.t1.response.data,null,2):s.t1.message?z=s.t1.message:typeof s.t1=="string"?z=s.t1:z=JSON.stringify(s.t1,null,2)}catch(Z){z="\u672A\u80FD\u89E3\u6790\u9519\u8BEF\u8BE6\u60C5"}B.onError(z||"\u8BF7\u6C42\u5931\u8D25")}case 55:return s.prev=55,this.abortController=null,s.finish(55);case 58:case"end":return s.stop()}},N,this,[[2,52,55,58],[14,35,39,49],[40,,44,48]])}));function o(N,K,ye){return q.apply(this,arguments)}return o}()},{key:"cancel",value:function(){this.abortController&&(this.abortController.abort(),this.abortController=null)}}]),d}();fe.Z=f},68353:function(bt,fe,u){u.r(fe),u.d(fe,{default:function(){return vu}});var Se=u(95688),D=u.n(Se),_e=u(63894),U=u.n(_e),Te=u(79810),T=u.n(Te),Fe=u(76069),$=u.n(Fe),ce=u(52419),m=u.n(ce),a=u(67294),O=u(26058),R=u(71471),k=u(55102),w=u(34041),f=u(47019),d=u(68872),q=u(32983),o=u(83622),N=u(2487),K=u(66309),ye=u(4393),B=u(78957),ve=u(42392),ze=u(71230),be=u(15746),G=u(55742),me=u(11941),ee=u(17788),te=u(85265),H=u(26412),ue=u(96074),re=u(74330),L=u(51042),Ie=u(55287),ne=u(47389),z=u(88284),it=u(71965),s=u(82061),Z=u(50228),eu=u(13923),tu=u(31776),uu=u(97302),ru=u(19669),nu=u(45098),su=u(13860),S=u.n(su),Lu=u(33852),ot=u(72224),au=u(59542),iu=u.n(au),It=u(53579),Ve=u(38925),ou=u(96068),Pt=u(77123),lu=u(52926),e=u(85893),du=w.Z.Option,Mt=k.Z.TextArea,Ku=R.Z.Title,Ue=R.Z.Text,Ot=R.Z.Paragraph,lt=me.Z.TabPane,kt=function(){try{var P=localStorage.getItem("ai-agent-models");if(P)return JSON.parse(P)}catch(x){console.error("\u89E3\u6790AI\u6A21\u578B\u914D\u7F6E\u5931\u8D25:",x)}return[]},Rt=function(P){var x=kt(),g=x.find(function(E){return E.key===P});return!!(g&&g.accessKey)},wt=[{title:"\u793A\u4F8B1: \u57FA\u7840\u4F18\u5316",content:"\u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u5DE5\u4F5C\u5468\u62A5\u52A9\u624B\uFF0C\u8BF7\u5E2E\u6211\u4F18\u5316\u4EE5\u4E0B\u5468\u62A5\u5185\u5BB9\uFF0C\u4F7F\u5176\u66F4\u52A0\u4E13\u4E1A\u548C\u6709\u6761\u7406\u3002\u4FDD\u6301\u539F\u6709\u7684\u6570\u636E\u51C6\u786E\u6027\uFF0C\u4F46\u53EF\u4EE5\u4F18\u5316\u8868\u8FF0\u65B9\u5F0F\u548C\u7ED3\u6784\u3002"},{title:"\u793A\u4F8B2: \u8BE6\u7EC6\u4F18\u5316",content:`\u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u5DE5\u4F5C\u5468\u62A5\u52A9\u624B\uFF0C\u8BF7\u6839\u636E\u4EE5\u4E0B\u5185\u5BB9\u751F\u6210\u4E00\u4EFD\u4E13\u4E1A\u7684\u5468\u62A5\uFF1A
1. \u9488\u5BF9\u672C\u5468\u5DE5\u4F5C\u5185\u5BB9\uFF0C\u8BF7\u63D0\u70BC\u91CD\u70B9\uFF0C\u6309\u91CD\u8981\u6027\u6392\u5E8F\uFF0C\u5E76\u4F7F\u7528\u4E13\u4E1A\u672F\u8BED\u6539\u5199
2. \u5728\u5DE5\u4F5C\u4EAE\u70B9\u90E8\u5206\uFF0C\u5F3A\u8C03\u6210\u679C\u548C\u5F71\u54CD\uFF0C\u4F7F\u7528\u6570\u636E\u652F\u6301\uFF08\u5982\u6709\uFF09
3. \u5BF9\u4E8E\u4E0B\u5468\u8BA1\u5212\uFF0C\u8BF7\u786E\u4FDD\u6761\u7406\u6E05\u6670\uFF0C\u6709\u660E\u786E\u7684\u65F6\u95F4\u8282\u70B9
4. \u95EE\u9898\u4E0E\u5EFA\u8BAE\u90E8\u5206\uFF0C\u5E94\u63D0\u4F9B\u5177\u4F53\u3001\u53EF\u884C\u7684\u89E3\u51B3\u65B9\u6848`}],Wt=[{title:"\u6807\u51C6\u5468\u62A5\u6A21\u677F",content:`
### \u672C\u5468\u5DE5\u4F5C\u603B\u7ED3
-
### \u5DE5\u4F5C\u4EAE\u70B9
- 
### \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212
- 
### \u95EE\u9898\u4E0E\u5EFA\u8BAE
- `}],Yt={fontFamily:"monospace",fontSize:"14px"},cu=function(P){var x=P.visible,g=P.onClose,E=P.settings,se=P.onSave,ht=f.Z.useForm(),$e=m()(ht,1),V=$e[0],Ne=f.Z.useForm(),ft=m()(Ne,1),J=ft[0],Ft=(0,a.useState)([]),Me=m()(Ft,2),Ee=Me[0],Ge=Me[1],yt=(0,a.useState)("model"),Oe=m()(yt,2),ge=Oe[0],Je=Oe[1],vt=(0,a.useState)(!1),ke=m()(vt,2),Re=ke[0],Qe=ke[1],xt=(0,a.useState)(!1),Xe=m()(xt,2),Ce=Xe[0],F=Xe[1],Et=(0,a.useState)(null),we=m()(Et,2),Q=we[0],qe=we[1],gt=(0,a.useState)([]),We=m()(gt,2),ae=We[0],pe=We[1];(0,a.useEffect)(function(){var i=kt();Ge(i),E.modelKey&&Qe(Rt(E.modelKey))},[E.modelKey,x]),(0,a.useEffect)(function(){x&&(V.setFieldsValue({modelKey:E.modelKey,prompt:E.prompt,template:E.template}),pe(E.variables||[]))},[x,V,E]);var et=function(){d.ZP.info("\u6B63\u5728\u8DF3\u8F6C\u5230AI\u667A\u80FD\u4F53\u8BBE\u7F6E\u9875\u9762..."),lu.history.push("/utils/ai-agent"),g()},tt=function(p){Qe(Rt(p))},y=function(p){p?(qe(p),J.setFieldsValue(p)):(qe(null),J.resetFields()),F(!0)},De=function(){var i=$()(D()().mark(function p(){var C,X;return D()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,J.validateFields();case 3:if(C=v.sent,!Q){v.next=9;break}X=ae.map(function(he){return he.key===Q.key?C:he}),pe(X),v.next=13;break;case 9:if(!ae.some(function(he){return he.key===C.key})){v.next=12;break}return d.ZP.error("\u53D8\u91CF ".concat(C.key," \u5DF2\u5B58\u5728")),v.abrupt("return");case 12:pe([].concat(U()(ae),[C]));case 13:F(!1),d.ZP.success("".concat(Q?"\u66F4\u65B0":"\u6DFB\u52A0","\u53D8\u91CF\u6210\u529F")),v.next=20;break;case 17:v.prev=17,v.t0=v.catch(0),console.error("\u53D8\u91CF\u8868\u5355\u9A8C\u8BC1\u5931\u8D25:",v.t0);case 20:case"end":return v.stop()}},p,null,[[0,17]])}));return function(){return i.apply(this,arguments)}}(),Ct=function(p){var C=ae.filter(function(X){return X.key!==p});pe(C),d.ZP.success("\u5220\u9664\u53D8\u91CF\u6210\u529F")},ut=function(){var i=$()(D()().mark(function p(){var C;return D()().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,V.validateFields();case 3:C=b.sent,se({modelKey:C.modelKey,prompt:C.prompt,template:C.template,variables:ae}),d.ZP.success("AI\u6A21\u677F\u8BBE\u7F6E\u5DF2\u4FDD\u5B58"),g(),b.next=12;break;case 9:b.prev=9,b.t0=b.catch(0),console.error("\u8868\u5355\u9A8C\u8BC1\u5931\u8D25:",b.t0);case 12:case"end":return b.stop()}},p,null,[[0,9]])}));return function(){return i.apply(this,arguments)}}(),Ye=function(p){V.setFieldsValue({prompt:p}),d.ZP.success("\u5DF2\u5E94\u7528\u793A\u4F8B\u63D0\u793A\u8BCD")},rt=function(p){V.setFieldsValue({template:p}),d.ZP.success("\u5DF2\u5E94\u7528\u793A\u4F8B\u6A21\u677F")},Dt=[{title:"\u53D8\u91CF\u540D",dataIndex:"key",key:"key",render:function(p){return"{".concat(p,"}")}},{title:"\u63CF\u8FF0",dataIndex:"description",key:"description"},{title:"\u9ED8\u8BA4\u503C",dataIndex:"value",key:"value",render:function(p){return p||"(\u7A7A)"}},{title:"\u64CD\u4F5C",key:"action",render:function(p,C){return(0,e.jsxs)(B.Z,{size:"small",children:[(0,e.jsx)(o.ZP,{type:"text",icon:(0,e.jsx)(ne.Z,{}),onClick:function(){return y(C)}}),(0,e.jsx)(o.ZP,{type:"text",danger:!0,icon:(0,e.jsx)(s.Z,{}),onClick:function(){return Ct(C.key)}})]})}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(te.Z,{title:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Z.Z,{style:{marginRight:8}}),(0,e.jsx)("span",{children:"\u5468\u62A5AI\u6A21\u677F\u8BBE\u7F6E"})]}),width:700,placement:"right",onClose:g,open:x,footer:(0,e.jsx)("div",{style:{textAlign:"right"},children:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(o.ZP,{onClick:g,children:"\u53D6\u6D88"}),(0,e.jsx)(o.ZP,{type:"primary",onClick:ut,children:"\u4FDD\u5B58\u8BBE\u7F6E"})]})}),children:(0,e.jsxs)(me.Z,{activeKey:ge,onChange:Je,children:[(0,e.jsx)(lt,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Z.Z,{}),"AI\u6A21\u578B"]}),children:(0,e.jsxs)(f.Z,{form:V,layout:"vertical",initialValues:{modelKey:E.modelKey,prompt:E.prompt,template:E.template},children:[(0,e.jsx)(f.Z.Item,{name:"modelKey",label:"\u9009\u62E9AI\u6A21\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9AI\u6A21\u578B"}],tooltip:"\u9009\u62E9\u7528\u4E8E\u751F\u6210\u5468\u62A5\u7684AI\u6A21\u578B\uFF0C\u786E\u4FDD\u5DF2\u8BBE\u7F6EAPI\u5BC6\u94A5",children:(0,e.jsx)(w.Z,{placeholder:"\u8BF7\u9009\u62E9AI\u6A21\u578B",onChange:tt,optionLabelProp:"label",dropdownMatchSelectWidth:!1,style:{width:"100%"},children:Ee.map(function(i){return(0,e.jsx)(du,{value:i.key,label:"".concat(i.icon," ").concat(i.name),children:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)("span",{children:i.icon}),(0,e.jsx)("span",{children:i.name}),(0,e.jsxs)(Ue,{type:"secondary",style:{fontSize:"12px"},children:["(",i.provider,")"]})]})},i.key)})})}),!Re&&(0,e.jsx)(Ve.Z,{message:"\u6A21\u578B\u914D\u7F6E\u4E0D\u5B8C\u6574",description:(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:"\u6240\u9009\u6A21\u578B\u5C1A\u672A\u914D\u7F6EAPI\u5BC6\u94A5\uFF0C\u8BF7\u524D\u5F80AI\u667A\u80FD\u4F53\u8BBE\u7F6E\u5BC6\u94A5\u3002"}),(0,e.jsx)(o.ZP,{type:"primary",onClick:et,children:"\u524D\u5F80\u8BBE\u7F6E"})]}),type:"warning",showIcon:!0,style:{marginBottom:16}}),Ee.length===0&&(0,e.jsx)(Ve.Z,{message:"\u672A\u627E\u5230AI\u6A21\u578B",description:(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{children:"\u7CFB\u7EDF\u4E2D\u672A\u914D\u7F6E\u4EFB\u4F55AI\u6A21\u578B\uFF0C\u8BF7\u524D\u5F80AI\u667A\u80FD\u4F53\u6DFB\u52A0\u548C\u914D\u7F6E\u6A21\u578B\u3002"}),(0,e.jsx)(o.ZP,{type:"primary",onClick:et,children:"\u524D\u5F80\u8BBE\u7F6E"})]}),type:"error",showIcon:!0})]})},"model"),(0,e.jsx)(lt,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Pt.Z,{}),"AI\u63D0\u793A\u8BCD"]}),children:(0,e.jsxs)(f.Z,{form:V,layout:"vertical",initialValues:{modelKey:E.modelKey,prompt:E.prompt,template:E.template},children:[(0,e.jsx)(Ve.Z,{message:"\u63D0\u793A\u8BCD\u8BF4\u660E",description:"\u8BBE\u7F6E\u7ED9AI\u7684\u63D0\u793A\u8BCD\uFF0C\u544A\u8BC9AI\u5982\u4F55\u5904\u7406\u5468\u62A5\u6A21\u677F\u3002\u63D0\u793A\u8BCD\u5E94\u8BE5\u6E05\u6670\u8BF4\u660EAI\u9700\u8981\u505A\u4EC0\u4E48\u3002",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,e.jsx)(f.Z.Item,{name:"prompt",label:"AI\u63D0\u793A\u8BCD",rules:[{required:!0,message:"\u8BF7\u8F93\u5165AI\u63D0\u793A\u8BCD"}],tooltip:"\u8BBE\u7F6E\u751F\u6210\u5468\u62A5\u65F6\u7ED9AI\u7684\u6307\u4EE4",children:(0,e.jsx)(Mt,{rows:10,placeholder:"\u8BF7\u8F93\u5165AI\u63D0\u793A\u8BCD\uFF0C\u544A\u8BC9AI\u5982\u4F55\u5904\u7406\u5468\u62A5\u6A21\u677F",style:Yt,autoSize:{minRows:10,maxRows:20}})}),(0,e.jsxs)("div",{style:{marginBottom:16},children:[(0,e.jsx)(ue.Z,{orientation:"left",children:"\u63D0\u793A\u8BCD\u793A\u4F8B"}),wt.map(function(i,p){return(0,e.jsxs)(ye.Z,{size:"small",style:{marginBottom:p<wt.length-1?16:0},extra:(0,e.jsx)(o.ZP,{type:"link",size:"small",onClick:function(){return Ye(i.content)},children:"\u5E94\u7528\u6B64\u793A\u4F8B"}),children:[(0,e.jsx)(Ue,{strong:!0,children:i.title}),(0,e.jsx)(Ot,{style:{color:"#666",whiteSpace:"pre-wrap"},children:i.content})]},p)})]})]})},"prompt"),(0,e.jsx)(lt,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Pt.Z,{}),"\u5468\u62A5\u6A21\u677F"]}),children:(0,e.jsxs)(f.Z,{form:V,layout:"vertical",initialValues:{modelKey:E.modelKey,prompt:E.prompt,template:E.template},children:[(0,e.jsx)(Ve.Z,{message:"\u6A21\u677F\u8BF4\u660E",description:"\u60A8\u53EF\u4EE5\u8BBE\u7F6E\u5468\u62A5\u7684\u57FA\u672C\u6A21\u677F\uFF0C\u4F7F\u7528 {\u53D8\u91CF\u540D} \u4F5C\u4E3A\u5360\u4F4D\u7B26\uFF0C\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u66FF\u6362\u4E3A\u5BF9\u5E94\u5185\u5BB9\u3002",type:"info",showIcon:!0,style:{marginBottom:16}}),(0,e.jsx)(f.Z.Item,{name:"template",label:"\u5468\u62A5\u6A21\u677F",tooltip:"\u8BBE\u7F6E\u5468\u62A5\u7684\u57FA\u672C\u6A21\u677F\u7ED3\u6784\uFF0C\u4F7F\u7528 {\u53D8\u91CF\u540D} \u4F5C\u4E3A\u5360\u4F4D\u7B26",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5468\u62A5\u6A21\u677F"}],children:(0,e.jsx)(Mt,{rows:10,placeholder:"\u8BF7\u8F93\u5165\u5468\u62A5\u6A21\u677F\uFF0C\u4F7F\u7528 {\u53D8\u91CF\u540D} \u683C\u5F0F\u5F15\u7528\u53D8\u91CF",style:Yt,autoSize:{minRows:10,maxRows:20}})}),(0,e.jsxs)("div",{style:{marginBottom:16},children:[(0,e.jsx)(ue.Z,{orientation:"left",children:"\u6A21\u677F\u793A\u4F8B"}),Wt.map(function(i,p){return(0,e.jsxs)(ye.Z,{size:"small",style:{marginBottom:p<Wt.length-1?16:0},extra:(0,e.jsx)(o.ZP,{type:"link",size:"small",onClick:function(){return rt(i.content)},children:"\u5E94\u7528\u6B64\u6A21\u677F"}),children:[(0,e.jsx)(Ue,{strong:!0,children:i.title}),(0,e.jsx)(Ot,{style:{color:"#666",whiteSpace:"pre-wrap"},children:i.content})]},p)})]}),(0,e.jsx)(ue.Z,{orientation:"left",children:"\u53D8\u91CF\u7BA1\u7406"}),(0,e.jsxs)("div",{style:{marginBottom:16,display:"flex",justifyContent:"space-between"},children:[(0,e.jsxs)(Ue,{type:"secondary",children:["\u5728\u6A21\u677F\u4E2D\u4F7F\u7528 ","{\u53D8\u91CF\u540D}"," \u683C\u5F0F\u5F15\u7528\u53D8\u91CF\uFF0C\u7CFB\u7EDF\u4F1A\u81EA\u52A8\u66FF\u6362\u4E3A\u5BF9\u5E94\u5185\u5BB9"]}),(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(L.Z,{}),onClick:function(){return y()},children:"\u6DFB\u52A0\u53D8\u91CF"})]}),(0,e.jsx)(ou.Z,{dataSource:ae,columns:Dt,rowKey:"key",pagination:!1,size:"small"})]})},"template")]})}),(0,e.jsx)(ee.Z,{title:"".concat(Q?"\u7F16\u8F91":"\u6DFB\u52A0","\u53D8\u91CF"),open:Ce,onCancel:function(){return F(!1)},onOk:De,children:(0,e.jsxs)(f.Z,{form:J,layout:"vertical",children:[(0,e.jsx)(f.Z.Item,{name:"key",label:"\u53D8\u91CF\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D"},{pattern:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"\u53D8\u91CF\u540D\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF0C\u4E14\u5FC5\u987B\u4EE5\u5B57\u6BCD\u5F00\u5934"}],tooltip:"\u53D8\u91CF\u540D\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u3001\u6570\u5B57\u548C\u4E0B\u5212\u7EBF\uFF0C\u4E14\u5FC5\u987B\u4EE5\u5B57\u6BCD\u5F00\u5934",children:(0,e.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u540D\uFF0C\u5982 userName",disabled:!!Q})}),(0,e.jsx)(f.Z.Item,{name:"description",label:"\u63CF\u8FF0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u53D8\u91CF\u63CF\u8FF0"}],children:(0,e.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u63CF\u8FF0\uFF0C\u5982 \u7528\u6237\u59D3\u540D"})}),(0,e.jsx)(f.Z.Item,{name:"value",label:"\u9ED8\u8BA4\u503C",children:(0,e.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165\u53D8\u91CF\u9ED8\u8BA4\u503C\uFF08\u53EF\u9009\uFF09"})})]})})]})},mu=cu,pu=u(80825);S().extend(iu());var Hu=O.Z.Header,zu=O.Z.Content,Vu=R.Z.Title,hu=R.Z.Text,fu=k.Z.TextArea,dt=w.Z.Option,Fu=k.Z.Search,W={high:{color:"red",emoji:"\u{1F525}",text:"\u9AD8"},medium:{color:"orange",emoji:"\u26A1",text:"\u4E2D"},low:{color:"blue",emoji:"\u{1F331}",text:"\u4F4E"}},xe={pending:{text:"\u5F85\u5B8C\u6210",color:"processing",icon:"\u26A1\uFE0F"},completed:{text:"\u5DF2\u5B8C\u6210",color:"success",icon:"\u2705"}},yu=function(){var P=(0,a.useState)(!1),x=m()(P,2),g=x[0],E=x[1];return(0,a.useEffect)(function(){var se=function(){E(window.innerWidth<=768)};return se(),window.addEventListener("resize",se),function(){return window.removeEventListener("resize",se)}},[]),g},Lt="weekly-ai-template",ct="weekly-report-history",mt="\u4F60\u662F\u4E00\u4E2A\u4E13\u4E1A\u7684\u5DE5\u4F5C\u5468\u62A5\u52A9\u624B\uFF0C\u8BF7\u6839\u636E\u6211\u63D0\u4F9B\u7684\u5DE5\u4F5C\u5185\u5BB9\u548C\u5468\u62A5\u6A21\u677F\u5E2E\u6211\u751F\u6210\u5468\u62A5\u5185\u5BB9\uFF0C\u5185\u5BB9\u8981\u4E13\u4E1A\u548C\u6709\u6761\u7406\u3002\u4FDD\u6301\u539F\u6709\u7684\u6570\u636E\u51C6\u786E\u6027\uFF0C\u4F46\u53EF\u4EE5\u4F18\u5316\u8868\u8FF0\u65B9\u5F0F\u548C\u7ED3\u6784\u3002",pt=`
## \u672C\u5468\u5DE5\u4F5C\u603B\u7ED3
-
## \u5DE5\u4F5C\u4EAE\u70B9
- 
## \u4E0B\u5468\u5DE5\u4F5C\u8BA1\u5212
- 
## \u95EE\u9898\u4E0E\u5EFA\u8BAE
- 
`;function vu(){var Pe=(0,a.useState)([]),P=m()(Pe,2),x=P[0],g=P[1],E=(0,a.useState)(!0),se=m()(E,2),ht=se[0],$e=se[1],V=(0,a.useState)(!1),Ne=m()(V,2),ft=Ne[0],J=Ne[1],Ft=(0,a.useState)(!1),Me=m()(Ft,2),Ee=Me[0],Ge=Me[1],yt=(0,a.useState)(""),Oe=m()(yt,2),ge=Oe[0],Je=Oe[1],vt=(0,a.useState)(S()()),ke=m()(vt,2),Re=ke[0],Qe=ke[1],xt=f.Z.useForm(),Xe=m()(xt,1),Ce=Xe[0],F=yu(),Et=(0,a.useState)("all"),we=m()(Et,2),Q=we[0],qe=we[1],gt=(0,a.useState)(!1),We=m()(gt,2),ae=We[0],pe=We[1],et=(0,a.useState)(null),tt=m()(et,2),y=tt[0],De=tt[1],Ct=(0,a.useState)(""),ut=m()(Ct,2),Ye=ut[0],rt=ut[1],Dt=(0,a.useState)(!1),i=m()(Dt,2),p=i[0],C=i[1],X=(0,a.useState)({modelKey:"",prompt:mt,template:pt,variables:[{key:"userName",description:"\u7528\u6237\u59D3\u540D",value:"\u6211"},{key:"startDate",description:"\u5F00\u59CB\u65E5\u671F",value:""},{key:"endDate",description:"\u7ED3\u675F\u65E5\u671F",value:""},{key:"currentWeek",description:"\u5F53\u524D\u5468\u65E5\u671F\u8303\u56F4",value:""},{key:"thisWeekTasks",description:"\u672C\u5468\u5DE5\u4F5C\u5185\u5BB9",value:""}]}),b=m()(X,2),v=b[0],he=b[1],xu=(0,a.useState)(!1),Kt=m()(xu,2),ie=Kt[0],Le=Kt[1],Eu=(0,a.useState)(!1),Ht=m()(Eu,2),gu=Ht[0],je=Ht[1],Cu=(0,a.useState)(""),zt=m()(Cu,2),oe=zt[0],jt=zt[1],Du=(0,a.useState)([]),Vt=m()(Du,2),nt=Vt[0],At=Vt[1],ju=(0,a.useState)(!1),Ut=m()(ju,2),Au=Ut[0],Bt=Ut[1],Ke=(0,a.useRef)(null);(0,a.useEffect)(function(){var n=localStorage.getItem(Lt);if(n)try{var t=JSON.parse(n);t.variables||(t.variables=[{key:"userName",description:"\u7528\u6237\u59D3\u540D",value:"\u6211"},{key:"startDate",description:"\u5F00\u59CB\u65E5\u671F",value:""},{key:"endDate",description:"\u7ED3\u675F\u65E5\u671F",value:""},{key:"currentWeek",description:"\u5F53\u524D\u5468\u65E5\u671F\u8303\u56F4",value:""},{key:"thisWeekTasks",description:"\u672C\u5468\u5DE5\u4F5C\u5185\u5BB9",value:""}]),he(t)}catch(r){console.error("\u89E3\u6790AI\u6A21\u677F\u8BBE\u7F6E\u5931\u8D25:",r)}},[]),(0,a.useEffect)(function(){var n=localStorage.getItem(ct);if(n)try{var t=JSON.parse(n);Array.isArray(t)&&At(t)}catch(r){console.error("\u89E3\u6790\u5468\u62A5\u5386\u53F2\u8BB0\u5F55\u5931\u8D25:",r)}},[]);var Bu=function(t){he(t),localStorage.setItem(Lt,JSON.stringify(t))},Zt=function(){C(!0)},Zu=function(){C(!1)},St=function(){Ke.current&&(Ke.current.cancel(),Ke.current=null),Le(!1)},Su=function(){var n=$()(D()().mark(function t(){var r,l,c,A,Y,le,Ae,de,Be,Ze,_t,_,h,at,Tt;return D()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(v.modelKey){j.next=4;break}return d.ZP.error("\u8BF7\u5148\u8BBE\u7F6EAI\u6A21\u578B\u548C\u6A21\u677F"),Zt(),j.abrupt("return");case 4:if(r=bu(),l=r.find(function(I){return I.key===v.modelKey}),!(!l||!l.accessKey)){j.next=10;break}return d.ZP.error("AI\u6A21\u578B\u5BC6\u94A5\u672A\u914D\u7F6E\uFF0C\u8BF7\u5148\u5B8C\u6210\u914D\u7F6E"),Zt(),j.abrupt("return");case 10:if(c=v.prompt||mt,A=v.template||pt,St(),j.prev=13,Y=Nt(),Y.length!==0){j.next=18;break}return d.ZP.warning("\u672C\u5468\u6CA1\u6709\u5DE5\u4F5C\u5185\u5BB9\uFF0C\u751F\u6210\u7684\u5468\u62A5\u53EF\u80FD\u4E0D\u591F\u8BE6\u7EC6"),j.abrupt("return");case 18:return Le(!0),je(!0),jt(""),le=Y.map(function(I,M){return"".concat(M+1,". ").concat(I.title).concat(I.status==="completed"?"(\u5DF2\u5B8C\u6210) ":" (\u8FDB\u884C\u4E2D)",` 
 \u8BE6\u7EC6\u5185\u5BB9\uFF1A`).concat(I.description||"\u6682\u65E0",` 
 \u4F18\u5148\u7EA7\uFF1A`).concat(I.priority)}).join(`
`),le=`\u8FD9\u662F\u6211\u672C\u5468\u7684\u5DE5\u4F5C\u5185\u5BB9\uFF1A
`.concat(le),Ae=v.variables.map(function(I){var M=I.value;return T()(T()({},I),{},{value:M})}),de=A,Ae.forEach(function(I){var M=new RegExp("{".concat(I.key,"}"),"g");de=de.replace(M,I.value)}),Be=c,Ze=`\u4EE5\u4E0B\u662F\u5468\u62A5\u6A21\u677F\uFF1A
`.concat(de),_t=`

\u7ED3\u679C\u683C\u5F0F\u548C\u6392\u7248\u6309\u7167\u6211\u7ED9\u7684\u8FDB\u884C\u3002
1\u3001\u6BB5\u843D\u4E4B\u95F4\u4E0D\u8981\u7A7A\u884C\u3002
2\u3001\u4E0D\u8981\u8F93\u51FA\u4EFB\u4F55\u89E3\u91CA\u3002
3\u3001\u4E0D\u8981\u8F93\u51FA\u4EFB\u4F55\u5907\u6CE8\u3002
`,_=[{id:Date.now().toString(),role:"system",content:Be+Ze+_t,timestamp:Date.now()}],h=new pu.Z(l,_),Ke.current=h,at="",j.next=35,h.sendMessage(le,!1,{onMessage:function(M){at+=M,jt(at)},onError:function(M){d.ZP.error(typeof M=="string"?M:"\u751F\u6210\u5468\u62A5\u65F6\u53D1\u751F\u9519\u8BEF"),console.error("AI\u751F\u6210\u5468\u62A5\u9519\u8BEF:",M),Le(!1)},onComplete:function(){Ke.current=null;var M=S()().format("YYYY-MM-DD HH:mm:ss"),Yu={id:Date.now().toString(),content:at,date:M,title:"\u5468\u62A5 ".concat(M)},qt=[Yu].concat(U()(nt)).slice(0,10);At(qt),localStorage.setItem(ct,JSON.stringify(qt)),Le(!1),d.ZP.success("\u5468\u62A5\u751F\u6210\u5B8C\u6210")}});case 35:j.next=44;break;case 37:j.prev=37,j.t0=j.catch(13),console.error("\u751F\u6210\u5468\u62A5\u5931\u8D25:",j.t0),Tt="\u751F\u6210\u5468\u62A5\u65F6\u53D1\u751F\u9519\u8BEF",j.t0 instanceof Error&&(Tt="\u751F\u6210\u5931\u8D25: ".concat(j.t0.message)),d.ZP.error(Tt),Le(!1);case 44:case"end":return j.stop()}},t,null,[[13,37]])}));return function(){return n.apply(this,arguments)}}(),_u=function(t){if(!t||!t.content){d.ZP.error("\u5468\u62A5\u5185\u5BB9\u4E3A\u7A7A");return}jt(t.content),je(!0),Bt(!1)},Tu=function(){if(!oe){d.ZP.error("\u5468\u62A5\u5185\u5BB9\u4E3A\u7A7A\uFF0C\u65E0\u6CD5\u590D\u5236");return}if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(oe).then(function(){return d.ZP.success("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}).catch(function(l){console.error("\u590D\u5236\u5931\u8D25:",l),d.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236")});else try{var t=document.createElement("textarea");t.value=oe,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();var r=document.execCommand("copy");document.body.removeChild(t),r?d.ZP.success("\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F"):d.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236")}catch(l){console.error("\u590D\u5236\u5931\u8D25:",l),d.ZP.error("\u590D\u5236\u5931\u8D25\uFF0C\u8BF7\u624B\u52A8\u590D\u5236")}},Uu=function(){if(!oe){d.ZP.error("\u5468\u62A5\u5185\u5BB9\u4E3A\u7A7A\uFF0C\u65E0\u6CD5\u5BFC\u51FA");return}try{var t=new Blob([oe],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(t),l=document.createElement("a");l.href=r;var c=S()().format("YYYY-MM-DD");l.download="\u5468\u62A5_".concat(c,".txt"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r),d.ZP.success("\u5468\u62A5\u5DF2\u5BFC\u51FA\u4E3A\u6587\u672C\u6587\u4EF6")}catch(A){console.error("\u5BFC\u51FA\u5931\u8D25:",A),d.ZP.error("\u5BFC\u51FA\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5")}},bu=function(){try{var t=localStorage.getItem("ai-agent-models");if(t)return JSON.parse(t)}catch(r){console.error("\u89E3\u6790AI\u6A21\u578B\u914D\u7F6E\u5931\u8D25:",r)}return[]};(0,a.useEffect)(function(){var n=function(){var t=$()(D()().mark(function r(){var l,c,A,Y,le,Ae,de,Be,Ze;return D()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.prev=0,$e(!0),_.next=4,(0,It.p)({type:"weekly"});case 4:if(l=_.sent,l.data){if(c=Array.isArray(JSON.parse(l.data))?JSON.parse(l.data):[],A=c.filter(function(h){return h&&typeof h.id=="number"&&typeof h.title=="string"&&typeof h.startDate=="string"&&["high","medium","low"].includes(h.priority)&&["pending","completed"].includes(h.status)}),A.length>0)g(A),localStorage.setItem("weeklyTasks",JSON.stringify(A));else if(Y=localStorage.getItem("weeklyTasks"),Y)try{le=JSON.parse(Y),Ae=Array.isArray(le)?le.filter(function(h){return h&&typeof h.id=="number"&&typeof h.title=="string"&&typeof h.startDate=="string"&&["high","medium","low"].includes(h.priority)&&["pending","completed"].includes(h.status)}):[],Ae.length>0&&g(Ae)}catch(h){console.error("\u89E3\u6790\u672C\u5730\u5B58\u50A8\u6570\u636E\u5931\u8D25:",h),g([])}}_.next=13;break;case 8:if(_.prev=8,_.t0=_.catch(0),console.error("\u52A0\u8F7D\u5DE5\u4F5C\u5931\u8D25:",_.t0),de=localStorage.getItem("weeklyTasks"),de)try{Be=JSON.parse(de),Ze=Array.isArray(Be)?Be.filter(function(h){return h&&typeof h.id=="number"&&typeof h.title=="string"&&typeof h.startDate=="string"&&["high","medium","low"].includes(h.priority)&&["pending","completed"].includes(h.status)}):[],Ze.length>0&&g(Ze)}catch(h){console.error("\u89E3\u6790\u672C\u5730\u5B58\u50A8\u6570\u636E\u5931\u8D25:",h),g([])}case 13:return _.prev=13,$e(!1),_.finish(13);case 16:case"end":return _.stop()}},r,null,[[0,8,13,16]])}));return function(){return t.apply(this,arguments)}}();n()},[]),(0,a.useEffect)(function(){var n=function(){var t=$()(D()().mark(function r(){return D()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,(0,It.l)({todoData:x.map(function(A){return T()(T()({},A),{},{type:"weekly"})})});case 3:localStorage.setItem("weeklyTasks",JSON.stringify(x)),c.next=9;break;case 6:c.prev=6,c.t0=c.catch(0),console.error("\u4FDD\u5B58\u5DE5\u4F5C\u5931\u8D25:",c.t0);case 9:case"end":return c.stop()}},r,null,[[0,6]])}));return function(){return t.apply(this,arguments)}}();x.length>0&&n()},[x]);var $t=function(){var t=Re.startOf("week"),r=Re.endOf("week");return{start:t,end:r,formatted:"".concat(t.format("MM\u6708DD\u65E5")," - ").concat(r.format("MM\u6708DD\u65E5"))}},st=function(t){if(Ce.resetFields(),t)Ge(!0),Ce.setFieldsValue({title:t.title,description:t.description||"",startDateTime:t.startTime?S()("".concat(t.startDate," ").concat(t.startTime),"YYYY-MM-DD HH:mm:ss"):S()(t.startDate),endDateTime:t.endDate?S()("".concat(t.endDate," ").concat(t.endTime||"23:59:59"),"YYYY-MM-DD HH:mm:ss"):void 0,priority:t.priority}),De(t);else{Ge(!1);var r=S()();Ce.setFieldsValue({startDateTime:r,endDateTime:r.add(1,"day"),priority:"medium"}),De(null)}J(!0)},Iu=function(t){if(Ee&&y){var r=x.map(function(c){return c.id===y.id?T()(T()({},c),{},{title:t.title,description:t.description,startDate:t.startDateTime.format("YYYY-MM-DD"),startTime:t.startDateTime.format("HH:mm:ss"),endDate:t.endDateTime?t.endDateTime.format("YYYY-MM-DD"):void 0,endTime:t.endDateTime?t.endDateTime.format("HH:mm:ss"):void 0,priority:t.priority}):c});g(r),d.ZP.success("\u5DE5\u4F5C\u66F4\u65B0\u6210\u529F")}else{var l={id:Date.now(),title:t.title,description:t.description,startDate:t.startDateTime.format("YYYY-MM-DD"),startTime:t.startDateTime.format("HH:mm:ss"),endDate:t.endDateTime?t.endDateTime.format("YYYY-MM-DD"):void 0,endTime:t.endDateTime?t.endDateTime.format("HH:mm:ss"):void 0,priority:t.priority,status:"pending"};g([].concat(U()(x),[l])),d.ZP.success("\u5DE5\u4F5C\u6DFB\u52A0\u6210\u529F")}J(!1)},Pu=function(t){if(!Ye)return t;var r=Ye.toLowerCase();return t.filter(function(l){var c,A=l.title.toLowerCase().includes(r),Y=(c=l.description)===null||c===void 0?void 0:c.toLowerCase().includes(r);return A||Y})},Mu=function(t){st(t)},Nt=function(){var t=$t(),r=t.start,l=t.end,c=x.filter(function(A){var Y=S()(A.startDate);return Y.isAfter(r)&&Y.isBefore(l)});return Q!=="all"&&(c=c.filter(function(A){return A.status===Q})),Pu(c)},Gt=function(){if(ge.trim()!==""){var t=S()(),r={id:Date.now(),title:ge.trim(),startDate:t.format("YYYY-MM-DD"),startTime:t.format("HH:mm:ss"),priority:"medium",status:"pending"};g([].concat(U()(x),[r])),Je("")}},Jt=function(t){g(x.map(function(r){return r.id===t?T()(T()({},r),{},{status:"completed"}):r}))},Qt=function(t){g(x.map(function(r){return r.id===t?T()(T()({},r),{},{status:"pending"}):r}))},Xt=function(t){g(x.filter(function(r){return r.id!==t}))},Ou=function(t){De(t),pe(!0)},He=function(){pe(!1),De(null)},ku=function(t,r){return t.length===0?(0,e.jsx)(q.Z,{description:(0,e.jsxs)("div",{style:{textAlign:"center"},children:[(0,e.jsx)("p",{style:{marginBottom:"8px",color:"#8c8c8c"},children:r}),(0,e.jsxs)(o.ZP,{type:"primary",onClick:function(){return st()},children:[(0,e.jsx)(L.Z,{})," \u6DFB\u52A0\u5DE5\u4F5C"]})]}),image:q.Z.PRESENTED_IMAGE_SIMPLE,style:{margin:"20px 0"}}):(0,e.jsx)(N.Z,{itemLayout:"horizontal",dataSource:t,renderItem:function(c){return Ru(c)}})},Ru=function(t){return(0,e.jsxs)(N.Z.Item,{actions:[(0,e.jsx)(o.ZP,{type:"text",icon:(0,e.jsx)(Ie.Z,{}),onClick:function(){return Ou(t)},style:{padding:"4px 12px",height:"32px",width:F?"100%":"auto"},children:"\u8BE6\u60C5"},"view"),(0,e.jsx)(o.ZP,{type:"text",icon:(0,e.jsx)(ne.Z,{}),onClick:function(){return Mu(t)},style:{padding:"4px 12px",height:"32px",width:F?"100%":"auto"},children:"\u7F16\u8F91"},"edit"),t.status==="pending"?(0,e.jsx)(o.ZP,{style:{backgroundColor:"#52c41a",borderColor:"#52c41a",color:"#fff",boxShadow:"0 2px 4px rgba(111, 207, 151, 0.5)",borderRadius:"6px",padding:"4px 12px",height:"32px",marginBottom:F?"8px":0,width:F?"100%":"auto"},type:"primary",icon:(0,e.jsx)(z.Z,{}),onClick:function(){return Jt(t.id)},children:"\u5B8C\u6210"},"complete"):(0,e.jsx)(o.ZP,{style:{backgroundColor:"#1890ff",borderColor:"#1890ff",color:"#fff",borderRadius:"6px",padding:"4px 12px",height:"32px",marginBottom:F?"8px":0,width:F?"100%":"auto"},type:"primary",icon:(0,e.jsx)(it.Z,{}),onClick:function(){return Qt(t.id)},children:"\u6062\u590D"},"restore"),(0,e.jsx)(o.ZP,{type:"text",danger:!0,icon:(0,e.jsx)(s.Z,{}),onClick:function(){return Xt(t.id)},style:{padding:"4px 12px",height:"32px",width:F?"100%":"auto"},children:"\u5220\u9664"},"delete")],style:{background:"#fff",marginBottom:"12px",padding:F?"12px":"16px",borderRadius:"8px",boxShadow:t.status==="completed"?"0 2px 8px rgba(0,0,0,0.02)":"0 2px 8px rgba(0,0,0,0.04)",opacity:t.status==="completed"?.85:1,transition:"all 0.3s ease",border:t.status==="completed"?"1px solid rgba(82, 196, 26, 0.1)":"1px solid transparent",flexDirection:F?"column":"row",alignItems:F?"flex-start":"center"},children:[(0,e.jsx)(N.Z.Item.Meta,{style:{flex:1,marginBottom:F?"12px":0,width:"100%"},title:(0,e.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},children:[(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:F?"14px":"16px",fontWeight:t.status==="completed"?400:500,color:t.status==="completed"?"#8c8c8c":"#333"},children:[t.status==="completed"?(0,e.jsx)("span",{style:{color:"#52c41a",fontSize:F?"16px":"18px"},children:xe.completed.icon}):(0,e.jsx)("span",{style:{fontSize:F?"16px":"18px"},children:W[t.priority].emoji}),(0,e.jsx)("span",{style:{wordBreak:"break-all"},children:t.title}),(0,e.jsxs)(K.Z,{color:W[t.priority].color,style:{borderRadius:"4px",padding:"0 8px",height:"24px",lineHeight:"22px",opacity:t.status==="completed"?.7:1,fontSize:F?"12px":"14px"},children:[W[t.priority].text,"\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:xe[t.status].color,style:{borderRadius:"4px",padding:"0 8px",height:"24px",lineHeight:"22px",fontSize:F?"12px":"14px"},children:xe[t.status].text})]}),(0,e.jsxs)("span",{style:{color:"#8c8c8c",fontSize:F?"12px":"14px",marginLeft:"26px"},children:["\u5F00\u59CB: ",S()(t.startDate).format("YYYY-MM-DD")," ",t.startTime||"00:00:00",t.endDate&&" | \u622A\u6B62: ".concat(S()(t.endDate).format("YYYY-MM-DD")," ").concat(t.endTime||"23:59:59")]})]}),description:t.description&&(0,e.jsx)("div",{style:{marginTop:"8px",fontSize:F?"12px":"14px",lineHeight:"1.6",color:t.status==="completed"?"#8c8c8c":"#666",wordBreak:"break-all",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:t.description})}),F&&(0,e.jsx)("div",{style:{width:"100%",height:"1px"}})]},t.id)},wu=function(t){var r=nt.filter(function(l){return l.id!==t});At(r),localStorage.setItem(ct,JSON.stringify(r)),d.ZP.success("\u5DF2\u5220\u9664\u5386\u53F2\u5468\u62A5")},Wu=function(t){if(!t)return"";try{var r=typeof t=="string"?t:String(t);return r.replace(/^# (.*$)/gim,'<h1 style="font-size: 24px; margin-bottom: 16px; color: #1677ff;">$1</h1>').replace(/^## (.*$)/gim,'<h2 style="font-size: 20px; margin: 16px 0 8px; color: #333;">$1</h2>').replace(/^### (.*$)/gim,'<h3 style="font-size: 18px; margin: 14px 0 6px; color: #333;">$1</h3>').replace(/\n- (.*$)/gim,'<div style="margin: 4px 0;"><span style="display: inline-block; margin-right: 8px;">\u2022</span>$1</div>').replace(/\n([0-9]+)\. (.*$)/gim,'<div style="margin: 4px 0;"><span style="display: inline-block; margin-right: 8px; min-width: 16px;">$1.</span>$2</div>').replace(/\n/gim,"<br/>")}catch(l){return console.error("Markdown\u8F6C\u6362\u9519\u8BEF:",l),typeof t=="string"?t:"\u65E0\u6CD5\u663E\u793A\u5185\u5BB9"}};return(0,e.jsxs)("div",{style:{background:"#f5f5f5",padding:"24px"},children:[(0,e.jsxs)(ye.Z,{title:(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"12px"},children:[(0,e.jsx)("span",{children:"\u{1F680} AI\u5468\u62A5\u52A9\u624B"}),(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(Z.Z,{}),onClick:Su,loading:ie,children:"\u751F\u6210\u5468\u62A5"}),(0,e.jsx)(o.ZP,{icon:(0,e.jsx)(eu.Z,{}),onClick:function(){return Bt(!0)},disabled:nt.length===0,children:"\u5386\u53F2\u5468\u62A5"}),(0,e.jsx)(o.ZP,{icon:(0,e.jsx)(tu.Z,{}),onClick:Zt,children:"AI\u8BBE\u7F6E"}),(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(L.Z,{}),onClick:function(){return st()},children:"\u6DFB\u52A0\u5DE5\u4F5C\u5185\u5BB9"})]})]}),children:[(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,flexDirection:F?"column":"row",gap:F?"12px":"0"},children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(uu.Z,{}),(0,e.jsxs)(hu,{strong:!0,style:{marginLeft:8},children:["\u5F53\u524D\u5468: ",$t().formatted]})]}),(0,e.jsx)(ve.default,{picker:"week",value:Re,onChange:function(t){return t&&Qe(t)},locale:ot.Z})]}),(0,e.jsxs)(ze.Z,{gutter:16,style:{marginBottom:16},children:[(0,e.jsx)(be.Z,{xs:24,md:12,children:(0,e.jsx)(k.Z,{placeholder:"\u8F93\u5165\u5F85\u529E\u4E8B\u9879\u6309\u56DE\u8F66\u5FEB\u901F\u6DFB\u52A0",value:ge,onChange:function(t){return Je(t.target.value)},onPressEnter:Gt,suffix:(0,e.jsx)(o.ZP,{type:"primary",size:"small",onClick:Gt,disabled:ge.trim()==="",children:"\u6DFB\u52A0"})})}),(0,e.jsx)(be.Z,{xs:24,md:12,children:(0,e.jsx)(Fu,{placeholder:"\u641C\u7D22\u5DE5\u4F5C",allowClear:!0,enterButton:!0,value:Ye,onChange:function(t){return rt(t.target.value)},onSearch:function(t){return rt(t)},style:{width:"100%"}})})]}),(0,e.jsx)("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end"},children:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(ru.Z,{}),(0,e.jsxs)(G.ZP.Group,{value:Q,onChange:function(t){return qe(t.target.value)},optionType:"button",buttonStyle:"solid",size:"small",children:[(0,e.jsx)(G.ZP.Button,{value:"all",children:"\u5168\u90E8"}),(0,e.jsx)(G.ZP.Button,{value:"pending",children:"\u8FDB\u884C\u4E2D"}),(0,e.jsx)(G.ZP.Button,{value:"completed",children:"\u5DF2\u5B8C\u6210"})]})]})}),(0,e.jsx)(me.Z,{defaultActiveKey:"currentWeek",items:[{key:"currentWeek",label:"\u672C\u5468\u5DE5\u4F5C",children:ku(Nt(),"\u672C\u5468\u6682\u65E0\u5DE5\u4F5C\u5185\u5BB9")}]})]}),(0,e.jsx)(ee.Z,{title:(0,e.jsx)(e.Fragment,{children:Ee?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ne.Z,{})," \u7F16\u8F91\u5DE5\u4F5C"]}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(L.Z,{})," \u6DFB\u52A0\u65B0\u5DE5\u4F5C"]})}),open:ft,onCancel:function(){return J(!1)},footer:null,width:700,children:(0,e.jsxs)(f.Z,{form:Ce,layout:"vertical",onFinish:Iu,initialValues:{priority:"medium",startDateTime:S()(),endDateTime:S()().add(1,"day")},children:[(0,e.jsx)(f.Z.Item,{name:"title",label:"\u5DE5\u4F5C\u6807\u9898",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6807\u9898"}],children:(0,e.jsx)(k.Z,{placeholder:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u6807\u9898",maxLength:50})}),(0,e.jsx)(f.Z.Item,{name:"description",label:"\u5DE5\u4F5C\u63CF\u8FF0",children:(0,e.jsx)(fu,{placeholder:"\u8BF7\u8F93\u5165\u5DE5\u4F5C\u63CF\u8FF0\uFF08\u9009\u586B\uFF09",autoSize:{minRows:3,maxRows:6},maxLength:200})}),(0,e.jsx)(f.Z.Item,{name:"startDateTime",label:"\u5F00\u59CB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4"}],children:(0,e.jsx)(ve.default,{style:{width:"100%"},locale:ot.Z,showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",allowClear:!1})}),(0,e.jsx)(f.Z.Item,{name:"endDateTime",label:"\u622A\u6B62\u65F6\u95F4",children:(0,e.jsx)(ve.default,{style:{width:"100%"},locale:ot.Z,showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss"})}),(0,e.jsx)(f.Z.Item,{name:"priority",label:"\u4F18\u5148\u7EA7",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4F18\u5148\u7EA7"}],children:(0,e.jsxs)(w.Z,{placeholder:"\u8BF7\u9009\u62E9\u4F18\u5148\u7EA7",children:[(0,e.jsx)(dt,{value:"high",children:(0,e.jsxs)(B.Z,{children:[(0,e.jsxs)("span",{children:[W.high.emoji," \u9AD8\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:W.high.color,children:"\u7D27\u6025"})]})}),(0,e.jsx)(dt,{value:"medium",children:(0,e.jsxs)(B.Z,{children:[(0,e.jsxs)("span",{children:[W.medium.emoji," \u4E2D\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:W.medium.color,children:"\u91CD\u8981"})]})}),(0,e.jsx)(dt,{value:"low",children:(0,e.jsxs)(B.Z,{children:[(0,e.jsxs)("span",{children:[W.low.emoji," \u4F4E\u4F18\u5148\u7EA7"]}),(0,e.jsx)(K.Z,{color:W.low.color,children:"\u666E\u901A"})]})})]})}),(0,e.jsx)(f.Z.Item,{style:{marginBottom:0,textAlign:"right"},children:(0,e.jsxs)(B.Z,{children:[(0,e.jsx)(o.ZP,{onClick:function(){return J(!1)},children:"\u53D6\u6D88"}),(0,e.jsx)(o.ZP,{type:"primary",htmlType:"submit",children:Ee?"\u66F4\u65B0":"\u6DFB\u52A0"})]})})]})}),(0,e.jsx)(te.Z,{title:"\u5DE5\u4F5C\u8BE6\u60C5",placement:"right",onClose:He,open:ae,width:F?"100%":500,extra:(0,e.jsx)(B.Z,{children:(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(ne.Z,{}),onClick:function(){He(),y&&st(y)},children:"\u7F16\u8F91"})}),children:y&&(0,e.jsxs)("div",{children:[(0,e.jsxs)(H.Z,{bordered:!0,column:1,children:[(0,e.jsx)(H.Z.Item,{label:"\u5DE5\u4F5C\u6807\u9898",labelStyle:{fontWeight:"bold"},children:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,e.jsx)("span",{style:{fontSize:"18px"},children:y.status==="completed"?xe.completed.icon:W[y.priority].emoji}),y.title]})}),(0,e.jsx)(H.Z.Item,{label:"\u4F18\u5148\u7EA7",labelStyle:{fontWeight:"bold"},children:(0,e.jsxs)(K.Z,{color:W[y.priority].color,children:[W[y.priority].text,"\u4F18\u5148\u7EA7"]})}),(0,e.jsx)(H.Z.Item,{label:"\u5DE5\u4F5C\u72B6\u6001",labelStyle:{fontWeight:"bold"},children:(0,e.jsx)(K.Z,{color:xe[y.status].color,children:xe[y.status].text})}),(0,e.jsxs)(H.Z.Item,{label:"\u5F00\u59CB\u65F6\u95F4",labelStyle:{fontWeight:"bold"},children:[S()(y.startDate).format("YYYY\u5E74MM\u6708DD\u65E5")," ",y.startTime||"00:00:00"]}),y.endDate&&(0,e.jsxs)(H.Z.Item,{label:"\u622A\u6B62\u65F6\u95F4",labelStyle:{fontWeight:"bold"},children:[S()(y.endDate).format("YYYY\u5E74MM\u6708DD\u65E5")," ",y.endTime||"23:59:59"]}),y.description&&(0,e.jsx)(H.Z.Item,{label:"\u5DE5\u4F5C\u63CF\u8FF0",labelStyle:{fontWeight:"bold"},children:(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:y.description})})]}),(0,e.jsx)(ue.Z,{}),(0,e.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[y.status==="pending"?(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(z.Z,{}),onClick:function(){Jt(y.id),He()},children:"\u6807\u8BB0\u4E3A\u5DF2\u5B8C\u6210"}):(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(it.Z,{}),onClick:function(){Qt(y.id),He()},children:"\u6807\u8BB0\u4E3A\u8FDB\u884C\u4E2D"}),(0,e.jsx)(o.ZP,{danger:!0,icon:(0,e.jsx)(s.Z,{}),onClick:function(){Xt(y.id),He()},children:"\u5220\u9664\u5DE5\u4F5C"})]})]})}),(0,e.jsx)(mu,{visible:p,onClose:Zu,settings:{modelKey:v.modelKey,prompt:v.prompt||mt,template:v.template||pt,variables:v.variables||[]},onSave:Bu}),(0,e.jsx)(ee.Z,{title:(0,e.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,e.jsx)(Z.Z,{style:{marginRight:8}}),(0,e.jsx)("span",{children:ie?"AI\u6B63\u5728\u751F\u6210\u5468\u62A5...":"AI\u751F\u6210\u7684\u5468\u62A5"})]}),open:gu,onCancel:function(){ie?ee.Z.confirm({title:"\u786E\u8BA4\u53D6\u6D88\u751F\u6210?",content:"\u5468\u62A5\u6B63\u5728\u751F\u6210\u4E2D\uFF0C\u53D6\u6D88\u5C06\u7EC8\u6B62\u751F\u6210\u8FC7\u7A0B\u3002",onOk:function(){St(),je(!1),d.ZP.info("\u5DF2\u53D6\u6D88\u751F\u6210")}}):je(!1)},footer:[(0,e.jsx)(o.ZP,{onClick:function(){ie?ee.Z.confirm({title:"\u786E\u8BA4\u53D6\u6D88\u751F\u6210?",content:"\u5468\u62A5\u6B63\u5728\u751F\u6210\u4E2D\uFF0C\u53D6\u6D88\u5C06\u7EC8\u6B62\u751F\u6210\u8FC7\u7A0B\u3002",onOk:function(){St(),je(!1),d.ZP.info("\u5DF2\u53D6\u6D88\u751F\u6210")}}):je(!1)},children:ie?"\u53D6\u6D88\u751F\u6210":"\u5173\u95ED"},"close"),(0,e.jsx)(o.ZP,{type:"primary",icon:(0,e.jsx)(nu.Z,{}),onClick:Tu,disabled:!oe||ie,children:"\u590D\u5236\u5185\u5BB9"},"copy")],width:700,maskClosable:!ie,closable:!ie,children:oe?(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap",padding:"16px",borderRadius:"4px",border:"1px solid #e8e8e8",maxHeight:"60vh",overflow:"auto",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, sans-serif'},dangerouslySetInnerHTML:{__html:Wu(oe)}}):(0,e.jsxs)("div",{style:{textAlign:"center",padding:"40px 0"},children:[(0,e.jsx)(re.Z,{size:"large"}),(0,e.jsx)("p",{style:{marginTop:16},children:"AI\u6B63\u5728\u601D\u8003\u5E76\u751F\u6210\u5468\u62A5..."}),(0,e.jsx)("p",{style:{color:"#888",fontSize:"14px"},children:"\u6839\u636E\u5DE5\u4F5C\u5185\u5BB9\u751F\u6210\u9AD8\u8D28\u91CF\u5468\u62A5\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5F85"})]})}),(0,e.jsx)(te.Z,{title:"\u5386\u53F2\u5468\u62A5",placement:"right",onClose:function(){return Bt(!1)},open:Au,width:400,children:(0,e.jsx)(N.Z,{itemLayout:"horizontal",dataSource:nt,renderItem:function(t){return(0,e.jsx)(N.Z.Item,{actions:[(0,e.jsx)(o.ZP,{type:"link",onClick:function(){return _u(t)},children:"\u67E5\u770B"},"view"),(0,e.jsx)(o.ZP,{type:"link",danger:!0,onClick:function(){return wu(t.id)},children:"\u5220\u9664"},"delete")],children:(0,e.jsx)(N.Z.Item.Meta,{title:t.title,description:t.date})})}})})]})}},53579:function(bt,fe,u){u.d(fe,{l:function(){return m},p:function(){return $}});var Se=u(95688),D=u.n(Se),_e=u(79810),U=u.n(_e),Te=u(76069),T=u.n(Te),Fe=u(52926);function $(O){return ce.apply(this,arguments)}function ce(){return ce=T()(D()().mark(function O(R){return D()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",(0,Fe.request)("/api/todo/get",U()({method:"POST"},R||{})));case 1:case"end":return w.stop()}},O)})),ce.apply(this,arguments)}function m(O,R){return a.apply(this,arguments)}function a(){return a=T()(D()().mark(function O(R,k){return D()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",(0,Fe.request)("/api/todo/save",U()({method:"POST",headers:{"Content-Type":"application/json"},data:R},k||{})));case 1:case"end":return f.stop()}},O)})),a.apply(this,arguments)}}}]);
